---
title: "XÁC SUẤT LƯỢC GIẢNG: HÀNH TRÌNH CHINH PHỤC ĐỊNH LÝ GIỚI HẠN TRUNG TÂM"
author: "Nguyễn Tấn Nhựt"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
  pdf_document:
    latex_engine: lualatex
  word_document: default
  html_notebook:
    df_print: kable
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
knitr::knit_engines$set(latex = knitr::knit_engines$get("latex"))
```

------------------------------------------------------------------------

# Nguyên tắc biên soạn

1.  **Cảm hứng từ Euclid**: Mình muốn học hỏi từ phương pháp của Euclid trong việc xây dựng kiến thức từ cơ bản đến phức tạp, với định lý Pythagore là "đỉnh cao" khi ông trình bày hình học phẳng.

2.  **Mục tiêu**: Mình đặt mục tiêu tương tự cho Định lý Giới hạn Trung tâm khi mình trình bày lý thuyết xác suất.

3.  **Phương pháp giảng dạy**:

-   **Đi từ cơ bản**: Mình sẽ bắt đầu với các khái niệm cơ bản như thí nghiệm ngẫu nhiên, không gian mẫu, và biến cố.

-   **Phân tích ví dụ**: Thay vì đưa ra định nghĩa và tiên đề một cách cứng nhắc, mình sẽ sử dụng ví dụ để minh họa sự cần thiết của các khái niệm.

-   **Văn phong thân thiện**: Mình sẽ dùng ngôn ngữ đơn giản, dễ hiểu, nhưng vẫn đảm bảo truyền đạt đầy đủ kiến thức một cách khoa học và rõ ràng.

4.  **Định hướng học tập**: Mình muốn dẫn dắt người học từ những khái niệm cơ bản đến các định lý quan trọng trong lý thuyết xác suất thông qua việc khám phá và phân tích.

Tóm lại, nguyên tắc biên soạn của mình nhấn mạnh việc xây dựng kiến thức một cách mạch lạc và dễ hiểu, sử dụng ví dụ để minh họa và áp dụng ngôn ngữ thân thiện để tiếp cận với sinh viên hiện đại.

------------------------------------------------------------------------

### **Cẩm nang phát triển mô hình xác suất từ hiện tượng tung đồng xu**

**1. Đặt vấn đề:**

-   **Câu hỏi mở đầu**: Khi mình tung một đồng xu cân bằng nhiều lần, tại sao kết quả thường là khoảng một nửa số lần ra mặt sấp, dù cho mình không thể biết trước kết quả của bất kỳ lần tung nào?

    -   Nhìn xuôi: Vì đồng xu cân bằng [sự vật], mỗi lần tung khả năng ra mặt sấp và ra mặt ngửa là như nhau [hiện tượng], nên khi tung nhiều lần, số lần ra mặt sấp và mặt ngửa thường xấp xỉ là phù hợp với nhận thức đồng xu không thiên vị bên nào cả.
        -   Nhưng nếu mình đã giả định chính xác rằng khả năng ra mặt sấp và mặt ngửa là như sau, thì sao kết quả khi tung nhiều lần không phải luôn luôn là một nửa mặt sấp và một nửa mặt ngửa? Chẳng hạn, khi tung 100 lần, vì sao không phải luôn là 50 mặt sấp và 50 mặt ngửa?

        -   Nếu mình chấp nhận vì giả thiết cân bằng mà trong 100 lần tung luôn có đúng một nửa số lần mặt sấp và một nửa số lần mặt ngửa, thì điều gì sẽ xảy ra? Khi đó, ví dụ lúc kết thúc lần tung thứ 99, bạn đã có 50 mặt sấp và 49 mặt ngửa, thế thì lần tung thứ 100 nhất định phải là mặt sấp - điều này mâu thuẫn với giả thiết đồng xu cân bằng.
    -   Nhìn ngược: Nếu mình quan sát một đồng xu được tung nhiều lần mà số lần ra mặt sấp và mặt ngửa xấp xỉ nhau [hiện tượng], thì mình suy ra đồng xu ấy cân bằng [sự vật].

-   **Mục tiêu**: Câu hỏi này dẫn đến một khuôn mẫu mà ta có thể giải thích được bằng toán học. Lý thuyết xác suất là công cụ chính giúp chúng ta không chỉ hiểu rõ hiện tượng này mà còn dự đoán các kết quả của các thí nghiệm tương tự khác trong đời sống.

**2. Mô hình hóa hiện tượng ngẫu nhiên:**

-   **Mô hình hóa là gì?**

    Để hiểu và giải thích khuôn mẫu này, ta cần mô hình hóa nó. *Mô hình hóa là quá trình sử dụng các công cụ và ký hiệu toán học để xây dựng một mô tả trừu tượng của hiện tượng thực tế.* Mục tiêu của việc này là đưa hiện tượng vào một khuôn khổ logic và có thể phân tích được.

-   **Yêu cầu của mô hình hóa**:

    -   Mô hình phải đủ cụ thể để giải thích hiện tượng tung đồng xu.

    -   Nhưng đồng thời, nó cũng phải đủ **trừu tượng** để có thể áp dụng cho nhiều trường hợp tương tự, ví dụ như gieo xúc xắc, rút thẻ bài, hay bất kỳ hiện tượng nào mang tính ngẫu nhiên.

**3. Sử dụng ngôn ngữ toán học:**

-   **Ngôn ngữ toán học**: Để xây dựng mô hình, ta cần ngôn ngữ toán học phù hợp. Ở đây, lý thuyết xác suất cung cấp cho chúng ta các công cụ và khái niệm như:

-   **Thí nghiệm ngẫu nhiên**: Một thí nghiệm mà kết quả của nó không thể dự đoán trước được, như việc tung một đồng xu.

-   **Không gian mẫu**: Tập hợp tất cả các kết quả có thể xảy ra. Ví dụ, với việc tung đồng xu, không gian mẫu gồm hai phần tử: {mặt sấp, mặt ngửa}.

-   **Biến cố (event)**: Một tập con của không gian mẫu, ví dụ: "xu ra mặt sấp" là một biến cố. Các loại biến cố bao gồm:

-   **Biến cố sơ cấp**: Mỗi kết quả trong không gian mẫu (ví dụ, mặt sấp hoặc mặt ngửa).

-   **Biến cố chắc chắn**: Biến cố mà chắc chắn sẽ xảy ra, như việc tung xu sẽ cho ra hoặc mặt sấp hoặc mặt ngửa.

-   **Biến cố không thể có**: Biến cố không thể xảy ra, ví dụ tung xu mà cho ra một kết quả khác hai mặt sấp và ngửa.

**4. Khái quát hóa mô hình từ các ví dụ cụ thể:**

-   **Phân tích ví dụ đơn giản**: Để giúp người học dễ dàng tiếp cận khái niệm, ta nên bắt đầu bằng các ví dụ thực tế, như gieo đồng xu một lần, sau đó mở rộng lên nhiều lần:

-   **Gieo đồng xu 1 lần**: Không gian mẫu {sấp, ngửa}. Mỗi biến cố có xác suất 50%.

-   **Gieo đồng xu 2 lần**: Không gian mẫu {SS, SN, NS, NN}. Xác suất của mỗi biến cố bằng 25%.

-   **Rút ra khái niệm cơ bản từ ví dụ**:

-   Sau khi phân tích một số ví dụ đơn giản, ta có thể dần dần giới thiệu các khái niệm như: phân phối xác suất (distribution), phép cộng xác suất (addition rule), và phép nhân xác suất (multiplication rule).

**5. Phát triển thêm lý thuyết xác suất:**

-   Sau khi người học đã nắm được các khái niệm cơ bản qua ví dụ đơn giản, ta có thể mở rộng sang các khái niệm phức tạp hơn:

-   **Phép cộng xác suất**: Khi tính xác suất của các biến cố không giao nhau, ta cộng xác suất của từng biến cố. Ví dụ, xác suất ra mặt sấp hoặc mặt ngửa khi gieo xu là 1 (vì chúng bao phủ toàn bộ không gian mẫu).

-   **Phép nhân xác suất**: Khi có nhiều thí nghiệm liên tiếp, xác suất của các biến cố độc lập là tích của các xác suất riêng. Ví dụ, xác suất ra mặt sấp trong cả hai lần gieo đồng xu là $\frac{1}{2} \times \frac{1}{2} = \frac{1}{4}$.

**6. Mở rộng sang các hiện tượng ngẫu nhiên khác:**

-   **Tính phổ quát của mô hình**: Điểm mạnh của lý thuyết xác suất là tính khái quát của nó. Sau khi hiểu rõ các khái niệm qua hiện tượng tung đồng xu, ta có thể mở rộng lý thuyết này sang nhiều hiện tượng khác:

-   Gieo xúc xắc: không gian mẫu có 6 kết quả, xác suất của mỗi biến cố sơ cấp là $\frac{1}{6}$.

-   Rút thẻ từ bộ bài: không gian mẫu có 52 kết quả, xác suất của mỗi kết quả có thể được tính dựa trên các biến cố cụ thể.

**7. Áp dụng mô hình toán học vào thực tế:**

-   **Lý thuyết và thực tiễn**: Dù lý thuyết xác suất là trừu tượng, nó được phát triển để giải quyết những vấn đề thực tế. Từ trò chơi may rủi đến phân tích rủi ro trong tài chính, các mô hình xác suất giúp chúng ta đưa ra quyết định hợp lý dựa trên thông tin không chắc chắn.

### Nhận xét và hướng phát triển tiếp theo

-   **Quá trình suy luận**: Bắt đầu từ một hiện tượng ngẫu nhiên đơn giản, ta đã từng bước phân tích, mô hình hóa và phát triển lý thuyết. Đây là cách tiếp cận hiệu quả giúp người học từ từ làm quen với các khái niệm trừu tượng mà không cảm thấy quá nặng nề.

-   **Điểm cần chú ý**: Trong quá trình giảng dạy, cần lưu ý giữ cho các ví dụ và khái niệm dễ hiểu và kết nối chặt chẽ. Mỗi khái niệm cần được xây dựng trên cơ sở của các khái niệm trước đó, và khi giới thiệu các khái niệm mới, nên gắn liền với ví dụ thực tế để người học dễ hình dung.

-   **Phát triển tiếp**: Sau khi nắm vững các khái niệm cơ bản, bạn có thể dẫn dắt người học vào các chủ đề nâng cao hơn như xác suất có điều kiện, biến ngẫu nhiên, và các định lý quan trọng trong xác suất (như định lý Bayes, định lý giới hạn trung tâm).

------------------------------------------------------------------------

# Lời giới thiệu

Chào mừng bạn đến với **"XÁC SUẤT LƯỢC GIẢNG: HÀNH TRÌNH CHINH PHỤC ĐỊNH LÝ GIỚI HẠN TRUNG TÂM"** – nơi bạn sẽ bắt đầu với những khái niệm như **không gian mẫu**, **xác suất** và **biến cố** đến những kiến thức sâu hơn như **phân phối Bernoulli**, **nhị thức**, **Poisson**, và **chuẩn**. Bạn sẽ hiểu rõ **kỳ vọng**, **phương sai**, và các công cụ phân tích xác suất cần thiết.

Dù là người mới hay đã có nền tảng, bài giảng này sẽ củng cố và mở rộng kiến thức của bạn qua cách tiếp cận kết hợp giữa **lý thuyết** và **thực tiễn**. Các ví dụ trực quan giúp làm rõ khái niệm toán học, khiến xác suất trở nên dễ tiếp cận và gần gũi với cuộc sống.

Từ những thí nghiệm đơn giản như **tung đồng xu**, bạn sẽ được dẫn dắt tới những kết quả toán học quan trọng như **Luật số lớn** và **Định lý giới hạn trung tâm** – các cơ sở vững chắc giúp giải thích các hiện tượng ngẫu nhiên.

------------------------------------------------------------------------

# 1. Dẫn nhập

Khi mình tung một đồng xu nhiều lần, vì sao mình thường nhận thấy rằng có chừng một nửa số lần tung sẽ ra mặt sấp, dù mình không thể biết trước kết quả của bất kỳ lần tung cụ thể nào?

Trực giác mách bảo rằng điều này xảy ra vì đồng xu là cân bằng. Với một đồng xu như vậy, mình cảm thấy rằng cơ hội của hai mặt là như nhau. Do đó, khi tung nhiều lần, hiện tượng số lần ra mặt sấp và mặt ngửa gần như bằng nhau khiến mình nghĩ rằng đồng xu thực sự không thiên vị sự xuất hiện của mặt nào.

Khi một đồng xu được tung nhiều lần, nếu số lần ra mặt sấp gần bằng số lần ra mặt ngửa thì bạn có nghĩ rằng khả năng ra mặt sấp và ra mặt ngửa có như nhau trong mỗi lần tung cụ thể không?

Bạn có bao giờ tự hỏi tại sao khi tung một đồng xu nhiều lần, số lần xuất hiện mặt sấp và mặt ngửa lại gần như bằng nhau? Điều này có ngẫu nhiên không?

Nếu bạn quan sát một đồng xu được tung nhiều lần, và số lần ra mặt sấp gần bằng số lần ra mặt ngửa, liệu bạn có nghĩ rằng khả năng ra mặt sấp và mặt ngửa là như nhau trong mỗi lần tung?

**Toán học**

Liệu hiện tượng này có giải thích được bằng ngôn ngữ toán học hay không?

Tung đồng xu là một sự việc diễn ra trong thực tế, có thể có nhiều yếu tố không kiểm soát được trong quá trình thực hiện sẽ tác động lên kết quả.

Lí tưởng hóa vấn đề bằng cách lược bỏ hết những yếu tố khó kiểm soát đó, từ đó tìm ra một mô hình mô tả lại vấn đề một cách chính xác và rõ ràng

-   **Mô hình hóa là gì?**

    Để hiểu và giải thích khuôn mẫu này, ta cần mô hình hóa nó. *Mô hình hóa là quá trình sử dụng các công cụ và ký hiệu toán học để xây dựng một mô tả trừu tượng của hiện tượng thực tế.* Mục tiêu của việc này là đưa hiện tượng vào một khuôn khổ logic và có thể phân tích được.

    -   Mô hình phải đủ cụ thể để giải thích hiện tượng tung đồng xu.

    -   Nhưng đồng thời, nó cũng phải đủ **trừu tượng** để có thể áp dụng cho nhiều trường hợp tương tự, ví dụ như gieo xúc xắc, rút thẻ bài, hay bất kỳ hiện tượng nào mang tính ngẫu nhiên.

# 1. Phân phối xác suất rời rạc

Khi mình tung một đồng xu cân bằng nhiều lần, mình nhận thấy có chừng một nửa số lần tung sẽ ra mặt sấp và nửa còn lại là mặt ngửa, dù cho mình không thể biết trước kết quả của bất kỳ lần tung cụ thể nào. Khuôn mẫu này không phải là cảm nhận chủ quan, mà có thể được giải thích rõ ràng bằng toán học thông qua một **không gian mẫu** $\Omega$ và một **phân phối xác suất** $\mathbb{P}$.

Khi đồng xu được tung một lần, không gian mẫu bao gồm hai khả năng có thể xảy ra là $\Omega=\{\text{S, N}\}$, trong đó S đại diện cho mặt sấp và N đại diện cho mặt ngửa. Với đồng xu cân bằng, phân phối xác suất tự nhiên là $\mathbb{P}=\left\{\mathbb{P}(\text{S})=\frac{1}{2},\mathbb{P}(\text{N})=\frac{1}{2}\right\}$, trong đó $\mathbb{P}(\text{S})$ là xác suất ra mặt sấp và $\mathbb{P}(\text{N})$ là xác suất ra mặt ngửa. Để dễ theo dõi, mình có thể trình bày những thông tin này dưới dạng **bảng phân phối xác suất**.

```{r}
library(knitr)
library(kableExtra)

df <- data.frame(
  c1 = c("$p$"),
  c2 = c("$\\frac{1}{2}$"),
  c3 = c("$\\frac{1}{2}$")
)

kable(
  df, 
  format = "html", 
  col.names = c("$\\omega$", "S", "N"), 
  align = c("l", "c", "c"), escape = FALSE
  ) %>%
kable_styling(
  bootstrap_options = c("striped", "hover", "condensed"),
  full_width = FALSE,
  font_size = 12
  ) %>%
row_spec(0, bold = FALSE)
```

Bây giờ, giả sử mình tung đồng xu hai lần liên tiếp. Không gian mẫu sẽ mở rộng, bao gồm tất cả các khả năng có thể xảy ra từ hai lần tung là $\Omega=\{\text{(S,S); (S,N); (N,S); (N,N)}\}$, trong đó ký hiệu (S,S) đại diện cho cả hai lần tung đều ra mặt sấp, còn $(\text{N,S})$ là lần đầu ra mặt ngửa và lần cuối ra mặt sấp. Mình có bảng phân phối xác suất như dưới đây.

```{r}
library(knitr)
library(kableExtra)

df <- data.frame(
  c1 = c("$p$"),
  c2 = c("$\\frac{1}{4}$"),
  c3 = c("$\\frac{1}{4}$"),
  c4 = c("$\\frac{1}{4}$"),
  c5 = c("$\\frac{1}{4}$")
)

kable(
  df,
  format = "html",
  col.names = c("$\\omega$", "(S,S)", "(S,N)", "(N,S)", "(N,N)"),
  align = c("l", "c", "c", "c", "c"),
  escape = FALSE
  ) %>%
kable_styling(
  bootstrap_options = c("striped", "hover", "condensed"),
  full_width = FALSE,
  font_size = 12
  ) %>%
row_spec(0, bold = FALSE)
```

Cũng như hai thuật ngữ không gian mẫu và phân phối xác suất, để phát triển một lý thuyết có hệ thống áp dụng rộng rãi vào nhiều tình huống khác nhau, mình cần phải thiết lập thêm một số thuật ngữ cần thiết bao gồm thí nghiệm ngẫu nhiên, phép thử và biến cố. Những khái niệm này không chỉ giúp mô tả các hành động đơn giản như tung đồng xu hay lắc xúc xắc một cách chi tiết hơn. Chúng còn tạo ra một nên tảng cho việc phân tích các tình huống phức tạp hơn về sau này.

Tổng quát hơn, nếu không gian mẫu $\Omega$ có $n$ phần tử, thì *phân phối đều* trên $\Omega$ sẽ là phép gán xác suất $\frac{1}{n}$ cho mỗi phần tử của nó như bảng phân phối xác suất dưới đây.

-   Không gian mẫu $\Omega$ là một tập hợp mà mỗi phần tử $\omega$ của nó đại diện cho một kết quả có thể xảy ra.

-   Phân phối xác suất $\mathbb{P}$ là phép gán cho mỗi phần tử $\omega$ một số thực không âm $p$, sao cho tổng tất cả các số này bằng 1.

```{r}
library(knitr)
library(kableExtra)

df <- data.frame(
  c1 = c("$p$"),
  c2 = c("$\\frac{1}{n}$"),
  c3 = c("$\\frac{1}{n}$"),
  c4 = c("$\\ldots$"),
  c5 = c("$\\frac{1}{n}$")
)

kable(df, format = "html", col.names = c("$\\omega$", "$\\omega_1$", "$\\omega_2$", "$\\ldots$", "$\\omega_n$"), align = c("l", "c", "c", "c", "c"), escape = FALSE) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), 
                      full_width = FALSE,
                      font_size = 12) %>%
row_spec(0, bold = FALSE)
```

-   **Thí nghiệm ngẫu nhiên** là một hành động hay quá trình mà kết quả không thể biết trước, nhưng có thể mô tả bằng không gian mẫu và phân phối xác suất. Ví dụ, tung đồng xu một lần hay tung đồng xu hai lần đều là các thí nghiệm ngẫu nhiên. Một ví dụ khác là lắc xúc xắc, không gian mẫu sẽ là $\Omega=\{\text{Mo, Ha, Ba, Bo, Na, Sa}\}$ bao gồm sáu khả năng, mỗi khả năng tương ứng với một mặt của xúc xắc.

-   **Phép thử** là mỗi lần lặp lại thí nghiệm ngẫu nhiên. Ví dụ, nếu mình tung đồng xu nhiều lần, thì mỗi lần tung chính là một phép thử của thí nghiệm đó.

-   **Biến cố** là một tập con của không gian mẫu. Có một số loại biến cố đặc biệt.

-   **Biến cố sơ cấp** là biến cố chỉ chứa một phần tử của không gian mẫu.

-   **Biến cố chắc chắn** là biến cố chứa tất cả các phần tử của không gian mẫu.

-   Ngược lại, **biến cố không thể có** là biến cố không chứa bất kỳ phần tử nào, ký hiệu là $\emptyset$. Trong thí nghiệm tung đồng xu hai lần, $\{\text{(S,S); (S,N); (N,S)}\}$ là biến cố có ít nhất một lần tung được mặt sấp. Biến cố này có thể được phân tích thành ba biến cố sơ sấp bao gồm $\{\text{(S,S)}\}$, $\{\text{(S,N)}\}$ và $\{\text{(N,S)}\}$.

Khi đồng xu được tung hai lần, mình có thể xác định phân phối xác suất như đã trình bày ở bảng trên. Tuy nhiên, một điều thú vị là xác suất của từng kết quả cụ thể, chẳng hạn $\mathbb{P}((S,N))$, có thể được tính bằng cách nhân xác suất của từng lần tung riêng lẻ: $$
\mathbb{P}((S,N))=\mathbb{P}(S)\cdot\mathbb{P}(N)=\frac{1}{2}\frac{1}{2}=\frac{1}{4}.
$$ Điều này áp dụng tương tự cho tất cả các kết quả khác, và ta có thể thấy rằng xác suất của một chuỗi các kết quả sẽ bằng tích của xác suất từng phần tử trong chuỗi đó. Đây là một tính chất rất quan trọng của các thí nghiệm ngẫu nhiên khi các sự kiện là độc lập với nhau.

Mình cần suy ngẫm sâu hơn...

Tuy nhiên, đôi khi mình cần gán xác suất khác nhau cho những kết quả khác nhau. Ví dụ, với bất kỳ số thực $p \in (0,1)$, phân phối Bernoulli với tham số p trên tập $\{0, 1\}$ sẽ gán giá trị $p$ cho 1 và $1 − p$ cho 0. Phân phối này thường dùng để mô phỏng việc tung một đồng xu lệch.

Bây giờ, giả sử mình tung một đồng xu công bằng $n$ lần. Nếu mình muốn theo dõi từng lần tung, thì không gian mẫu sẽ bao gồm tất cả các chuỗi dài $n$ chỉ chứa 0 và 1. Ví dụ, nếu $n = 5$, một chuỗi như 01101 có thể là một phần tử tiêu biểu. (Chuỗi này đại diện cho kết quả: sấp, ngửa, ngửa, sấp, ngửa theo đúng thứ tự.) Vì có tổng cộng $2^n$ chuỗi như vậy và tất cả đều có khả năng xảy ra như nhau, nên phân phối xác suất phù hợp sẽ là phân phối đều, gán xác suất $\frac{1}{2^n}$ cho mỗi chuỗi.

Nhưng nếu mình không quan tâm đến chuỗi cụ thể của các lần tung ngửa và sấp, mà chỉ muốn biết tổng số lần xuất hiện mặt ngửa thì sao? Trong trường hợp này, không gian mẫu của mình có thể là tập $\{0, 1, 2, \ldots, n\}$. Xác suất để tổng số mặt ngửa là $k$ sẽ bằng $\frac{1}{2^n}$ nhân với số lượng các chuỗi 0 và 1 có đúng $k$ số 1. Số này được tính bằng

$$
\binom{n}{k} = \frac{n!}{k!(n-k)!},
$$

do đó, xác suất mà chúng mình gán cho $k$ là

$$
p_k = \binom{n}{k}2^{-n}.
$$

Nói một cách tổng quát hơn, trong một chuỗi $n$ thí nghiệm độc lập, mỗi thí nghiệm có xác suất thành công là $p$, xác suất cho một chuỗi cụ thể với $k$ lần thành công và $n - k$ lần thất bại là $p^k(1 - p)^{n-k}$. Vì vậy, xác suất có đúng $k$ lần thành công sẽ là

$$
p_k = \binom{n}{k} p^k (1 - p)^{n-k}.
$$

Đây được gọi là phân phối nhị thức với các tham số $n$ và $p$. Nó mô phỏng số lần xuất hiện mặt ngửa nếu chúng mình tung một đồng xu lệch $n$ lần, chẳng hạn.

Giả sử chúng mình thực hiện những thí nghiệm này cho đến khi có được một lần thành công. Khi thực hiện $k$ thí nghiệm, xác suất để có $k - 1$ lần thất bại trước khi có thành công sẽ là

$$
p_k = (1-p)^{k-1}p.
$$

Công thức này cho chúng mình biết phân phối số thí nghiệm cho đến khi có lần thành công đầu tiên. Nó được gọi là phân phối hình học với tham số $p$. Đặc biệt, số lần tung một đồng xu công bằng để có mặt ngửa đầu tiên có phân phối hình học với tham số $\frac{1}{2}$. Lưu ý rằng không gian mẫu của chúng mình bây giờ là tập hợp tất cả các số nguyên không âm - nghĩa là nó là vô hạn. Vậy nên, trong trường hợp này, điều kiện rằng các xác suất cộng lại bằng 1 yêu cầu một chuỗi vô hạn nhất định (chuỗi $\sum_{k=1}^\infty p_k$) hội tụ về 1.

Hãy thử tưởng tượng một thí nghiệm thú vị hơn một chút nhé! Chúng ta có một nguồn phóng xạ, và thi thoảng nó sẽ phát ra một hạt á-l-phơ. Điều đáng chú ý là những lần phát ra này thường được coi là độc lập và có khả năng xảy ra bất cứ lúc nào. Nếu chúng ta biết rằng trung bình mỗi phút có $\lambda$ lần phát ra (ví dụ, nếu $\lambda=5$, điều này có nghĩa là trung bình trong một phút, nguồn phóng xạ sẽ phát ra khoảng 5 hạt á-l-phơ), vậy xác suất để trong một phút cụ thể có $k$ hạt được phát ra sẽ là bao nhiêu?

Một cách đơn giản để nghĩ về điều này là chia phút ra thành n khoảng thời gian nhỏ bằng nhau. Nếu n đủ lớn, thì xác suất để xảy ra hai lần phát ra trong cùng một khoảng thời gian sẽ cực kỳ nhỏ và có thể bỏ qua được. Do đó, với số phát ra trung bình là $\lambda$, xác suất phát ra trong bất kỳ khoảng thời gian nào sẽ gần bằng $\frac{\lambda}{n}$, và chúng ta có thể gọi con số này là $p$. Khi đó, vì các lần phát ra là độc lập, chúng ta có thể coi số lần phát ra giống như số thành công trong n thử nghiệm, mỗi thử nghiệm có xác suất thành công là $p$. Điều này có nghĩa là chúng ta đang sử dụng phân phối nhị phân với các tham số $n$ và $p$, trong đó $p=\frac{\lambda}{n}$.

Chú ý rằng khi n tăng lên, $p$ sẽ giảm xuống. Hơn nữa, các ước lượng mà chúng ta đưa ra sẽ ngày càng chính xác hơn. Do đó, thật tự nhiên khi để n tiến đến vô cùng và tìm hiểu về “phân phối giới hạn” mà nó tạo ra. Khi n tiến tới vô hạn, chúng ta có thể thấy rằng xác suất nhị phân hội tụ về $p_k = \frac{e^{-\lambda}\lambda^k}{k!}$. Những con số này tạo nên một phân phối trên tập hợp tất cả các số nguyên không âm, và chúng ta gọi đó là phân phối Poisson với tham số $\lambda$.

# 2. Không gian xác suất

Giả sử mình ném một mũi tên vào bảng phi tiêu. Mình không giỏi trong việc ném phi tiêu, nên không thể nói nhiều về nơi mũi tên sẽ rơi, nhưng ít nhất mình có thể thử mô hình hóa vấn đề này bằng xác suất. Không gian mẫu rõ ràng ở đây sẽ là một đĩa tròn, trong đó các điểm trên đĩa đại diện cho nơi mũi tên rơi xuống. Tuy nhiên, bây giờ có một vấn đề: nếu mình xem xét một điểm cụ thể nào đó trên đĩa, xác suất rằng mũi tên sẽ rơi chính xác vào điểm đó là bằng 0. Vậy làm thế nào để mình định nghĩa một phân phối xác suất?

Một gợi ý cho câu trả lời nằm ở chỗ dường như rất dễ hiểu khi mình hỏi, “Xác suất mình ném trúng hồng tâm là bao nhiêu?” Để ném trúng hồng tâm, phi tiêu phải rơi vào một vùng cụ thể trên bảng, và xác suất cho điều này không nhất thiết phải bằng 0. Chẳng hạn, xác suất đó có thể bằng diện tích của vùng hồng tâm chia cho tổng diện tích của cả bảng phi tiêu.

------------------------------------------------------------------------

## Tại sao xác suất rời vào một điểm nhất định phải bằng 0?

Xác suất rơi vào một điểm nhất định bằng 0 vì trong các không gian liên tục, chẳng hạn như một mặt phẳng hoặc một hình tròn, mỗi điểm riêng lẻ có kích thước bằng 0 so với toàn bộ không gian. Điều này có nghĩa là diện tích (hoặc độ đo) của một điểm cụ thể trên không gian đó là bằng 0.

Xác suất được xác định bằng cách so sánh kích thước của một vùng với kích thước toàn bộ không gian. Do mỗi điểm riêng lẻ không có diện tích, nên dù có ném phi tiêu bao nhiêu lần, khả năng phi tiêu rơi đúng vào một điểm cụ thể là cực kỳ nhỏ, gần như không thể. Thay vào đó, xác suất được gán cho các vùng có diện tích cụ thể, chẳng hạn như một vùng xung quanh điểm đó hoặc các khu vực như hồng tâm của bảng phi tiêu.

Tóm lại, xác suất cho một điểm cụ thể bằng 0 vì điểm đó không chiếm bất kỳ diện tích thực sự nào trong không gian liên tục.

------------------------------------------------------------------------

Điều mà chúng ta vừa nhận thấy là, ngay cả khi mình không thể gán xác suất cho từng điểm riêng lẻ trong không gian mẫu, chúng mình vẫn có thể gán xác suất cho các tập con. Cụ thể, nếu $\Omega$ là không gian mẫu và $A$ là một tập con của $\Omega$, bạn có thể gán một số $P(A)$ nằm trong khoảng từ 0 đến 1 cho tập $A$. Số này thể hiện xác suất rằng kết quả ngẫu nhiên thuộc về tập $A$, và mình có thể hình dung nó giống như "khối lượng" của tập $A$.

Để điều này hoạt động, chúng ta cần $P(\Omega) = 1$ (vì xác suất để kết quả nằm trong không gian mẫu $\Omega$ phải bằng 1). Ngoài ra, nếu $A$ và $B$ là hai tập con rời nhau của $\Omega$, thì $P(A \cup B)$ phải bằng $P(A) + P(B)$. Từ đó, chúng ta có thể suy ra rằng nếu $A_1, A_2, \dots, A_n$ là các tập con rời nhau, thì $P(A_1 \cup \dots \cup A_n)$ bằng với $P(A_1) + \dots + P(A_n)$.

Thực tế, điều này cần phải đúng không chỉ với các hợp hữu hạn mà còn với các hợp vô hạn đếm được. (Liên quan đến điều này là việc mình không cố gắng định nghĩa $P(A)$ cho mọi tập con $A$ của $\Omega$ mà chỉ cho các tập con đo được, còn gọi là các tập con “có thể đo lường được.” Đối với mục đích của chúng mình, chỉ cần $P(A)$ được xác định cho bất kỳ tập con nào mà chúng ta có thể thực sự định nghĩa.)

Một không gian xác suất là không gian mẫu $\Omega$ cùng với một hàm xác suất $P$, được định nghĩa trên tất cả các tập con "hợp lý" $A$ của $\Omega$, và nó phải thỏa mãn các điều kiện mà chúng ta đã nhắc đến ở các đoạn trên. Hàm $P$ này được gọi là một độ đo xác suất hoặc phân phối xác suất. Thuật ngữ phân phối xác suất thường được sử dụng khi chúng mình chỉ rõ $P$ một cách cụ thể.

# 3. Phân phối xác suất liên tục

Có ba phân phối đặc biệt quan trọng được định nghĩa trên các tập con của $\mathbb{R}$, trong đó hai phân phối sẽ được thảo luận trong phần này. Phân phối đầu tiên là phân phối đồng nhất trên khoảng $[0, 1]$. Chúng ta muốn nắm bắt ý tưởng rằng “tất cả các điểm trong khoảng $[0, 1]$ đều có xác suất như nhau.” Vậy, với những vấn đề đã nêu ở trên, chúng ta nên làm điều này như thế nào?

------------------------------------------------------------------------

Để mô tả phân phối đồng nhất trên khoảng $[0, 1]$, chúng ta có thể xác định rằng xác suất cho một tập con $A$ của khoảng này sẽ bằng tỷ lệ diện tích của tập $A$ so với tổng diện tích của khoảng $[0, 1]$. Cụ thể, nếu $A$ là một đoạn con nào đó trong $[0, 1]$, thì xác suất mà biến ngẫu nhiên rơi vào trong tập $A$ sẽ là:

$$
P(A) = \text{độ dài của } A
$$

Vì tổng độ dài của khoảng $[0, 1]$ là 1, nên xác suất này tự động đảm bảo rằng $P([0, 1]) = 1$. Từ đó, ta có thể dễ dàng tính xác suất cho bất kỳ tập con nào của $[0, 1]$ mà không gặp phải vấn đề về xác suất của các điểm riêng lẻ bằng 0. Cách tiếp cận này cho phép chúng ta sử dụng phân phối đồng nhất một cách tự nhiên và hiệu quả trong việc mô hình hóa các biến ngẫu nhiên liên tục trên đoạn $[0, 1]$.

------------------------------------------------------------------------

Một cách hay để thực hiện điều này là nghiêm túc xem xét phép ẩn dụ về “khối lượng”. Mặc dù chúng ta không thể tính khối lượng của một vật thể bằng cách cộng tất cả các khối lượng của những điểm nhỏ vô hạn tạo thành vật thể đó, nhưng chúng ta có thể gán cho những điểm đó một mật độ và tích phân nó. Đó chính xác là những gì chúng ta sẽ làm ở đây. Chúng ta sẽ gán một mật độ xác suất bằng 1 cho mỗi điểm trong khoảng $[0, 1]$. Sau đó, chúng ta sẽ xác định xác suất của một đoạn con, chẳng hạn như $\left[\frac{1}{3}, \frac{1}{2}\right]$, bằng cách tính tích phân:

$$
P\left(\left[\frac{1}{3},\frac{1}{2}\right]\right) = \int_\frac{1}{3}^\frac{1}{2} 1 \, dx = \frac{1}{6}.
$$

Một cách tổng quát hơn, xác suất liên quan đến một khoảng $[a, b]$ sẽ là độ dài của nó $b - a$. Xác suất của một hợp của các khoảng không chồng chéo sẽ là tổng độ dài của những khoảng đó, và cứ như vậy.

Phân phối đồng nhất “liên tục” này đôi khi xuất hiện một cách tự nhiên từ các yêu cầu về tính đối xứng, giống như phân phối rời rạc của nó. Nó cũng có thể xuất hiện như một phân phối giới hạn. Ví dụ, giả sử rằng một người ẩn sĩ sống sâu trong một cái hang, xa khỏi bất kỳ chiếc đồng hồ hay nguồn ánh sáng tự nhiên nào, và mỗi “ngày” anh ta trải qua có độ dài thời gian ngẫu nhiên giữa hai mươi ba và hai mươi lăm giờ. Ban đầu, anh ta sẽ có một ý tưởng về thời gian và có thể đưa ra những phát biểu như: “Tôi đang ăn trưa bây giờ, nên có lẽ bên ngoài trời vẫn sáng,” nhưng sau vài tuần trong chế độ này, anh ta sẽ không còn ý tưởng nào nữa: bất kỳ thời gian nào bên ngoài đều có khả năng xảy ra như nhau.

------------------------------------------------------------------------

## Từ đâu người ta nghĩ ra ý tưởng mật độ? Nó không hề tự nhiên.

Cảm ơn bạn đã chỉ ra điều này! Khái niệm gán mật độ xác suất cho các điểm trong một khoảng liên tục thực sự là một ý tưởng sâu sắc và không phải lúc nào cũng rõ ràng. Dưới đây là một số bước phát triển lịch sử và tư duy có thể đã dẫn đến ý tưởng này:

### 1. **Vấn đề xác suất trong không gian liên tục**

Khi nghiên cứu về xác suất, người ta nhận thấy rằng trong các không gian rời rạc (như xác suất tung đồng xu hay xổ số), việc xác định xác suất cho từng sự kiện đơn lẻ là dễ dàng. Tuy nhiên, trong không gian liên tục (như các số thực), xác suất của việc xảy ra tại một điểm cụ thể lại là 0. Điều này đã đặt ra một câu hỏi lớn: Làm thế nào để định nghĩa xác suất trong không gian liên tục?

### 2. **Khái niệm về diện tích**

Trong hình học, khi chúng ta muốn tính diện tích dưới một đường cong (như hàm số), chúng ta chia diện tích đó thành các phần nhỏ hơn và lấy tổng diện tích của chúng. Nguyên lý này có thể được áp dụng tương tự trong xác suất. Nếu chúng ta coi một hàm mật độ xác suất là “đường cong” và các khoảng là “diện tích”, thì xác suất của một khoảng có thể được hiểu là diện tích dưới đường cong này.

### 3. **Tích phân và đo lường**

Sự phát triển của lý thuyết tích phân trong toán học, đặc biệt là công trình của **Newton** và **Leibniz**, đã giúp chúng ta hình dung rõ hơn về cách tính toán diện tích dưới các đường cong. Sau đó, các nhà toán học như **Borel** và **Lebesgue** đã phát triển lý thuyết đo lường, cho phép định nghĩa các khái niệm về kích thước và xác suất trong không gian không rời rạc.

### 4. **Phân phối và mật độ**

Khi các nhà toán học bắt đầu xây dựng các mô hình cho các hiện tượng ngẫu nhiên trong thế giới thực (như phân phối chiều dài hoặc thời gian), họ nhận ra rằng việc gán một mật độ cho từng điểm trong một khoảng liên tục sẽ giúp họ tính toán xác suất cho các sự kiện xảy ra trong khoảng đó. Khái niệm này trở thành nền tảng cho các phân phối như phân phối chuẩn, phân phối Poisson, và nhiều loại phân phối khác.

### 5. **Nguyên lý bất định**

Một yếu tố khác có thể đã ảnh hưởng đến tư duy này là **nguyên lý bất định** trong vật lý. Trong một số trường hợp, xác suất không thể xác định chính xác cho các sự kiện, và việc gán một giá trị trung bình hoặc mật độ cho các sự kiện giúp mô hình hóa các hiện tượng phức tạp hơn.

### Tóm lại

Khái niệm gán mật độ xác suất cho các điểm trong không gian liên tục xuất phát từ nhu cầu giải quyết các vấn đề xác suất phức tạp trong thế giới thực và từ sự phát triển của các công cụ toán học như tích phân và lý thuyết đo lường. Qua thời gian, nó đã trở thành một công cụ mạnh mẽ trong xác suất và thống kê, giúp chúng ta hiểu rõ hơn về các hiện tượng ngẫu nhiên.

## Trong không gian mẫu liên tục, xác suất tại một điểm bằng không - cái này còn có thể tưởng tượng được. Nhưng mật độ tại điểm đó sẽ là gì? Làm sao tưởng tượng ra?

Bạn đặt ra một câu hỏi rất thú vị và sâu sắc! Để giải thích rõ hơn về khái niệm "mật độ" tại một điểm trong không gian mẫu liên tục, chúng mình có thể bắt đầu từ việc làm rõ sự khác biệt giữa **xác suất** và **mật độ xác suất**:

### 1. **Xác suất tại một điểm bằng 0**

Khi ta nói trong không gian liên tục (như khoảng [0, 1]), xác suất tại một điểm cụ thể là 0, điều này có nghĩa là **khả năng chính xác** xảy ra tại một điểm riêng lẻ là cực kỳ nhỏ (trong lý thuyết, bằng không). Tuy nhiên, điều này không có nghĩa là toàn bộ xác suất cho mọi sự kiện đều bằng 0. Xác suất chỉ có ý nghĩa khi xét đến **các khoảng** giá trị, tức là tập hợp nhiều điểm.

### 2. **Mật độ xác suất là gì?**

Mật độ xác suất (hay còn gọi là hàm mật độ xác suất, viết tắt là PDF - Probability Density Function) không phải là xác suất của một điểm mà là **mức độ "tập trung" của xác suất xung quanh điểm đó**. Nghĩa là, mật độ xác suất tại một điểm chỉ cho chúng ta biết **"xác suất tại vùng lân cận của điểm đó"** dày đặc hay thưa thớt.

-   Mật độ xác suất cao tại một điểm nào đó có nghĩa là trong vùng gần điểm đó, xác suất xảy ra các sự kiện lớn.
-   Mật độ xác suất thấp tại một điểm có nghĩa là vùng gần điểm đó có ít xác suất hơn.

### 3. **Cách tưởng tượng mật độ xác suất tại một điểm**

Chúng ta có thể tưởng tượng mật độ xác suất như sau:

-   **Hình dung không gian liên tục như một đường** (ví dụ khoảng [0, 1]). Trên đường này, chúng ta có một số khu vực mà các sự kiện ngẫu nhiên có thể xảy ra dày đặc hơn (xác suất cao) và một số khu vực khác ít xảy ra (xác suất thấp).
-   **Mật độ tại một điểm** tương tự như chiều cao của một đường cong đặt lên đường đó. Đường cong này biểu thị sự phân bổ xác suất dọc theo không gian.
    -   Nếu chiều cao tại một điểm lớn, mật độ tại đó cao.
    -   Nếu chiều cao thấp, mật độ tại đó thấp.

Một cách hình dung khác là:

-   Mật độ tại một điểm không cho chúng ta biết "xác suất tại điểm đó" (vì xác suất tại điểm riêng lẻ luôn bằng 0), nhưng nó giúp chúng ta biết **"xác suất xảy ra trong vùng rất nhỏ xung quanh điểm đó"**. Nếu vùng nhỏ này có diện tích (khoảng) rất bé, thì xác suất gần điểm đó sẽ được tính bằng cách nhân mật độ với độ rộng của khoảng đó.

### 4. **Mật độ xác suất và tích phân**

Một yếu tố toán học quan trọng liên quan đến mật độ là tích phân. Mật độ xác suất được xác định để khi ta tính tích phân mật độ trên một khoảng [a, b], kết quả sẽ là xác suất xảy ra trong khoảng [a, b]. Điều này làm cho mật độ tại từng điểm trở thành công cụ toán học hữu ích cho việc tính xác suất trên các khoảng liên tục, mặc dù chính nó không phải là xác suất.

### Ví dụ về hình ảnh trực quan:

-   Hãy tưởng tượng bạn đang đi trên một con đường mòn và tại mỗi đoạn của con đường, bạn gặp các biển báo dày đặc hay thưa thớt.
    -   Nếu tại một đoạn nào đó, biển báo được đặt dày đặc, điều này tương ứng với mật độ xác suất cao – khả năng bạn sẽ nhìn thấy biển báo gần đó rất cao.
    -   Nếu đoạn khác thưa biển báo, tương ứng với mật độ xác suất thấp – khả năng gặp biển báo ít đi.

### 5. **Mật độ tại một điểm cụ thể**

Dù mật độ xác suất tại một điểm có thể cao hay thấp, bạn vẫn không thể quy một giá trị xác suất cụ thể cho **chính** điểm đó vì xác suất tại một điểm trong không gian liên tục là 0. Nhưng mật độ tại điểm đó sẽ cho bạn biết điều gì sẽ xảy ra trong **lân cận** của điểm đó.

### Kết luận

Tóm lại, mật độ xác suất tại một điểm trong không gian liên tục không phải là xác suất tại điểm đó mà là sự biểu thị mức độ "đậm đặc" của xác suất xung quanh điểm đó. Điều này có ý nghĩa toán học quan trọng, giúp ta tính toán xác suất cho các khoảng liên tục, và nhờ khái niệm này, xác suất có thể được định nghĩa và tính toán ngay cả khi xác suất tại từng điểm cụ thể bằng 0.

Câu hỏi bạn đặt ra là rất tinh tế, và hy vọng cách giải thích này giúp bạn hình dung rõ hơn về khái niệm mật độ xác suất!

------------------------------------------------------------------------

Hãy cùng nhìn vào một hàm mật độ thú vị hơn một chút, và phụ thuộc vào một hằng số dương $\lambda$. Xét hàm mật độ $f(x) =\lambda e^{-\lambda x}$, được định nghĩa trên tập hợp tất cả các số thực không âm. Để tính xác suất liên quan đến một khoảng $[a, b]$, chúng mình sẽ tính tích phân:

$$
\int_a^b f(x)dx = \int_a^b \lambda e^{-\lambda x} dx = e^{-\lambda a} - e^{-\lambda b}
$$

Phân phối xác suất thu được từ hàm mật độ này được gọi là **phân phối mũ** với tham số $\lambda$. Phân phối mũ thường phù hợp nếu chúng mình đang mô hình hóa thời gian $t$ của một sự kiện ngẫu nhiên, chẳng hạn như thời gian để một hạt nhân phóng xạ phân rã hoặc thời gian đợi email spam tiếp theo đến.

Lý do phân phối này phù hợp là do giả định tính **không nhớ**. Ví dụ, nếu chúng ta biết rằng hạt nhân vẫn còn nguyên vẹn tại thời điểm $s$, xác suất rằng nó sẽ còn nguyên đến thời điểm $s + t$ là giống với xác suất ban đầu rằng nó sẽ còn nguyên đến thời điểm $t$. Hãy để $G(t)$ đại diện cho xác suất rằng hạt nhân còn nguyên đến thời điểm $t$. Khi đó, xác suất rằng nó sẽ còn nguyên đến thời điểm $s + t$, với điều kiện là nó đã còn nguyên đến thời điểm $s$, là $\frac{G(s + t)}{G(s)}$, và điều này phải bằng $G(t)$.

Tương đương, ta có phương trình:

$$
G(s + t) = G(s) G(t)
$$

Chỉ có các hàm giảm theo dạng hàm mũ mới có tính chất này, tức là các hàm có dạng $G(t) = e^{-\lambda t}$ với một số dương $\lambda$. Vì $1 - G(t)$ đại diện cho xác suất hạt nhân phân rã trước thời điểm $t$, điều này phải bằng:

$$
\int_0^t f(x)dx
$$

Từ đây, chúng mình dễ dàng suy ra rằng $f(x)=\lambda e^{-\lambda x}$.

Ngay sau đây, chúng mình sẽ khám phá đến phân phối thứ ba, và quan trọng nhất.

------------------------------------------------------------------------

# Biến ngẫu nhiên, trung bình và phương sai

Trong một không gian xác suất, một sự kiện được định nghĩa là một tập con (đủ đẹp) của không gian đó. Ví dụ, nếu không gian xác suất là khoảng $[0, 1]$ với phân phối đồng nhất, thì khoảng $\left[\frac{1}{2},1\right]$ là sự kiện đại diện cho việc một số được chọn ngẫu nhiên từ 0 đến 1 sẽ có giá trị ít nhất là $\frac{1}{2}$.

Thường thì, thật hữu ích không chỉ nghĩ về các sự kiện ngẫu nhiên, mà còn về các số ngẫu nhiên liên quan đến một không gian xác suất. Ví dụ, hãy xem lại chuỗi các lần tung một đồng xu thiên lệch với xác suất $p$ cho mặt ngửa. Không gian mẫu tự nhiên liên quan đến thí nghiệm này là tập $\Omega$ của tất cả các chuỗi $\omega$ gồm các số 0 và 1. Trước đây, chúng ta đã chỉ ra rằng xác suất để có được $k$ mặt ngửa là $p_k=\binom{n}{k} p^k(1 - p)^{n-k}$, và chúng ta mô tả điều đó như một phân phối trên không gian mẫu $\{0, 1, 2, \ldots, n\}$. Tuy nhiên, trong nhiều trường hợp, việc coi tập hợp ban đầu $\Omega$ là không gian mẫu và định nghĩa một hàm $X$ từ $\Omega$ tới $\mathbb{R}$ để đại diện cho số mặt ngửa sẽ tự nhiên hơn và thường thuận tiện hơn: tức là, $X(\omega)$ là số lượng 1 trong chuỗi $\omega$. Sau đó, chúng ta có thể viết

$$
P(X = k) = p_k = \binom{n}{k} p^k(1 - p)^{n-k}.
$$

Một hàm như vậy được gọi là một biến ngẫu nhiên. Nếu $X$ là một biến ngẫu nhiên và nó nhận các giá trị trong một tập $Y$, thì phân phối của $X$ là hàm $P$ được định nghĩa trên các tập con của $Y$ theo công thức

$$
P(A) = P(X \in A) = P(\{\omega \in \Omega : X(\omega) \in A\}).
$$

Không khó để thấy rằng $P$ thực sự là một phân phối xác suất trên $Y$.

Trong nhiều trường hợp, chỉ cần biết phân phối của một biến ngẫu nhiên là đủ. Tuy nhiên, khái niệm về biến ngẫu nhiên được định nghĩa trên một không gian mẫu giúp chúng ta nắm bắt trực giác về một đại lượng ngẫu nhiên và cho phép chúng ta đặt ra những câu hỏi sâu hơn. Ví dụ, nếu chúng ta hỏi về xác suất có $k$ mặt ngửa, biết rằng lần tung đầu tiên và cuối cùng có kết quả giống nhau, thì phân phối của $X$ sẽ không cung cấp câu trả lời, trong khi mô hình phong phú hơn của chúng ta về việc coi $X$ là một hàm được định nghĩa trên các chuỗi sẽ làm được điều đó. Hơn nữa, chúng ta có thể nói về các biến ngẫu nhiên độc lập, chẳng hạn như $X_1, \ldots, X_n$, có nghĩa là tập hợp con của $\Omega$ nơi $X_i(\omega) \in A_i$ cho tất cả các $i$ có xác suất được cho bởi tích $P(X_1 \in A_1) \times \cdots \times P(X_n \in A_n)$ cho tất cả các tập hợp giá trị có thể $A_i$.

Liên quan đến một biến ngẫu nhiên $X$ là hai giá trị quan trọng giúp mô tả nó, được gọi là **giá trị trung bình** hay **kỳ vọng** $E(X)$ và **phương sai** $\mathrm{var}(X)$. Cả hai giá trị này đều được xác định bởi phân phối của $X$. Nếu $X$ nhận các giá trị nguyên với xác suất $P(X=k)=p_k$, thì:

$$
E(X) = \sum_k k p_k, \quad \mathrm{var}(X) = \sum_k (k - \mu)^2 p_k, \quad \text{trong đó} \ \mu = E(X).
$$

Giá trị trung bình cho biết $X$ có xu hướng lớn bao nhiêu, tức là giá trị trung bình của nó. Còn phương sai, hay chính xác hơn là căn bậc hai của phương sai (gọi là **độ lệch chuẩn** $\sigma = \sqrt{\mathrm{var}(X)}$), cho chúng ta biết $X$ thường cách xa giá trị trung bình bao nhiêu.

Có một công thức hữu ích khác cho phương sai là: $$
\mathrm{var}(X) = E(X^2) - (E(X))^2.
$$ Để hiểu ý nghĩa của phương sai, hãy xem xét tình huống sau: Giả sử có 100 người làm một bài thi, và bạn được biết điểm trung bình của họ là 75%. Thông tin này cung cấp cho bạn một số hiểu biết, nhưng không hoàn toàn mô tả chính xác sự phân bố điểm. Ví dụ, có thể bài thi gồm 4 câu hỏi, trong đó 3 câu rất dễ và 1 câu gần như không thể, nên hầu hết mọi người có điểm gần 75%. Hoặc có thể có khoảng 50 người đạt điểm tuyệt đối, trong khi 50 người khác chỉ đạt khoảng 50%.

Để mô hình hóa tình huống này, ta coi không gian mẫu $\Omega$ là tập hợp 100 người, với phân phối xác suất đều nhau (phân phối đều). Với một người ngẫu nhiên $\omega$, ta định nghĩa $X(\omega)$ là điểm số của người đó. Trong tình huống đầu tiên, phương sai sẽ nhỏ vì hầu hết điểm số đều gần với trung bình 75%. Ngược lại, trong tình huống thứ hai, phương sai sẽ xấp xỉ $25^2 = 625$, vì hầu hết mọi người có điểm số cách xa trung bình khoảng 25 điểm. Do đó, phương sai giúp chúng ta hiểu sự khác biệt giữa hai tình huống này.

Như đã thảo luận ở đầu bài, từ kinh nghiệm ta biết rằng số lần xuất hiện mặt ngửa trong $n$ lần tung đồng xu công bằng có xu hướng xấp xỉ $\frac{n}{2}$, tức là tỷ lệ thường gần với $\frac{1}{2}$. Nếu $X$ là số lần xuất hiện mặt ngửa trong $n$ lần tung (phân phối nhị thức với các tham số $n$ và $\frac{1}{2}$), ta có:

$$
E(X) = \frac{n}{2}.
$$

Phương sai của $X$ là $\frac{n}{4}$, do đó, độ lệch chuẩn là $\sigma=\frac{1}{2}\sqrt{n}$. Điều này giúp chúng ta thấy rằng, với xác suất gần bằng 1 khi $n$ lớn, tỷ lệ $X/n$ sẽ gần với $\frac{1}{2}$, đúng như kinh nghiệm cho thấy.

Tổng quát hơn, nếu $X_1, X_2, \dots, X_n$ là các biến ngẫu nhiên độc lập, thì:

$$
\mathrm{var}(X_1 + \cdots + X_n) = \mathrm{var}(X_1) + \cdots + \mathrm{var}(X_n).
$$

Từ đó suy ra, nếu tất cả các $X_i$ có cùng phân phối với kỳ vọng $\mu$ và phương sai $\sigma^2$, thì phương sai của trung bình mẫu $\bar{X} = \frac{1}{n}(X_1 + \cdots + X_n)$ là:

$$
\mathrm{var}(\bar{X}) = \frac{1}{n^2}(n\sigma^2) = \frac{\sigma^2}{n},
$$

và phương sai này tiến về 0 khi $n$ tiến đến vô cùng. Quan sát này có thể được dùng để chứng minh rằng, với bất kỳ $\epsilon > 0$, xác suất của sự kiện $\lvert\bar{X} - \mu\rvert$ lớn hơn $\epsilon$ sẽ tiến đến 0 khi $n$ tiến đến vô cùng. Như vậy, trung bình mẫu "hội tụ về xác suất" tới kỳ vọng $\mu$.

Kết quả này được gọi là **luật số lớn yếu**. Lập luận sơ lược ở trên ngầm giả định rằng các biến ngẫu nhiên có phương sai hữu hạn, nhưng giả định này thực ra không cần thiết. Cũng có một kết quả mạnh hơn, gọi là **luật số lớn mạnh**, phát biểu rằng, với xác suất bằng 1, trung bình mẫu của các biến ngẫu nhiên đầu tiên hội tụ về $\mu$ khi $n$ tiến đến vô cùng. Như tên gọi, luật số lớn mạnh mạnh hơn luật số lớn yếu, theo nghĩa rằng có thể suy ra luật số lớn yếu từ luật số lớn mạnh.

Lưu ý rằng các luật này đưa ra những dự đoán dài hạn có tính thống kê về các sự kiện thực tế mà chúng ta đã chọn để mô hình hóa bằng lý thuyết xác suất. Hơn nữa, những dự đoán này có thể được kiểm chứng thông qua các thí nghiệm thực tế, và bằng chứng thực nghiệm đã xác nhận chúng. Điều này cung cấp một cơ sở khoa học thuyết phục cho các mô hình của chúng ta.

# 5. Phân phối chuẩn và định lý giới hạn trung tâm

Như chúng ta đã thấy, đối với phân phối nhị thức với tham số $n$ và $p$, xác suất $p_k$ được cho bởi công thức:

$$
p_k = \binom{n}{k} p^k (1 - p)^{n-k}.
$$

Nếu $n$ lớn và bạn vẽ các điểm $(k, p_k)$ trên một đồ thị, bạn sẽ nhận thấy rằng chúng nằm trên một đường cong hình chuông với đỉnh nhọn quanh giá trị kỳ vọng $np$. Độ rộng của phần cao của đường cong có bậc độ lớn là $\sqrt{np(1 - p)}$, tức là độ lệch chuẩn của phân phối. Giả sử đơn giản rằng $np$ là một số nguyên, và chúng ta định nghĩa một phân phối xác suất mới $q_k$ bằng cách:

$$
q_k = p_{k+np}.
$$

Các điểm $(k, q_k)$ đạt cực đại tại $k = 0$. Nếu bạn thu nhỏ đồ thị lại theo phương ngang với hệ số $\sqrt{np(1 - p)}$ và phóng to theo phương dọc với cùng hệ số, thì các điểm này sẽ nằm gần với đồ thị của hàm:

$$
f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}.
$$

Đây là hàm mật độ của một phân phối nổi tiếng, gọi là phân phối chuẩn tắc trên $\mathbb{R}$, hay còn được gọi là phân phối Gaussian.

Nói cách khác, nếu bạn tung đồng xu không đồng đều nhiều lần, thì số lần xuất hiện mặt ngửa, trừ đi giá trị kỳ vọng và chia cho độ lệch chuẩn, sẽ gần giống với một biến ngẫu nhiên chuẩn tắc chuẩn.

Hàm $\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}$ xuất hiện trong rất nhiều ngữ cảnh toán học, từ lý thuyết xác suất cho đến phân tích Fourier và cơ học lượng tử. Tại sao lại như vậy? Câu trả lời, như đối với nhiều câu hỏi tương tự, là có những tính chất mà hàm này có mà không hàm nào khác có được.

Một tính chất như vậy là **tính bất biến đối với quay**. Giả sử một lần nữa rằng chúng ta ném phi tiêu vào bảng phi tiêu và nhắm vào tâm điểm. Chúng ta có thể mô hình hóa điều này bằng cách cộng hai phân phối chuẩn tắc độc lập ở hai trục vuông góc với nhau: một cho tọa độ $x$ và một cho tọa độ $y$ (cả hai đều có kỳ vọng là 0 và phương sai là 1). Khi đó, hàm mật độ hai chiều sẽ được cho bởi công thức:

$$
\frac{1}{2\pi} e^{-\frac{x^2}{2}} e^{-\frac{y^2}{2}},
$$

và có thể được viết gọn thành:

$$
\frac{1}{2\pi} e^{-\frac{r^2}{2}},
$$

trong đó $r$ là độ dài của $(x, y)$. Nói cách khác, hàm mật độ phụ thuộc duy nhất vào khoảng cách từ gốc tọa độ. (Đây là lý do nó được gọi là "bất biến đối với quay"). Tính chất hấp dẫn này cũng đúng trong không gian nhiều chiều hơn.

Và thực tế là khá dễ kiểm chứng rằng $\frac{1}{2\pi}e^{-\frac{r^2}{2}}$ là hàm duy nhất có tính bất biến đối với quay: chính xác hơn, nó là hàm mật độ duy nhất bất biến đối với quay và biến các tọa độ $x$ và $y$ thành các biến ngẫu nhiên độc lập với phương sai 1. Do đó, phân phối chuẩn tắc có một tính đối xứng đặc biệt.

Các tính chất như vậy phần nào giải thích được sự phổ biến của phân phối chuẩn tắc trong toán học. Tuy nhiên, phân phối chuẩn tắc còn có một tính chất đáng chú ý hơn, giúp giải thích sự xuất hiện của nó ở bất cứ nơi nào mà toán học được sử dụng để mô hình hóa sự ngẫu nhiên trong thế giới thực. **Định lý giới hạn trung tâm** phát biểu rằng, đối với bất kỳ dãy các biến ngẫu nhiên độc lập và phân phối giống nhau $X_1, X_2, \ldots$ (với kỳ vọng hữu hạn $\mu$ và phương sai hữu hạn khác không $\sigma^2$), ta có:

$$
\lim_{n \to \infty} \mathbb{P}(X_1 + \cdots + X_n \leq n\mu + \sqrt{n}\sigma x) = \int_{-\infty}^{x} \frac{1}{\sqrt{2\pi}} e^{-\frac{r^2}{2}} dy
$$

với mọi số thực $x$. Kỳ vọng của $X_1 + \cdots + X_n$ là $n\mu$ và độ lệch chuẩn của nó là $\sqrt{n}\sigma$, vì vậy một cách suy nghĩ khác về điều này là đặt:

$$
Y_n = \frac{X_1 + \cdots + X_n - n\mu}{\sqrt{n}\sigma}.
$$

Điều này chuẩn hóa $X_1 + \cdots + X_n$ về trung bình 0 và phương sai 1, và xác suất trở thành xác suất rằng $Y_n \leq x$. Do đó, bất kể phân phối ban đầu là gì, phân phối giới hạn của tổng của nhiều bản sao độc lập sẽ là phân phối chuẩn tắc (sau khi đã tái chuẩn hóa thích hợp). Nhiều quá trình tự nhiên có thể được mô hình hóa một cách thực tế như là sự tích lũy của các tác động ngẫu nhiên nhỏ và độc lập, và điều này lý giải vì sao nhiều phân phối mà ta quan sát được, chẳng hạn như phân phối chiều cao của người lớn trong một thị trấn nhất định, có dạng đường cong hình chuông quen thuộc.

Một ứng dụng hữu ích của định lý giới hạn trung tâm là đơn giản hóa các phép tính tưởng chừng như phức tạp không thể giải quyết được. Ví dụ, khi tham số $n$ lớn, việc tính toán xác suất của phân phối nhị thức trở nên vô cùng phức tạp. Nhưng nếu $X$ là một biến ngẫu nhiên nhị thức, với các tham số $n$ và $1/2$, chẳng hạn, thì ta có thể viết $X$ như tổng $Y_1 + \cdots + Y_n$, trong đó $Y_1,\ldots,Y_n$ là các biến ngẫu nhiên Bernoulli độc lập với tham số $1/2$. Sau đó, theo định lý giới hạn trung tâm:

$$
\lim_{n \to \infty} \mathbb{P}\left(X \leq \frac{n}{2} + \frac{1}{2} \sqrt{n} x\right) = \int_{-\infty}^{x} \frac{1}{\sqrt{2\pi}} e^{-\frac{y^2}{2}} dy.
$$
