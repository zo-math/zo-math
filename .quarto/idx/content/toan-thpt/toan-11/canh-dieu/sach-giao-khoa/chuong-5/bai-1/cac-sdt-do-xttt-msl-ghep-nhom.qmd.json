{"title":"Bài 1. Các số đặc trưng đo xu thế trung tâm cho mẫu số liệu ghép nhóm","markdown":{"yaml":{"title":"Bài 1. Các số đặc trưng đo xu thế trung tâm cho mẫu số liệu ghép nhóm","subtitle":"Chương 5 | Cánh Diều | Toán 11","author":"ZO | `r Sys.Date()`"},"headingText":"library(ggplot2)","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(dplyr)\nlibrary(MASS)\n```\n\nNếu không có yêu cầu làm tròn đặc biệt, các con số sẽ được làm tròn đến 4 chữ số thập phân để tiện đối chiếu khi bạn tự tìm đáp án. \n\n# Bài học\n\n<!-- Hoạt động 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 1}\n:::\n\nTrong *Bảng 1*, ta thấy:\n\n- Có 13 ô-tô có độ tuổi dưới 4;\n- Có 29 ô-tô có độ tuổi từ 4 đến dưới 8.\n\nHãy xác định số ô-tô có độ tuổi:\n\n- Từ 8 đến dưới 12;\n- Từ 12 đến dưới 16;\n- Từ 16 đến dưới 20.\n\n<!-- Khung dữ liệu Hoạt động 1 -->\n\n```{r}\nhd1 <- new.env()\nhd1$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([0;4)\\\\)\", \"\\\\([4;8)\\\\)\", \"\\\\([8;12)\\\\)\", \"\\\\([12;16)\\\\)\", \"\\\\([16;20)\\\\)\"),\n    `Mút trái` = seq(0, 16, by = 4),\n    `Mút phải` = seq(4, 20, by = 4),\n    `Giá trị đại diện` = .5 * (seq(0, 16, by = 4) + seq(4, 20, by = 4)),\n    `Tần số` = c(13, 29, 48, 22, 8),\n    `Tần số tích lũy` = cumsum(c(13, 29, 48, 22, 8)),\n    check.names = FALSE\n)\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\"))\n# Chọn định dạng dựa vào output\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 1\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" icon=\"false\"}\nBạn có biết? Khi chưa quen với cách lập luận, bắt chước sách giáo khoa là một cách tốt để làm quen với cách trình bày. Khi đã hiểu rõ, bạn có thể tự phát triển cách lập luận của riêng mình.\n:::\n\nTừ *Bảng 1*, quan sát theo hàng để đếm số ô-tô trong từng nhóm độ tuổi.\n\n- Có 48 ô-tô có độ tuổi từ 8 đến dưới 12.\n- Có 22 ô-tô có độ tuổi từ 12 đến dưới 16.\n- Có 8 ô-tô có độ tuổi từ 16 đến dưới 20.\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Nhóm & tần số\" collapse=\"true\" icon=\"false\"}\n\nViệc xác định có 13 ô-tô có độ tuổi dưới 4 cho mình biết rằng nhóm $[0;4)$ có tần số 13.\n\n- **Nhóm**: $[a; b)$, chứa một số giá trị của mẫu số liệu, $a$ là *đầu mút trái*, $b$ là *đầu mút phải*. *Độ dài* nhóm là $b-a$.\n- **Tần số**: số giá trị của mẫu số liệu có trong nhóm $[a; b)$.\n\nBiết có 13 ô-tô có độ tuổi dưới 4, nhưng không biết tuổi cụ thể của từng ô-tô. \n:::\n\n::: {.callout-note title=\"Khám phá\" collapse=\"true\" icon=\"false\"}\nNhìn vào bảng số liệu, bạn có nhận xét gì về số lượng ô-tô theo từng nhóm độ tuổi?\n\n- Số lượng ô-tô cũ (trên 12 năm) có ít hơn xe mới không?\n- Điều này có ý nghĩa gì?\n:::\n\n</details>\n\n<!-- Luyện tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 1</summary>\n:::\n\n:::{.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 1}\n:::\n\nMẫu số liệu ghép nhóm ở *Bảng 1* có bao nhiêu số liệu? Bao nhiêu nhóm? Tìm tần số của mỗi nhóm.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\"))\n# Chọn định dạng dựa vào output\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 1\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Luyện tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 1</summary>\n:::\n\n:::{.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n- Mẫu số liệu ghép nhóm ở *Bảng 1* có 120 số liệu, chính là tổng của cột Tần số. \n- Mẫu số liệu này có 5 nhóm, bao gồm $[0;4)$, $[4;8)$, $[8;12)$, $[12;16)$ và $[16;20)$. Để ngắn gọn, gọi các nhóm này lần lượt là 1, 2, 3, 4 và 5.\n- Tần số của các nhóm 1, 2, 3, 4, 5 lần lượt là 13, 29, 48, 22, 8.\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 2}\n:::\n\nMột trường trung học phổ thông chọn 36 học sinh nam của khối lớp 11, đo chiều cao của các bạn học sinh đó và thu được mẫu số liệu sau (đơn vị: cm):\n\n<!-- Dữ liệu Hoạt động 2 -->\n\n```{r, echo = FALSE}\nhd2 <- new.env()\n# Tạo dữ liệu\nhd2$data <- c(160, 161, 161, 162, 162, 162, 163, 163, 163, 164, 164, 164, 164, 165, 165, 165, 165, 165, 166, 166, 166, 166, 167, 167, 168, 168, 168, 168, 169, 169, 170, 171, 171, 172, 172, 174)\ndata <- matrix(hd2$data, nrow = 3, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\nTừ mẫu số liệu không ghép nhóm trên, hãy ghép các số liệu thành năm nhóm theo các nửa khoảng có độ dài bằng nhau.\n\n</details>\n\n<!-- Lời giải Hoạt động 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\nLời giải\n\\end{center}\n:::\n\n::: {.callout-note title=\"Nhận thức quan trọng\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nỞ Hoạt động 1, chúng mình làm việc với một bảng tần số ghép nhóm đã có sẵn, nhưng không biết chính xác các số liệu gốc.\n\nSang Hoạt động 2, tình huống đảo ngược: số liệu cụ thể được cho, nhưng bảng tần số thì chưa có. Nhiệm vụ của chúng mình là ghép các số liệu thành năm nhóm có độ dài bằng nhau.\n\nĐiều thú vị là, với hai tiêu chí \"số lượng nhóm\" và \"độ dài nhóm\", mình chưa thể xác lập một cách ghép nhóm duy nhất. Vẫn còn nhiều cách khác nhau để chia nhóm, và đây chính là cơ hội để khám phá sâu hơn về về cách tổ chức và sắp xếp số liệu.\n\n> - Hoạt động 1: Có bảng tần số nhưng thiếu số liệu.\n> - Hoạt động 2: Có số liệu nhưng cần tự ghép nhóm, và việc ghép nhóm không có duy nhất một cách làm.\n\n:::\n\nSố liệu nhỏ nhất là 160, số liệu lớn nhất là 174, nên miền chứa toàn bộ số liệu là $[160; 174]$. Cần chia miền này thành 5 nhóm có độ dài bằng nhau, nên độ dài mỗi nhóm là\n$$\n    \\frac{174-160}{5}=2,8.\n$$\n\nNhưng nếu chia nhóm theo độ dài 2,8 cm, sẽ gặp các ranh giới thập phân không đẹp: \n\n::: {.center}\n$[160;162,8)$, $[162,8;165,6)$, $[165,6;168,4)$, $[168,4;171,2)$, $[171,2;174]$.\n:::\n\nRõ ràng, các số thập phân như 162,8 rất khó đọc, khó vẽ biểu đồ và không phù hợp với cách làm thống kê trong thực tế.\n\nSố 3 là số nguyên nhỏ nhất gần với 2,8. Nếu chọn độ dài nhóm là 3, miền dữ liệu cần mở rộng ra một chút để bao phủ toàn bộ dữ liệu cũ. Lúc này, nếu vẫn giữ đầu dưới là 160, thì đầu trên là\n$$\n    160+5\\cdot 3 = 175.\n$$\n\nKhi đó, các nhóm mới là \n\n::: {.center}\n$[160;163)$, $[163;166)$, $[166;169)$, $[169;172)$, $[172;175)$.\n:::\n\nNhóm cuối, $[172; 175)$, ghi theo dạng nửa khoảng là hợp lý, vì 175 không có trong số liệu gốc.\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Khám phá\" collapse=\"true\" icon=\"false\"}\nCó điều gì ngăn cản mình chọn ghép các số liệu thành năm nhóm sau đây không: \n\n::: {.center}\n$(159;162]$, $(162;165]$, $(165;168]$, $(168;171]$, $(171;174]$;\n:::\n\nhoặc\n\n::: {.center}\n$[159;162)$, $[162;165)$, $[165;168)$, $[168;171)$, $[171;174]$?\n:::\n\nNếu không, câu hỏi kế tiếp là có bao nhiêu cách ghép nhóm? Cách nào là tốt nhất và dựa trên tiêu chí nào để khẳng định?\n:::\n\n</details>\n\n<!-- Luyện tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 2}\n:::\n\nMột thư viện thống kê số người đến đọc sách vào buổi tối trong 30 ngày của tháng vừa qua như sau:\n\n```{r, echo=FALSE}\nlt2 <- new.env()\n# Tạo dữ liệu\nlt2$data <- c(85, 81, 65, 58, 47, 30, 51, 92, 85, 42, 55, 37, 31, 82, 63, 33, 44, 93, 77, 57, 44, 74, 63, 67, 46, 73, 52, 53, 47, 35)\ndata <- matrix(lt2$data, nrow = 3, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\nLập bảng tần số ghép nhóm có tám nhóm ứng với tám nửa khoảng sau: $[25; 34)$, $[34; 43)$, $[43; 52)$, $[52; 61)$, $[61; 70)$, $[70; 79)$, $[79 ; 88)$, $[88; 97)$.\n\n</details>\n\n<!-- Lời giải luyện tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nSắp xếp số liệu theo thứ tự *tăng dần* giúp mình dễ phân nhóm hơn.\n:::\n\nĐể đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(lt2$data), nrow = 3, byrow = TRUE))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[25;34)$ có ba số liệu bao gồm 30; 31; 33. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm -->\n\n```{r, echo = FALSE}\nlt2$points <- seq(25, 97, by = 9)\n# Các giá trị đại liện\nlt2$x <- .5 * (lt2$points[-length(lt2$points)] + lt2$points[-1])\n# Tần số\nlt2$categories <- cut(lt2$data, lt2$points, right = FALSE)\nlt2$f <- as.vector(table(lt2$categories))\n# Tần số tích lũy\nlt2$cf <- cumsum(lt2$f)\n# Khung dữ liệu\nlt2$df <- data.frame(\n    ` ` = seq(1, length(lt2$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(lt2$categories), \"\\\\)\")),\n    `Mút trái` = seq(25, 88, by = 9),\n    `Mút phải` = seq(34, 97, by = 9),\n    `Giá trị đại diện` = lt2$x,\n    `Tần số` = lt2$f,\n    `Tần số tích lũy` = lt2$cf,\n    check.names = FALSE\n)\n\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(lt2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 3}\n:::\n\nTrong *Bảng 4*, có bao nhiêu số liệu với giá trị không vượt quá giá trị đầu mút phải:\n\n::: {.columns}\n:::: {.column width=\"33%\"}\na. 163 của nhóm 1?\nb. 166 của nhóm 2?\n::::\n:::: {.column width=\"33%\"}\nc. 169 của nhóm 3?\nd. 172 của nhóm 4?\n::::\n:::: {.column width=\"33%\"}\ne. 175 của nhóm 5?\n::::\n:::\n\n```{r, echo = FALSE}\n# Các điểm chia\nhd2$points <- seq(160, 175, by = 3)\n# Các giá trị đại liện\nhd2$x <- .5 * (hd2$points[-length(hd2$points)] + hd2$points[-1])\n# Tần số\nhd2$categories <- cut(hd2$data, hd2$points, right = FALSE)\nhd2$f <- as.vector(table(hd2$categories))\n# Tần số tích lũy\nhd2$cf <- cumsum(hd2$f)\n# Khung dữ liệu\nhd2$df <- data.frame(\n    ` ` = seq(1, length(hd2$points) - 1, by = 1),\n    `Nhóm` = c(paste0(\"\\\\(\", levels(hd2$categories), \"\\\\)\")),\n    `Mút trái` = hd2$points[-length(hd2$points)],\n    `Mút phải` = hd2$points[-1],\n    `Giá trị đại diện` = hd2$x,\n    `Tần số` = hd2$f,\n    `Tần số tích lũy` = hd2$cf,\n    check.names = FALSE\n)\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 4\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Nhóm 1, $[160; 163)$, có tần số là 6. Vậy có 6 số liệu không vượt quá 163.\nb. Nhóm 2, $[163; 166)$, có tần số là 12. Các số liệu trong nhóm 1 cũng không vượt quá 166. Vậy tổng số là\n$$\n6+12=18.\n$$\nc. Tương tự, số số liệu không vượt quá đầu mút phải 169 của nhóm 3 là\n$$\n6+12+10=28.\n$$\nd. Số số liệu không vượt quá đầu mút phải 172 của nhóm 4 là\n$$\n6+12+10+5=33.\n$$\ne. Số số liệu không vượt quá đầu mút phải 175 của nhóm 5 là\n$$\n6+12+10+5+3=36.\n$$\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Tần số tích lũy\" appearance=\"simple\" icon=false collapse=true}\nĐáp số câu a cho biết tần số tích lũy của nhóm 1 là $cf_1=6$. Đáp số câu b cho biết tần số tích lũy của nhóm 2 là $cf_2=18$. Đáp số câu e cho biết tần số tích lũy của nhóm 5 là $cf_5=36$.\n\n*Tần số tích lũy* của một nhóm là số số liệu có giá trị nhỏ hơn đầu mút phải của nhóm đó.\n:::\n\n</details>\n\n<!-- Luyện tập  3 -->\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 3}\n:::\n\nTrong bài toán ở Luyện tập 2, lập bảng tần số ghép nhóm bao gồm cả tần số tích lũy có tám nhóm ứng với tám nửa khoång: $[25; 34)$, $[34; 43)$, $[43; 52)$, $[52; 61)$, $[61; 70)$, $[70; 79)$, $[79 ; 88)$, $[88; 97)$.\n</details>\n\n<!-- Lời giải Luyện tập 3 -->\n<details>\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nCó hai cách để tính tần số tích lũy $cf_3$ của nhóm 3.\n\n- Cách 1: $cf_3=n_1+n_2+n_3$, tính tần số tích lũy của nhóm 3 bằng cách cộng tần số của nhóm 1, nhóm 2 và nhóm 3.\n- Cách 2: $cf_3=cf_2+n_3$, tính tần số tích lũy của nhóm 3 bằng cách cộng tần số tích lũy của nhóm 2 và tần số của nhóm 3.\n\nTheo bạn, khi nào cách 2 nhanh hơn?\n:::\n\n```{r, echo = FALSE}\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(lt2$df[, c(-1, -3, -4, -5), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Hoạt động 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 4}\n:::\n\nXét mẫu số liệu được cho trong *Bảng 4*.\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 4\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Tìm trung điểm $x_1$ của nửa khoảng (tính bằng trung bình cộng của hai đầu mút) ứng với nhóm 1. Ta gọi trung điểm $x_1$ là *giá trị đại diện* của nhóm 1.\nb. Bằng cách tương tự, hãy tìm giá trị đại diện của bốn nhóm còn lại. Từ đó, hãy hoàn thiện các số liệu trong *Bảng 7*.\nc. Tính giá trị $\\overline{x}$ cho bởi công thức sau:\n$$\n\\overline{x} = \\frac{n_1x_1+n_2x_2+\\cdots+n_5x_5}{n}.\n$$\nGiá trị $\\overline{x}$ được gọi là *số trung bình cộng* của muẫ số liệu đã cho.\n\n<!-- Bảng 7 -->\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[\"Nhóm\"], `Giá trị đại diện`=c(\"\\\\(x_1=?\\\\)\", \"\\\\(x_2=?\\\\)\", \"\\\\(x_3=?\\\\)\", \"\\\\(x_4=?\\\\)\", \"\\\\(x_5=?\\\\)\"), `Tần số`=c(\"\\\\(n_1=?\\\\)\", \"\\\\(n_2=?\\\\)\", \"\\\\(n_3=?\\\\)\",\"\\\\(n_4=?\\\\)\", \"\\\\(n_5=?\\\\)\"), check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=36\\\\)\"))\n# Đổi dấu phẩy trong nhóm thành dấu chấm phẩy\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 7\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- LLời giải Hoạt động 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Giá trị đại diện của nhóm 1, $[160; 163)$, là\n    $$\n        x_1=\\frac{160+163}{2}=161,5 \\text{ (cm)}.\n    $$\n\nb. Tương tự, giá trị đại diện cho các nhóm còn lại được tính như dưới đây.\n    - Nhóm 2, $[163; 166)$: $x_2=\\frac{163+166}{2}=164,5$ (cm).\n    - Nhóm 3, $[166; 169)$: $x_3=\\frac{166+169}{2}=167,5$ (cm).\n    - Nhóm 4, $[169; 172)$: $x_4=\\frac{169+172}{2}=170,5$ (cm).\n    - Nhóm 5, $[172; 175)$: $x_5=\\frac{172+175}{2}=173,5$ (cm).\n\nc. Từ *Bảng 4* và các giá trị đại diện vừa tính, *Bảng 7* được hoàn thiện như dưới đây.\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -7), drop = FALSE], check.names = FALSE)\n# Tạo chỉ mục tự động\nif (nrow(data) >0) {\nindex <- 1:nrow(data)\ndata$`Giá trị đại diện` <- paste0(\"\\\\(x_\", index, \"=\", data$`Giá trị đại diện`, \"\\\\)\")\ndata$`Tần số` <- paste0(\"\\\\(n_\", index, \"=\", data$`Tần số`, \"\\\\)\")\n} else {\n    stop(\"Dữ liệu df trống hoặc không hợp lệ\")\n}\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \"TEMP_MARKER\", x) # Đổi dấu ',' thành ký hiệu tạm\n    x <- gsub(\"\\\\.\", \",\", x) # Đổi dấu '.' thành ','\n    gsub(\"TEMP_MARKER\", \";\", x) # Đổi ký hiệu tạm thành ';'\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Trung bình -->\n\n```{r}\n# Kích thước mẫu\nhd2$n <- length(hd2$data)\nhd2$barx <- fractions(sum(hd2$df$`Giá trị đại diện` * hd2$df$`Tần số`) / sum(hd2$df$`Tần số`))\n```\n\nSố trung bình cộng của mẫu số liệu là\n    \\begin{align*}\n        \\overline{x} \n            & = \\frac{1}{36}(6\\cdot 161,5+12\\cdot 164,5+10\\cdot 167,5+5\\cdot170,5+3\\cdot 173,5) \\\\\n            & = \\frac{1997}{12} \\\\\n            & \\approx `r format(round(as.numeric(hd2$barx), 4), decimal.mark = \",\")` \\text{ (cm)}.\n    \\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 4}\n:::\n\nXác định số trung bình cộng của mẫu số liệu ghép nhóm trong bài toán ở Luyện tập 2.\n\n</details>\n\n<!-- Lời giải Luyện tập 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm và giá trị đại diện của mẫu số liệu trong bài toán ở Luyện tập 2 được cho trong bảng dưới đây.\n\n```{r, echo = FALSE}\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \"TEMP_MARKER\", x) # Đổi dấu ',' thành ký hiệu tạm\n    x <- gsub(\"\\\\.\", \",\", x) # Đổi dấu '.' thành ','\n    gsub(\"TEMP_MARKER\", \";\", x) # Đổi ký hiệu tạm thành ';'\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n```{r}\nlt2$n <- length(lt2$data)\nlt2$barx <- fractions(sum(lt2$df$`Giá trị đại diện` * lt2$df$`Tần số`) / sum(lt2$df$`Tần số`))\n```\n\nTrung bình cộng là\n\\begin{align*}\n    \\overline{x}\n        & = \\frac{1}{30}(3\\cdot 29,5 + 3\\cdot 38,5 + 6\\cdot 47,5 + 5\\cdot 56,5 + 4\\cdot 65,5 + 3\\cdot 74,5 + 4\\cdot 83,5 + 2\\cdot 92,5) \\\\\n        & = \\frac{296}{5} \\\\\n        & = `r format(round(as.numeric(lt2$barx), 4), decimal.mark = \",\")` \\text{ (người)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 5}\n:::\n\nTrong phòng thí nghiệm, người ta chia 99 mẫu vật thành năm nhóm căn cứ trên khối lượng của chúng (đơn vị: g) và lập bảng tần số ghép nhóm bao gồm cả tần số tích luỹ như *Bảng 10*.\n\na. Nhóm 3 là nhóm đầu tiên có tần số tích luỹ\nlớn hơn hoặc bằng \n$$\n    \\frac{n}{2}=\\frac{99}{2}=49,5 \\text{ có đúng không?}\n$$\nb. Tìm đầu mút trái $r$, độ dài $d$, tần số $n_3$ của nhóm 3 và tần số tích lũy $cf_2$ của nhóm 2.\nc. Tính giá trị $M_e$ theo công thức sau:\n$$\n    M_e = r + \\left (\\frac{49,5-cf_2}{n_3}\\right)\\cdot d.\n$$\nGiá trị $M_e$ được gọi là *trung vị* của mẫu số liệu ghép nhóm đã cho.\n\n```{r}\nhd5 <- new.env()\nhd5$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([27,5;32,5)\\\\)\", \"\\\\([32,5;37,5)\\\\)\", \"\\\\([37,5;42,5)\\\\)\", \"\\\\([42,5;47,5)\\\\)\", \"\\\\([47,5;52,5)\\\\)\"),\n    `Mút trái` = seq(27.5, 47.5, by = 5),\n    `Mút phải` = seq(32.5, 52.5, by = 5),\n    `Giá trị đại diện` = .5 * (seq(27.5, 47.5, by = 5) + seq(32.5, 52.5, by = 5)),\n    `Tần số` = c(16, 24, 20, 30, 9),\n    `Tần số tích lũy` = cumsum(c(16, 24, 20, 30, 9)),\n    check.names = FALSE\n)\ndata <- data.frame(hd5$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=99\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 10\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Vì $cf_2=40 <\\frac{n}{2}=\\frac{99}{2}= 49,5 < cf_3=60$, nên khẳng định nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 49,5 là đúng.\n\nb. Nhóm 3, $[37,5;42,5)$, có đầu mút trái $r=37,5$, độ dài $d=42,5-37,5=5$, tần số $n_3=20$. Tần số tích lũy của nhóm 2 là $cf_2=40$.\n\nc. Giá trị $M_e$ theo công thức là\n\\begin{align*}\n    M_e\n        & = r + \\left (\\frac{49,5-cf_2}{n_3}\\right)\\cdot d \\\\\n        & = 37,5 + \\left(\\frac{49,5-40}{20}\\right)\\cdot 5 \\\\\n        & = 39,875 \\text{ (g)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 5}\n:::\n\nXác định trung vị của mẫu số liệu ghép nhóm ở *Bảng 1*.\n\n</details>\n\n<!-- Lời giải Luyện tập 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n    \\textbf{Lời giải}\n\\end{center}\n:::\n\nThêm vào *Bảng 1* cột tần số tích lũy để thu được bảng dưới đây.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nVì \n$$\n    cf_2 = 42 < \\frac{n}{2} = \\frac{120}{2} = 60 < cf_3 = 90, \n$$\nnên nhóm 3, $[8;12)$, là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 60. Nóm này có đầu mút trái $r=8$, độ dài $d=4$, tần số $n_3=48$ và nhóm 2 có tần số tích lũy $cf_2 = 42$.\n\n<!--  Trung vị -->\n\n```{r, echo = FALSE}\n# Kích thước mẫu\nhd1$n <- sum(hd1$df$`Tần số`)\n# Tìm nhóm trung vị\nhd1$k <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 2)[1] # Tìm chỉ mục (vị trí hàng) đầu tiên ([1]) trong hd1$df sao cho giá trị của cột \"Tần số tích lũy\" lớn hơn hoặc bằng hd1$n / 2, rồi lưu vào hd1$k.\n# Mút trái nhóm trung vị\nhd1$r <- hd1$df$`Mút trái`[hd1$k]\n# Độ rộng nhóm\nhd1$d <- hd1$df$`Mút phải`[hd1$k] - hd1$df$`Mút trái`[hd1$k]\n# Tính trung vị\nhd1$me <- fractions(hd1$r + ((hd1$n / 2 - ifelse(hd1$k > 1, hd1$df$`Tần số tích lũy`[hd1$k - 1], 0)) / hd1$df$`Tần số`[hd1$k]) * hd1$d)\n```\n\nTrung vị của mẫu số liệu là\n\n\\begin{align*}\n    M_e\n        & = r + \\left ( \\frac{\\frac{n}{2} - cf_2}{n_3} \\right )\\cdot d \\\\\n        & = 8 + \\left (\\frac{60 - 42}{48}\\right)\\cdot 4 \\\\\n        & = \\frac{19}{2} \\\\\n        & = `r format(round(as.numeric(hd1$me), 4), decimal.mark = \",\")` \\text{ (năm)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 6}\n:::\n\nGiáo viên chủ nhiệm chia thời gian sử dụng Internet trong một ngày của 40 học sinh thành năm nhóm (đơn vị: phút) và lập bảng tần số ghép nhóm bao gồm cả tần số tích lũy như *Bảng 12.*\n\na. Tìm trung vị $M_e$ của mẫu số liệu ghép nhóm đó. Trung vị $M_e$ còn gọi là tứ phân vị thứ hai $Q_2$ của mẫu số liệu trên.\n\nb. Nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng \n$$\n    \\frac{n}{4} = \\frac{40}{4} = 10 \\text{ có đúng không?}\n$$\nTìm đầu mút trái $s$, độ dài $h$, tần số $n_2$ của nhóm 2 và tần số tích lũy $cf_1$ của nhóm 1. Sau đó, hãy tính giá trị $Q_1$ theo công thức sau:\n$$\n    Q_1 = s + \\left (\\frac{10-cf_1}{n_2}\\right)\\cdot h.\n$$\nGiá trị nói trên được gọi là *tứ phân vị thứ nhất* $Q_1$ của mẫu số liệu đã cho.\n\nc. Nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng \n$$\n    \\frac{3n}{4} = \\frac{3\\cdot 40}{4} = 30 \\text{ có đúng không?}\n$$\nTìm đầu mút trái $t$, độ dài $l$, tần số $n_3$ của nhóm 3 và tần số tích lũy $cf_2$ của nhóm 2. Sau đó, hãy tính giá trị $Q_3$ theo công thức sau:\n$$\n    Q_3 = t + \\left (\\frac{30-cf_2}{n_3}\\right)\\cdot l.\n$$\nGiá trị nói trên được gọi là *tứ phân vị thứ ba* $Q_3$ của mẫu số liệu đã cho.\n\n<!-- Khung dữ liệu Hoạt động 6 -->\n\n```{r}\nhd6 <- new.env()\nhd6$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([0;60)\\\\)\", \"\\\\([60;120)\\\\)\", \"\\\\([120;180)\\\\)\", \"\\\\([180;240)\\\\)\", \"\\\\([240;300)\\\\)\"),\n    `Mút trái` = seq(0, 240, by = 60),\n    `Mút phải` = seq(60, 300, by = 60),\n    `Giá trị đại diện` = .5 * (seq(0, 240, by = 60) + seq(60, 300, by = 60)),\n    `Tần số` = c(6, 13, 13, 6, 2),\n    `Tần số tích lũy` = cumsum(c(6, 13, 13, 6, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd6$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 12\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\na. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 19 < \\frac{n}{2} = \\frac{40}{2} = 20 < cf_3 = 32,\n$$\nsuy ra nhóm 3, $[120; 180)$, là nhóm đầu tiên có tần số tích lũy lớn hơn 20. Nhóm này có đầu mút trái $r=120$, độ dài $d=60$, tần số $n_3=13$ và nhóm 2 có tần số tích lũy $cf_2 = 19$. Trung vị $M_e$ hay tứ phân vị thứ hai $Q_2$ là\n\n<!-- Trung vị Hoạt động 6 -->\n\n```{r, echo = FALSE}\nhd6$n <- sum(hd6$df$`Tần số`)\nhd6$k <- which(hd6$df$`Tần số tích lũy` >= hd6$n / 2)[1] \nhd6$r <- hd6$df$`Mút trái`[hd6$k]\nhd6$d <- hd6$df$`Mút phải`[hd6$k] - hd6$df$`Mút trái`[hd6$k]\n# Tính trung vị\nhd6$me <- fractions(hd6$r + ((hd6$n / 2 - ifelse(hd6$k > 1, hd6$df$`Tần số tích lũy`[hd6$k - 1], 0)) / hd6$df$`Tần số`[hd6$k]) * hd6$d)\n# hd6$me\n```\n\n\\begin{align*}\n    M_e = Q_2\n        & = r + \\left( \\frac{\\frac{n}{2} - cf_2}{n_3}\\right)\\cdot d \\\\\n        & = 120 + \\left( \\frac{20-19}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{1620}{13} \\\\\n        & = `r format(round(as.numeric(hd6$me), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\nb. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_1 = 6 < \\frac{n}{4} = \\frac{40}{4} = 10 < cf_2 = 19,\n$$\nnên khẳng định nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 10 là khẳng định đúng. Nhóm 2, $[60; 120)$, có đầu mút trái $s=60$, độ dài $h=60$, tần số $n_2=13$ và nhóm 1 có tần số tích lũy $cf_1 = 6$. Tứ phân vị thứ nhất là\n\n<!-- Tứ phân vị thứ nhất Q1 Hoạt động 6-->\n\n```{r}\n# Tìm nhóm tứ phân vị thứ nhất\nhd6$p <- which(hd6$df$`Tần số tích lũy` >= hd6$n / 4)[1]\n# Mút trái nhóm tứ phân vị thứ nhất\nhd6$s <- hd6$df$`Mút trái`[hd6$p]\n# Độ rộng nhóm tứ phân vị thứ nhất\nhd6$h <- hd6$df$`Mút phải`[hd6$p] - hd6$df$`Mút trái`[hd6$p]\n# Tính tứ phân vị thứ nhất\nhd6$q1 <- fractions(hd6$s + ((hd6$n / 4 - ifelse(hd6$p > 1, hd6$df$`Tần số tích lũy`[hd6$p - 1], 0)) / hd6$df$`Tần số`[hd6$p]) * hd6$h)\n# hd6$q1\n```\n\n\\begin{align*}\n    Q_1 \n        & = s + \\left (\\frac{10-cf_1}{n_2}\\right)\\cdot h \\\\\n        & = 60 + \\left(\\frac{10-6}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{1020}{13} \\\\\n        & = `r format(round(as.numeric(hd6$q1), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\nc. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 19 < \\frac{n}{4} = \\frac{3\\cdot 40}{4} = 30 < cf_3 = 32,\n$$\nnên khẳng định nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 30 là khẳng định đúng. Nhóm 3, $[120;180)$, có đầu mút trái $t=120$, độ dài $l=60$, tần số $n_3=13$ và nhóm 2 có tần số tích lũy $cf_2 = 19$. Tứ phân vị thứ ba là \n\n<!-- Tứ phân vị thứ nhất Q3 Hoạt động 6-->\n\n```{r, echo = FALSE}\n# Tìm nhóm tứ phân vị thứ ba\nhd6$q <- which(hd6$df$`Tần số tích lũy` >= (3 * hd6$n) / 4)[1]\n# Mút trái nhóm tứ phân vị thứ ba\nhd6$t <- hd6$df$`Mút trái`[hd6$q]\n# Độ rộng nhóm tứ phân vị thứ ba\nhd6$l <- hd6$df$`Mút phải`[hd6$q] - hd6$df$`Mút trái`[hd6$q]\n# Tính tứ phân vị thứ ba\nhd6$q3 <- fractions(hd6$t + (((3 * hd6$n) / 4 - ifelse(hd6$q > 1, hd6$df$`Tần số tích lũy`[hd6$q - 1], 0)) / hd6$df$`Tần số`[hd6$q]) * hd6$h)\n# hd6$q3\n```\n\n\\begin{align*}\n    Q_3 \n        & = t + \\left (\\frac{30-cf_2}{n_3}\\right)\\cdot l \\\\\n        & = 120 + \\left(\\frac{30-19}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{2220}{13} \\\\\n        & = `r format(round(as.numeric(hd6$q3), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 6}\n:::\n\nTìm tứ phân vị của mẫu số liệu trong *Bảng 1* (làm tròn các kết quả đến hàng phần mười).\n\n</details>\n\n<!-- Lời giải Luyện tập 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n*Bảng 1* thêm vào cột Tần số tích lũy được trình bày như dưới đây.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_1 = 13 < \\frac{n}{4} = \\frac{120}{4} = 30 < cf_2 = 42,\n$$\nnên nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn 30. Nhóm 2, $[4; 8)$, có đầu mút trái $s=4$, độ dài $h=4$, tần số $n_2=29$ và nhóm 1 có tần số tích lũy $cf_1 = 13$. Tứ phân vị thứ nhất là \n\n```{r}\n# Tìm nhóm tứ phân vị thứ nhất\nhd1$p <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 4)[1]\n# Mút trái nhóm tứ phân vị thứ nhất\nhd1$s <- hd1$df$`Mút trái`[hd1$p]\n# Độ rộng nhóm tứ phân vị thứ nhất\nhd1$h <- hd1$df$`Mút phải`[hd1$p] - hd1$df$`Mút trái`[hd1$p]\n# Tính tứ phân vị thứ nhất\nhd1$q1 <- fractions(hd1$s + ((hd1$n / 4 - ifelse(hd1$p > 1, hd1$df$`Tần số tích lũy`[hd1$p - 1], 0)) / hd1$df$`Tần số`[hd1$p]) * hd1$h)\n# hd1$q1\n```\n\n\\begin{align*}\n    Q_1 \n        & = 4 + \\left (\\frac{30-13}{29}\\right)\\cdot 4 \\\\\n        & = \\frac{184}{29} \\\\\n        & \\approx `r format(round(as.numeric(hd1$q1), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*}\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 42 < \\frac{n}{2} = \\frac{120}{2} = 60 < cf_3 = 90,\n$$\nrút ra nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn 60. Nhóm 3, $[8; 12)$, có đầu mút trái $r=8$, độ dài $d=4$, tần số $n_3=48$ và nhóm 2 có tần số tích lũy $cf_2 = 42$. Tứ phân vị thứ hai là\n\n<!-- Trung vị Hoạt động 6 -->\n\n```{r, echo = FALSE}\nhd1$n <- sum(hd1$df$`Tần số`)\nhd1$k <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 2)[1] \nhd1$r <- hd1$df$`Mút trái`[hd1$k]\nhd1$d <- hd1$df$`Mút phải`[hd1$k] - hd1$df$`Mút trái`[hd1$k]\n# Tính trung vị\nhd1$me <- fractions(hd1$r + ((hd1$n / 2 - ifelse(hd1$k > 1, hd1$df$`Tần số tích lũy`[hd1$k - 1], 0)) / hd1$df$`Tần số`[hd1$k]) * hd1$d)\n# hd1$me\n```\n\n\\begin{align*}\n    Q_2\n        & = 8 + \\left( \\frac{60-42}{48}\\right)\\cdot 4 \\\\\n        & = \\frac{19}{2} \\\\\n        & \\approx `r format(round(as.numeric(hd1$me), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*}\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2=42 < \\frac{n}{4} = \\frac{3\\cdot 120}{4} = 90 = cf_3,\n$$\nnên nhóm 3, $[8;12)$, là nhóm đầu tiên có tần số tích lũy bằng 90. Tứ phân vị thứ ba là\n\n<!-- Tứ phân vị thứ nhất Q3 Luyện tập 6 -->\n\n```{r, echo = FALSE}\n# Tìm nhóm tứ phân vị thứ ba\nhd1$q <- which(hd1$df$`Tần số tích lũy` >= (3 * hd1$n) / 4)[1]\n# Mút trái nhóm tứ phân vị thứ ba\nhd1$t <- hd1$df$`Mút trái`[hd1$q]\n# Độ rộng nhóm tứ phân vị thứ ba\nhd1$l <- hd1$df$`Mút phải`[hd1$q] - hd1$df$`Mút trái`[hd1$q]\n# Tính tứ phân vị thứ ba\nhd1$q3 <- fractions(hd1$t + (((3 * hd1$n) / 4 - ifelse(hd1$q > 1, hd1$df$`Tần số tích lũy`[hd1$q - 1], 0)) / hd1$df$`Tần số`[hd1$q]) * hd1$h)\n# hd1$q3\n```\n \n\\begin{align*}\n    Q_3\n        & = 8 + \\left(\\frac{90-42}{48}\\right)\\cdot 4 \\\\\n        & = `r format(round(as.numeric(hd1$q3), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*} \n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 7}\n:::\n\nQuan sát bảng tần số ghép nhóm bao gồm cả tần số tích luỹ ở *Ví dụ 6* và cho biết:\n\na. Nhóm nào có tần số lớn nhất;\nb. Đầu mút trái và độ dài của nhóm có tần số lớn nhất bằng bao nhiêu.\n\n</details>\n\n<!-- Lời giải Hoạt động 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm bao gồm cả tần số tích luỹ ở *Ví dụ 6* được trình bày như dưới đây.\n\n```{r}\nhd7 <- new.env()\nhd7$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(2, 10, 16, 8, 2, 2),\n    `Tần số tích lũy` = cumsum(c(2, 10, 16, 8, 2, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd7$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 15\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Nhóm 3, $[50; 60)$, có tần số lớn nhất 16.\nb. Nhóm 3 có dầu mút trái 50 và độ dài 10.\n\n</details>\n\n<!-- Luyện tập 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 7}\n:::\n\nTìm mốt của mẫu số liệu trong *Ví dụ 6* (làm tròn các kết quả đến hàng\nphần mười). \n\n</details>\n\n<!-- Lời giải Luyện tập 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm của mẫu số liệu *Ví dụ 6* được trình bày dưới đây.\n\n```{r}\nhd7 <- new.env()\nhd7$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(2, 10, 16, 8, 2, 2),\n    `Tần số tích lũy` = cumsum(c(2, 10, 16, 8, 2, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd7$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nQuan sát cột Tần số, nhóm 3, $[50;60)$, là nhóm có tần số lớn nhất $n_3=16$, có đầu mút trái $u=50$ và độ dài $g=10$. Nhóm 2 có tần số $n_2=10$ và nhóm 4 có tần số $n_4=8$. Mốt là\n\n<!-- Mốt -->\n\n```{r}\n# Tìm nhóm có tần số lớn nhất\nhd7$i <- which.max(hd7$df$`Tần số`)\n# Mút trái của nhóm mốt\nhd7$u <- hd7$df$`Mút trái`[hd7$i]\n# Độ rộng nhóm mốt\nhd7$g <- hd7$df$`Mút phải`[hd7$i] - hd7$df$`Mút trái`[hd7$i]\n# Tính mốt\nhd7$mo <- fractions(hd7$u + ((hd7$df$`Tần số`[hd7$i] - ifelse(hd7$i > 1, hd7$df$`Tần số`[hd7$i - 1], 0)) / (2 * hd7$df$`Tần số`[hd7$i] - ifelse(hd7$i > 1, hd7$df$`Tần số`[hd7$i - 1]) - ifelse(hd7$i < nrow(hd7$df), hd7$df$`Tần số`[hd7$i + 1], 0))) * hd7$g, 4)\n# hd7$mo\n```\n\n\\begin{align*}\n    M_o\n        & = u + \\left(\\frac{n_3-n_2}{2n_3-n_2-n_4}\\right)\\cdot g \\\\\n        & = 50 + \\left(\\frac{16-10}{2\\cdot 16-10-8}\\right)\\cdot 10 \\\\\n        & = \\frac{380}{7} \\\\\n        & = `r format(round(as.numeric(hd7$mo), 1), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n# Bài tập\n\nXem Kết quả để tra nhanh kết quả.\n\n<!-- Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 1}\n:::\n\nMẫu số liệu dưới đây ghi lại tốc độ của 40 ô-tô khi đi qua một trạm đo tốc độ (đơn vị: km/h):\n\n<!-- Dữ liệu -->\n\n```{r}\nbai1 <- new.env()\n# Tạo dữ liệu\nbai1$data <- c(48.5, 43, 50, 55, 45, 60, 53, 55.5, 44, 65, 51, 62.5, 41, 44.5, 57, 57, 68, 49, 46.5, 53.5, 61, 49.5, 54, 62, 59, 56, 47, 50, 60, 61, 49.5, 52.5, 57, 47, 60, 55, 45, 47.5, 48, 61.5)\ndata <- matrix(bai1$data, nrow = 4, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\na. Lập bảng tần số ghép nhóm cho mẫu số liệu trên có sáu nhóm ứng với sáu nửa khoảng:\n\n::: {.content-visible when-format=\"html\"}\n<div style=\"text-align: center;\">\n$[40; 45)$, $[45 ; 50)$, $[50; 55)$, $[55 ; 60)$, $[60; 65)$, $[65; 70)$.\n</div>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n$[40; 45)$, $[45 ; 50)$, $[50; 55)$, $[55 ; 60)$, $[60; 65)$, $[65; 70)$.\n\\end{center}\n:::\n\nb. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nc.  Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n</details>\n\n<!-- Lời giải Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n<!-- Khung dữ liệu Bài tập 1 -->\n\n```{r, echo=FALSE}\nbai1$points <- seq(40, 70, by = 5)\nbai1$x <- .5 * (bai1$points[-length(bai1$points)] + bai1$points[-1])\nbai1$categories <- cut(bai1$data, bai1$points, right = FALSE)\nbai1$f <- as.vector(table(bai1$categories))\nbai1$cf <- cumsum(bai1$f)\nbai1$df <- data.frame(\n    ` ` = seq(1, length(bai1$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(bai1$categories), \"\\\\)\")),\n    `Mút trái` = seq(40, 65, by = 5),\n    `Mút phải` = seq(45, 70, by = 5),\n    `Giá trị đại diện` = bai1$x,\n    `Tần số` = bai1$f,\n    `Tần số tích lũy` = bai1$cf,\n    check.names = FALSE\n)\n```\n\na. Để đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(bai1$data), nrow = 4, byrow = TRUE), decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[40;45)$ có bốn số liệu bao gồm 41; 43; 44; 44,5. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm Bài tập 1 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=40\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nb. Thêm vào bảng tần số ghép nhóm ở trên cột số thứ tự để dễ quan sát, cột Giá trị đại diện để tính trung bình, và cột Tần số tích lũy để tính tứ phân vị. \n\n<!-- Bảng tần số ghép nhóm mở rộng Bài tập 1 -->\n\n```{r}\ndata <- rbind(bai1$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x) \n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x) \n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n\n```\n\n<!-- Trung bình Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$n <- length(bai1$data)\nbai1$barx <- fractions(sum(bai1$df$`Giá trị đại diện` * bai1$df$`Tần số`) / sum(bai1$df$`Tần số`))\n```\n\n- Mẫu có $n=40$ số liệu. Nhóm 1, $[40;45)$, có trung điểm $x_1=42,5$ làm giá trị đại diện và có tần số $n_1=4$. Ký hiệu tương tự cho các nhóm còn lại. Trung bình cộng là\n\\begin{align*}\n    \\overline{x} \n        & = \\frac{1}{n} (n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6) \\\\\n        & = \\frac{1}{40} (4\\cdot 42,5 + 11\\cdot 47,5 + 7\\cdot 52,5 + 8\\cdot 57,5 + 8\\cdot 62,5 + 2\\cdot 67,5) \\\\\n        & = \\frac{431}{8} \\\\\n        & = `r format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\")` \\text{ (km/h)}.\n\\end{align*}\n\n<!-- Trung vị M_e và tứ phân vị thứ hai Q_2 Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$k <- which(bai1$df$`Tần số tích lũy` >= bai1$n / 2)[1]\nbai1$r <- bai1$df$`Mút trái`[bai1$k]\nbai1$d <- bai1$df$`Mút phải`[bai1$k] - bai1$df$`Mút trái`[bai1$k]\nbai1$me <- fractions(bai1$r + ((bai1$n / 2 - ifelse(bai1$k > 1, bai1$df$`Tần số tích lũy`[bai1$k - 1], 0)) / bai1$df$`Tần số`[bai1$k]) * bai1$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy \n$$\n    cf_2=15 < \\frac{n}{2}=\\frac{40}{2}=20 < cf_3=22.\n$$\nSuy ra nhóm 3, $[50;55)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 20. Nhóm này có đầu mút trái $r=50$, độ dài $d=5$ và tần số $n_3=7$. Trung vị là\n    \\begin{align*}\n        M_e\n            & = r+\\left(\\frac{\\frac{n}{2}-cf_2}{n_3}\\right)\\cdot d \\\\\n            & = 50 + \\left(\\frac{20-15}{7}\\right)\\cdot 5 \\\\\n            & = \\frac{375}{7} \\\\\n            & \\approx `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q_1 Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$p <- which(bai1$df$`Tần số tích lũy` >= bai1$n / 4)[1]\nbai1$s <- bai1$df$`Mút trái`[bai1$p]\nbai1$h <- bai1$df$`Mút phải`[bai1$p] - bai1$df$`Mút trái`[bai1$p]\nbai1$q1 <- fractions(bai1$s + ((bai1$n / 4 - ifelse(bai1$p > 1, bai1$df$`Tần số tích lũy`[bai1$p - 1], 0)) / bai1$df$`Tần số`[bai1$p]) * bai1$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_1=4 < \\frac{n}{4}=\\frac{40}{4}=10 < cf_2=15.\n$$\nSuy ra nhóm 2, $[45;50)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 10. Nhóm này có đầu mút trái $s=45$, độ dài $h=5$ và tần số $n_2=11$. Tứ phân vị thứ nhất là\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_1}{n_2}\\right)\\cdot h \\\\\n            & = 45 + \\left(\\frac{10-4}{11}\\right)\\cdot 5 \\\\\n            & = \\frac{525}{11} \\\\\n            & \\approx `r format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2 = M_e = `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")`$ (km/h).\n\n<!-- Tứ phân vị thứ ba Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$q <- which(bai1$df$`Tần số tích lũy` >= (3 * bai1$n) / 4)[1]\nbai1$t <- bai1$df$`Mút trái`[bai1$q]\nbai1$l <- bai1$df$`Mút phải`[bai1$q] - bai1$df$`Mút trái`[bai1$q]\nbai1$q3 <- fractions(bai1$t + (((3 * bai1$n) / 4 - ifelse(bai1$q > 1, bai1$df$`Tần số tích lũy`[bai1$q - 1], 0)) / bai1$df$`Tần số`[bai1$q]) * bai1$l)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_3=22 < \\frac{3n}{4} = \\frac{3 \\cdot 40}{4} = 30 = cf_4.\n$$\nSuy ra nhóm 4, $[55;60)$, là nhóm đầu tiên có tần số tích lũy bằng với 30. Nhóm này có đầu mút trái $t=55$, độ dài $l=5$ và tần số $n_4=8$. Tứ phân vị thứ ba là\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_3}{n_4}\\right)\\cdot l \\\\\n            & = 55 + \\left(\\frac{30-22}{8}\\right)\\cdot 5 \\\\\n            & = `r format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n<!-- Mốt Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$i <- which.max(bai1$df$`Tần số`)\nbai1$u <- bai1$df$`Mút trái`[bai1$i]\nbai1$g <- bai1$df$`Mút phải`[bai1$i] - bai1$df$`Mút trái`[bai1$i]\nbai1$mo <- fractions(bai1$u + ((bai1$df$`Tần số`[bai1$i] - ifelse(bai1$i > 1, bai1$df$`Tần số`[bai1$i - 1], 0)) / (2 * bai1$df$`Tần số`[bai1$i] - ifelse(bai1$i > 1, bai1$df$`Tần số`[bai1$i - 1]) - ifelse(bai1$i < nrow(bai1$df), bai1$df$`Tần số`[bai1$i + 1], 0))) * bai1$g)\n```\n\nc. Quan sát cột Tần số, nhóm 2, $[45;50)$, là nhóm có tần số lớn nhất $n_2=11$. Nó có đầu mút trái $u=45$ và độ dài $g=5$. Nhóm 1 có tần số $n_1=4$ và nhóm 3 có tần số $n_3=7$. Mốt là\n    \\begin{align*}\n        M_o\n            & = u + \\left(\\frac{n_2-n_1}{2n_2-n_1-n_3}\\right) \\cdot g \\\\\n            & = 45 + \\left(\\frac{11-4}{2\\cdot 11-4-7}\\right)\\cdot 5 \\\\\n            & = \\frac{530}{11} \\\\\n            & \\approx `r format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\")` \\text{ (km/h)}.\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline \n$[40; 45)$ & $[45 ; 50)$ & $[50; 55)$ & $[55 ; 60)$ & $[60; 65)$ & $[65; 70)$ \\\\\n\\hline \n4 & 11 & 7 & 8 & 8 & 2. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai1$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x)\n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai1$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>\n\n<!-- Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 2}\n:::\n\nMẫu số liệu sau ghi lại cân nặng của 30 bạn học sinh (đơn vị: kg):\n\n<!-- Dữ liệu Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2 <- new.env()\nbai2$data <- c(17.0, 40.0, 39.0, 40.5, 42.0, 51.0, 41.5, 39.0, 41.0, 30.0, 40.0, 42.0, 40.5, 39.5, 41.0, 40.5, 37.0, 39.5, 40.0, 41.0, 38.5, 39.5, 40.0, 41.0, 39.0, 40.5, 40.0, 38.5, 39.5, 41.5)\ndata <- matrix(bai2$data, nrow = 3, byrow = TRUE)\ndata <- format(data, decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Lập bảng tần số ghép nhóm cho mẫu số liệu trên có tám nhóm ứng với tám nửa khoảng:\n\n::: {.content-visible when-format=\"html\"}\n<div style=\"text-align: center;\">\n$[15; 20)$, $[20; 25)$, $[25; 30)$, $[30; 35)$, $[35; 40)$, $[40 ; 45)$, $[45; 50)$, $[50; 55)$.\n</div>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n$[15; 20)$, $[20; 25)$, $[25; 30)$, $[30; 35)$, $[35; 40)$, $[40 ; 45)$, $[45; 50)$, $[50; 55)$.\n\\end{center}\n:::\n\nb. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nc. Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n</details>\n\n<!-- Lời giải Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n<!-- Khung dữ liệu Bài tập 2 -->\n\n```{r, echo=FALSE}\nbai2$points <- seq(15, 55, by = 5)\nbai2$x <- .5 * (bai2$points[-length(bai2$points)] + bai2$points[-1])\nbai2$categories <- cut(bai2$data, bai2$points, right = FALSE)\nbai2$f <- as.vector(table(bai2$categories))\nbai2$cf <- cumsum(bai2$f)\nbai2$df <- data.frame(\n    ` ` = seq(1, length(bai2$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(bai2$categories), \"\\\\)\")),\n    `Mút trái` = seq(15, 50, by = 5),\n    `Mút phải` = seq(20, 55, by = 5),\n    `Giá trị đại diện` = bai2$x,\n    `Tần số` = bai2$f,\n    `Tần số tích lũy` = bai2$cf,\n    check.names = FALSE\n)\n```\n\na. Để đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(bai2$data), nrow = 3, byrow = TRUE), decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data,\n        format = \"html\",\n        align = \"c\", col.names = NA\n    ) %>%\n        kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE\n        )\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[15,20)$ chỉ có một số liệu là 17. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm Bài tập 2 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nb. Thêm vào bảng tần số ghép nhóm ở trên cột số thứ tự để dễ quan sát, cột Giá trị đại diện để tính trung bình, và cột Tần số tích lũy để tính tứ phân vị.\n\n<!-- Bảng tần số ghép nhóm mở rộng Bài tập 2 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=30\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x)\n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Trung bình Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$n <- length(bai2$data)\nbai2$barx <- fractions(sum(bai2$df$`Giá trị đại diện` * bai2$df$`Tần số`) / sum(bai2$df$`Tần số`))\n```\n\n- Mẫu có $n=30$ số liệu. Nhóm 1, $[15;20)$, có trung điểm $x_1=17,5$ làm giá trị đại diện và có tần số $n_1=1$. Ký hiệu tương tự với các nhóm còn lại. Trung bình là\n\\begin{align*}\n\\overline{x}\n    & = \\frac{1}{n}(n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6 + n_7\\cdot x_7 + n_8\\cdot x_8) \\\\\n    & = \\frac{1}{30} (1\\cdot 17,5 + 0\\cdot 22,5 + 0\\cdot 27,5+ 1\\cdot 32,5 + 10\\cdot 37,5 + 17\\cdot 42,5 + 0\\cdot 47,5 + 52,5 \\cdot 1) \\\\\n    & = `r format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n<!-- Trung vị Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$k <- which(bai2$df$`Tần số tích lũy` >= bai2$n / 2)[1]\nbai2$r <- bai2$df$`Mút trái`[bai2$k]\nbai2$d <- bai2$df$`Mút phải`[bai2$k] - bai2$df$`Mút trái`[bai2$k]\nbai2$me <- fractions(bai2$r + ((bai2$n / 2 - ifelse(bai2$k > 1, bai2$df$`Tần số tích lũy`[bai2$k - 1], 0)) / bai2$df$`Tần số`[bai2$k]) * bai2$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_5=12 < \\frac{n}{2}=15 < cf_6=29.\n$$\nSuy ra nhóm 6, $[40;45)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 15. Nhóm này có đầu mút trái $r=40$, độ dài $d=5$ và tần số $n_6=17$. Trung vị là\n\\begin{align*}\nM_e\n    & = r + \\left(\\frac{\\frac{n}{2}-cf_5}{n_6}\\right)\\cdot d \\\\\n    & = 40 + \\left(\\frac{15-12}{17}\\right)\\cdot 5 \\\\\n    & = \\frac{695}{17} \\\\\n    & \\approx `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n```{r, echo = FALSE}\nbai2$p <- which(bai2$df$`Tần số tích lũy` >= bai2$n / 4)[1]\nbai2$s <- bai2$df$`Mút trái`[bai2$p]\nbai2$h <- bai2$df$`Mút phải`[bai2$p] - bai2$df$`Mút trái`[bai2$p]\nbai2$q1 <- fractions(bai2$s + ((bai2$n / 4 - ifelse(bai2$p > 1, bai2$df$`Tần số tích lũy`[bai2$p - 1], 0)) / bai2$df$`Tần số`[bai2$p]) * bai2$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_4=2 <\\frac{n}{4}=\\frac{30}{4}=7,5 < cf_5=12.\n$$\nSuy ra nhóm 5, $[35;40)$, là nhóm đầu tiên có tần số tích lũy, không nhỏ hơn 7,5. Nhóm này có đầ mút trái $s=35$, độ dài $h=5$ và tần số $n_5=10$. Tứ phân vị thứ nhất là\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_4}{n_5}\\right)\\cdot h \\\\\n            & = 35 + \\left(\\frac{7,5-2}{10}\\right)\\cdot 5 \\\\\n            & = \\frac{151}{4} \\\\\n            & = `r format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\")` \\text{ (kg).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2=M_e \\approx `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")`$ (kg).\n\n<!-- Tứ phân vị thứ ba Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$q <- which(bai2$df$`Tần số tích lũy` >= (3 * bai2$n) / 4)[1]\nbai2$t <- bai2$df$`Mút trái`[bai2$q]\nbai2$l <- bai2$df$`Mút phải`[bai2$q] - bai2$df$`Mút trái`[bai2$q]\nbai2$q3 <- fractions(bai2$t + (((3 * bai2$n) / 4 - ifelse(bai2$q > 1, bai2$df$`Tần số tích lũy`[bai2$q - 1], 0)) / bai2$df$`Tần số`[bai2$q]) * bai2$l)\n```\n\n- Quan sát cột Tần số tích lũy, ta có\n$$\ncf_5=12<\\frac{3n}{4}=\\frac{3\\cdot 30}{3}=22,5<cf_6=29.\n$$\nSuy ra nhóm 6, $[40;45)$ là nhòm đầu tiên có tần số tích lũy không nhỏ hơn 22,5. Nhóm này có đầu mút trái $t=40$, độ dài $l=5$ và tần số $n_6=17$. Tứ phân vị thứ ba là\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_5}{n_6}\\right)\\cdot l \\\\\n            & = 40 +\\left(\\frac{22,5-12}{17}\\right) \\cdot 5 \\\\\n            & = \\frac{1465}{34} \\\\\n            & \\approx `r format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\")` \\text{ (kg).} \n    \\end{align*}\n\n<!-- Mốt Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$i <- which.max(bai2$df$`Tần số`)\nbai2$u <- bai2$df$`Mút trái`[bai2$i]\nbai2$g <- bai2$df$`Mút phải`[bai2$i] - bai2$df$`Mút trái`[bai2$i]\nbai2$mo <- fractions(bai2$u + ((bai2$df$`Tần số`[bai2$i] - ifelse(bai2$i > 1, bai2$df$`Tần số`[bai2$i - 1], 0)) / (2 * bai2$df$`Tần số`[bai2$i] - ifelse(bai2$i > 1, bai2$df$`Tần số`[bai2$i - 1]) - ifelse(bai2$i < nrow(bai2$df), bai2$df$`Tần số`[bai2$i + 1], 0))) * bai2$g, 4)\n```\n\nc. Quan sát cột Tần số, nhóm 6, $[40,45)$ là nhóm có tần số lớn nhất $n_6=17$. Nhóm này có đầu mút trái $u=40$ và độ dài $g=5$. Nhóm 5 liền trước nó có tần số $n_5=10$ và nhóm 7 liền sau nó có tần số $n_7=0$. Mốt là\n    \\begin{align*}\n        M_o \n            & = u + \\left(\\frac{n_6-n_5}{2n_6 - n_5 - n_7}\\right)\\cdot g \\\\\n            & = 40 + \\left(\\frac{17-10}{2\\cdot 17 - 10 - 0}\\right)\\cdot 5 \\\\\n            & = \\frac{995}{24} \\\\\n            & \\approx `r formatC(round(as.numeric(bai2$mo), 4), format = \"f\", digits = 1, decimal.mark = \",\")` \\text{ (kg).}\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|c|c|}\n\\hline \n$[15;20)$ & $[20; 25)$ & $[25; 30)$ & $[30; 35)$ & $[35;40)$ & $[40; 45)$ & $[45;50)$ & $[50;55)$ \\\\\n\\hline \n1 & 0 & 0 & 1 & 10 & 17 & 0 & 1. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x) \n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x) \n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai2$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai2$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>\n\n<!-- Bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 3}\n:::\n\nBảng 15 cho ta bảng tần số ghép nhóm số liệu thống kê chiều cao của 40 mẫu cây ở một vườn thực vật (đơn vị: cm).\n\na. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nb. Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n\n<!-- Khung dữ liệu Bài tập 3 -->\n\n```{r}\nbai3 <- new.env()\nbai3$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(4, 10, 14, 6, 4, 2),\n    `Tần số tích lũy` = c(4, 14, 28, 34, 38, 40),\n    check.names = FALSE\n)\ndata <- data.frame(bai3$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 15\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na.Thêm vào bảng đã cho cột Giá trị đại diện để tính trung bình, và cột số thứ tự để dễ quan sát.\n\n<!-- Bảng tần số mở rộng Bài tập 3-->\n\n```{r, echo = FALSE}\ndata <- rbind(bai3$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE) \n}\n```\n\n<!-- Trung bình Bài tập 3-->\n\n```{r, echo = FALSE}\nbai3$n <- sum(bai3$df$`Tần số`)\nbai3$barx <- fractions((1 / bai3$n) * sum(bai3$df$`Giá trị đại diện` * bai3$df$`Tần số`))\n```\n\n- Mẫu có $n=40$ số liệu. Nhóm 1 có giá trị đại diện $x_1=35$ và tần số $n_1=4$, vân vân cho đến nhóm 6 có giá trị đại diện $x_6=85$ và tần số $n_6=2$. Trung bình là\n\n\\begin{align*}\n    \\overline{x}\n        & = \\frac{1}{n}(n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6) \\\\\n        & = \\frac{1}{40} (4\\cdot 35 + 10\\cdot 45 + 14\\cdot 55 + 6\\cdot 65 + 4\\cdot 75 + 2\\cdot 85) \\\\\n        & = \\frac{111}{2} \\\\\n        & = `r format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\")` \\text{ (cm).}\n\\end{align*}\n\n<!-- Trung vị Bài tập 3-->\n\n```{r, echo = FALSE}\nbai3$k <- which(bai3$df$`Tần số tích lũy` >= bai3$n / 2)[1] \nbai3$r <- bai3$df$`Mút trái`[bai3$k]\nbai3$d <- bai3$df$`Mút phải`[bai3$k] - bai3$df$`Mút trái`[bai3$k]\nbai3$me <- fractions(bai3$r + ((bai3$n / 2 - ifelse(bai3$k > 1, bai3$df$`Tần số tích lũy`[bai3$k - 1], 0)) / bai3$df$`Tần số`[bai3$k]) * bai3$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_2=14 <\\frac{n}{2}=\\frac{40}{2}=20 <cf_3=28.\n$$\nSuy ra nhóm 3, $[50;55)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 20. Nhóm này có đầu mút trái $r=50$, độ dài $d=10$ và tần số $n_3=14$. Trung vị là\n\n    \\begin{align*}\n        M_e\n            & = r + \\left(\\frac{\\frac{n}{2}-cf_2}{n_3}\\right)\\cdot d \\\\\n            & = 50 + \\left(\\frac{20-14}{14}\\right)\\cdot 10 \\\\\n            & = \\frac{380}{7} \\\\\n            & \\approx `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n```{r, echo = FALSE}\nbai3$p <- which(bai3$df$`Tần số tích lũy` >= bai3$n / 4)[1]\nbai3$s <- bai3$df$`Mút trái`[bai3$p]\nbai3$h <- bai3$df$`Mút phải`[bai3$p] - bai3$df$`Mút trái`[bai3$p]\nbai3$q1 <- fractions(bai3$s + ((bai3$n / 4 - ifelse(bai3$p > 1, bai3$df$`Tần số tích lũy`[bai3$p - 1], 0)) / bai3$df$`Tần số`[bai3$p]) * bai3$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_1=4 < \\frac{n}{4}=\\frac{40}{4}=10 < cf_2=14.\n$$\nSuy ra nhóm 2, $[40;50)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 10. Nhóm này có đầu mút trái $s=40$, độ dài $h=10$ và tần số $n_2=10$. Tứ phân vị thứ nhất là\n\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_1}{n_2}\\right)\\cdot h \\\\\n            & = 40 + \\left(\\frac{10-4}{10}\\right)\\cdot 10 \\\\\n            & = `r format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2 = M_e = `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")`$ (cm).\n\n<!-- Tứ phân vị thứ ba Q3 -->\n\n```{r, echo = FALSE}\nbai3$q <- which(bai3$df$`Tần số tích lũy` >= (3 * bai3$n) / 4)[1]\nbai3$t <- bai3$df$`Mút trái`[bai3$q]\nbai3$l <- bai3$df$`Mút phải`[bai3$q] - bai3$df$`Mút trái`[bai3$q]\nbai3$q3 <- fractions(bai3$t + (((3 * bai3$n) / 4 - ifelse(bai3$q > 1, bai3$df$`Tần số tích lũy`[bai3$q - 1], 0)) / bai3$df$`Tần số`[bai3$q]) * bai3$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_3=28<\\frac{3n}{4}=\\frac{3\\cdot 40}{4}=30<cf_4=34.\n$$\nSuy ra nhóm 4, $[60;70)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 30. Nhóm này có đầu mút trái $t=60$, độ dài $l=10$ và tần số $n_4=6$. Tứ phân vị thứ ba là\n\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_3}{n_4}\\right)\\cdot l \\\\\n            & = 60 + \\left(\\frac{30-28}{6}\\right)\\cdot 10 \\\\\n            & = \\frac{190}{3} \\\\\n            & = `r format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n<!-- Mốt -->\n\n```{r, echo = FALSE}\nbai3$i <- which.max(bai3$df$`Tần số`)\nbai3$u <- bai3$df$`Mút trái`[bai3$i]\nbai3$g <- bai3$df$`Mút phải`[bai3$i] - bai3$df$`Mút trái`[bai3$i]\nbai3$mo <- fractions(bai3$u + ((bai3$df$`Tần số`[bai3$i] - ifelse(bai3$i > 1, bai3$df$`Tần số`[bai3$i - 1], 0)) / (2 * bai3$df$`Tần số`[bai3$i] - ifelse(bai3$i > 1, bai3$df$`Tần số`[bai3$i - 1]) - ifelse(bai3$i < nrow(bai3$df), bai3$df$`Tần số`[bai3$i + 1], 0))) * bai3$g, 4)\n```\n\nb. Quan sát cột Tần số, nhóm 3, $[50;60)$, là nhóm có tần số lớn nhất $n_3=14$. Nó có đầu mút trái $u=50$ và độ dài $g=10$. Nhóm 2 có tần số $n_2=10$ và nhóm 4 có tần số $n_4=6$. Mốt là\n    \\begin{align*}\n        M_o\n            & = u + \\left(\\frac{n_3-n_2}{2n_3-n_2-n_4}\\right) \\cdot g \\\\\n            & = 50 + \\left(\\frac{14-10}{2\\cdot 14-10-6}\\right)\\cdot 10 \\\\\n            & = \\frac{160}{3} \\\\\n            & \\approx `r format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\")` \\text{ (cm)}.\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline \n$[30;40)$ & $[40;50)$ & $[50;60)$ & $[60;70)$ & $[70;80)$ & $[80;90)$  \\\\\n\\hline \n1 & 0 & 0 & 1 & 10 & 17. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai3$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai3$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(dplyr)\nlibrary(MASS)\n# library(ggplot2)\n```\n\nNếu không có yêu cầu làm tròn đặc biệt, các con số sẽ được làm tròn đến 4 chữ số thập phân để tiện đối chiếu khi bạn tự tìm đáp án. \n\n# Bài học\n\n<!-- Hoạt động 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 1}\n:::\n\nTrong *Bảng 1*, ta thấy:\n\n- Có 13 ô-tô có độ tuổi dưới 4;\n- Có 29 ô-tô có độ tuổi từ 4 đến dưới 8.\n\nHãy xác định số ô-tô có độ tuổi:\n\n- Từ 8 đến dưới 12;\n- Từ 12 đến dưới 16;\n- Từ 16 đến dưới 20.\n\n<!-- Khung dữ liệu Hoạt động 1 -->\n\n```{r}\nhd1 <- new.env()\nhd1$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([0;4)\\\\)\", \"\\\\([4;8)\\\\)\", \"\\\\([8;12)\\\\)\", \"\\\\([12;16)\\\\)\", \"\\\\([16;20)\\\\)\"),\n    `Mút trái` = seq(0, 16, by = 4),\n    `Mút phải` = seq(4, 20, by = 4),\n    `Giá trị đại diện` = .5 * (seq(0, 16, by = 4) + seq(4, 20, by = 4)),\n    `Tần số` = c(13, 29, 48, 22, 8),\n    `Tần số tích lũy` = cumsum(c(13, 29, 48, 22, 8)),\n    check.names = FALSE\n)\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\"))\n# Chọn định dạng dựa vào output\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 1\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" icon=\"false\"}\nBạn có biết? Khi chưa quen với cách lập luận, bắt chước sách giáo khoa là một cách tốt để làm quen với cách trình bày. Khi đã hiểu rõ, bạn có thể tự phát triển cách lập luận của riêng mình.\n:::\n\nTừ *Bảng 1*, quan sát theo hàng để đếm số ô-tô trong từng nhóm độ tuổi.\n\n- Có 48 ô-tô có độ tuổi từ 8 đến dưới 12.\n- Có 22 ô-tô có độ tuổi từ 12 đến dưới 16.\n- Có 8 ô-tô có độ tuổi từ 16 đến dưới 20.\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Nhóm & tần số\" collapse=\"true\" icon=\"false\"}\n\nViệc xác định có 13 ô-tô có độ tuổi dưới 4 cho mình biết rằng nhóm $[0;4)$ có tần số 13.\n\n- **Nhóm**: $[a; b)$, chứa một số giá trị của mẫu số liệu, $a$ là *đầu mút trái*, $b$ là *đầu mút phải*. *Độ dài* nhóm là $b-a$.\n- **Tần số**: số giá trị của mẫu số liệu có trong nhóm $[a; b)$.\n\nBiết có 13 ô-tô có độ tuổi dưới 4, nhưng không biết tuổi cụ thể của từng ô-tô. \n:::\n\n::: {.callout-note title=\"Khám phá\" collapse=\"true\" icon=\"false\"}\nNhìn vào bảng số liệu, bạn có nhận xét gì về số lượng ô-tô theo từng nhóm độ tuổi?\n\n- Số lượng ô-tô cũ (trên 12 năm) có ít hơn xe mới không?\n- Điều này có ý nghĩa gì?\n:::\n\n</details>\n\n<!-- Luyện tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 1</summary>\n:::\n\n:::{.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 1}\n:::\n\nMẫu số liệu ghép nhóm ở *Bảng 1* có bao nhiêu số liệu? Bao nhiêu nhóm? Tìm tần số của mỗi nhóm.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\"))\n# Chọn định dạng dựa vào output\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 1\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Luyện tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 1</summary>\n:::\n\n:::{.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n- Mẫu số liệu ghép nhóm ở *Bảng 1* có 120 số liệu, chính là tổng của cột Tần số. \n- Mẫu số liệu này có 5 nhóm, bao gồm $[0;4)$, $[4;8)$, $[8;12)$, $[12;16)$ và $[16;20)$. Để ngắn gọn, gọi các nhóm này lần lượt là 1, 2, 3, 4 và 5.\n- Tần số của các nhóm 1, 2, 3, 4, 5 lần lượt là 13, 29, 48, 22, 8.\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 2}\n:::\n\nMột trường trung học phổ thông chọn 36 học sinh nam của khối lớp 11, đo chiều cao của các bạn học sinh đó và thu được mẫu số liệu sau (đơn vị: cm):\n\n<!-- Dữ liệu Hoạt động 2 -->\n\n```{r, echo = FALSE}\nhd2 <- new.env()\n# Tạo dữ liệu\nhd2$data <- c(160, 161, 161, 162, 162, 162, 163, 163, 163, 164, 164, 164, 164, 165, 165, 165, 165, 165, 166, 166, 166, 166, 167, 167, 168, 168, 168, 168, 169, 169, 170, 171, 171, 172, 172, 174)\ndata <- matrix(hd2$data, nrow = 3, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\nTừ mẫu số liệu không ghép nhóm trên, hãy ghép các số liệu thành năm nhóm theo các nửa khoảng có độ dài bằng nhau.\n\n</details>\n\n<!-- Lời giải Hoạt động 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\nLời giải\n\\end{center}\n:::\n\n::: {.callout-note title=\"Nhận thức quan trọng\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nỞ Hoạt động 1, chúng mình làm việc với một bảng tần số ghép nhóm đã có sẵn, nhưng không biết chính xác các số liệu gốc.\n\nSang Hoạt động 2, tình huống đảo ngược: số liệu cụ thể được cho, nhưng bảng tần số thì chưa có. Nhiệm vụ của chúng mình là ghép các số liệu thành năm nhóm có độ dài bằng nhau.\n\nĐiều thú vị là, với hai tiêu chí \"số lượng nhóm\" và \"độ dài nhóm\", mình chưa thể xác lập một cách ghép nhóm duy nhất. Vẫn còn nhiều cách khác nhau để chia nhóm, và đây chính là cơ hội để khám phá sâu hơn về về cách tổ chức và sắp xếp số liệu.\n\n> - Hoạt động 1: Có bảng tần số nhưng thiếu số liệu.\n> - Hoạt động 2: Có số liệu nhưng cần tự ghép nhóm, và việc ghép nhóm không có duy nhất một cách làm.\n\n:::\n\nSố liệu nhỏ nhất là 160, số liệu lớn nhất là 174, nên miền chứa toàn bộ số liệu là $[160; 174]$. Cần chia miền này thành 5 nhóm có độ dài bằng nhau, nên độ dài mỗi nhóm là\n$$\n    \\frac{174-160}{5}=2,8.\n$$\n\nNhưng nếu chia nhóm theo độ dài 2,8 cm, sẽ gặp các ranh giới thập phân không đẹp: \n\n::: {.center}\n$[160;162,8)$, $[162,8;165,6)$, $[165,6;168,4)$, $[168,4;171,2)$, $[171,2;174]$.\n:::\n\nRõ ràng, các số thập phân như 162,8 rất khó đọc, khó vẽ biểu đồ và không phù hợp với cách làm thống kê trong thực tế.\n\nSố 3 là số nguyên nhỏ nhất gần với 2,8. Nếu chọn độ dài nhóm là 3, miền dữ liệu cần mở rộng ra một chút để bao phủ toàn bộ dữ liệu cũ. Lúc này, nếu vẫn giữ đầu dưới là 160, thì đầu trên là\n$$\n    160+5\\cdot 3 = 175.\n$$\n\nKhi đó, các nhóm mới là \n\n::: {.center}\n$[160;163)$, $[163;166)$, $[166;169)$, $[169;172)$, $[172;175)$.\n:::\n\nNhóm cuối, $[172; 175)$, ghi theo dạng nửa khoảng là hợp lý, vì 175 không có trong số liệu gốc.\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Khám phá\" collapse=\"true\" icon=\"false\"}\nCó điều gì ngăn cản mình chọn ghép các số liệu thành năm nhóm sau đây không: \n\n::: {.center}\n$(159;162]$, $(162;165]$, $(165;168]$, $(168;171]$, $(171;174]$;\n:::\n\nhoặc\n\n::: {.center}\n$[159;162)$, $[162;165)$, $[165;168)$, $[168;171)$, $[171;174]$?\n:::\n\nNếu không, câu hỏi kế tiếp là có bao nhiêu cách ghép nhóm? Cách nào là tốt nhất và dựa trên tiêu chí nào để khẳng định?\n:::\n\n</details>\n\n<!-- Luyện tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 2}\n:::\n\nMột thư viện thống kê số người đến đọc sách vào buổi tối trong 30 ngày của tháng vừa qua như sau:\n\n```{r, echo=FALSE}\nlt2 <- new.env()\n# Tạo dữ liệu\nlt2$data <- c(85, 81, 65, 58, 47, 30, 51, 92, 85, 42, 55, 37, 31, 82, 63, 33, 44, 93, 77, 57, 44, 74, 63, 67, 46, 73, 52, 53, 47, 35)\ndata <- matrix(lt2$data, nrow = 3, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\nLập bảng tần số ghép nhóm có tám nhóm ứng với tám nửa khoảng sau: $[25; 34)$, $[34; 43)$, $[43; 52)$, $[52; 61)$, $[61; 70)$, $[70; 79)$, $[79 ; 88)$, $[88; 97)$.\n\n</details>\n\n<!-- Lời giải luyện tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nSắp xếp số liệu theo thứ tự *tăng dần* giúp mình dễ phân nhóm hơn.\n:::\n\nĐể đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(lt2$data), nrow = 3, byrow = TRUE))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[25;34)$ có ba số liệu bao gồm 30; 31; 33. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm -->\n\n```{r, echo = FALSE}\nlt2$points <- seq(25, 97, by = 9)\n# Các giá trị đại liện\nlt2$x <- .5 * (lt2$points[-length(lt2$points)] + lt2$points[-1])\n# Tần số\nlt2$categories <- cut(lt2$data, lt2$points, right = FALSE)\nlt2$f <- as.vector(table(lt2$categories))\n# Tần số tích lũy\nlt2$cf <- cumsum(lt2$f)\n# Khung dữ liệu\nlt2$df <- data.frame(\n    ` ` = seq(1, length(lt2$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(lt2$categories), \"\\\\)\")),\n    `Mút trái` = seq(25, 88, by = 9),\n    `Mút phải` = seq(34, 97, by = 9),\n    `Giá trị đại diện` = lt2$x,\n    `Tần số` = lt2$f,\n    `Tần số tích lũy` = lt2$cf,\n    check.names = FALSE\n)\n\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(lt2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 3}\n:::\n\nTrong *Bảng 4*, có bao nhiêu số liệu với giá trị không vượt quá giá trị đầu mút phải:\n\n::: {.columns}\n:::: {.column width=\"33%\"}\na. 163 của nhóm 1?\nb. 166 của nhóm 2?\n::::\n:::: {.column width=\"33%\"}\nc. 169 của nhóm 3?\nd. 172 của nhóm 4?\n::::\n:::: {.column width=\"33%\"}\ne. 175 của nhóm 5?\n::::\n:::\n\n```{r, echo = FALSE}\n# Các điểm chia\nhd2$points <- seq(160, 175, by = 3)\n# Các giá trị đại liện\nhd2$x <- .5 * (hd2$points[-length(hd2$points)] + hd2$points[-1])\n# Tần số\nhd2$categories <- cut(hd2$data, hd2$points, right = FALSE)\nhd2$f <- as.vector(table(hd2$categories))\n# Tần số tích lũy\nhd2$cf <- cumsum(hd2$f)\n# Khung dữ liệu\nhd2$df <- data.frame(\n    ` ` = seq(1, length(hd2$points) - 1, by = 1),\n    `Nhóm` = c(paste0(\"\\\\(\", levels(hd2$categories), \"\\\\)\")),\n    `Mút trái` = hd2$points[-length(hd2$points)],\n    `Mút phải` = hd2$points[-1],\n    `Giá trị đại diện` = hd2$x,\n    `Tần số` = hd2$f,\n    `Tần số tích lũy` = hd2$cf,\n    check.names = FALSE\n)\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 4\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Nhóm 1, $[160; 163)$, có tần số là 6. Vậy có 6 số liệu không vượt quá 163.\nb. Nhóm 2, $[163; 166)$, có tần số là 12. Các số liệu trong nhóm 1 cũng không vượt quá 166. Vậy tổng số là\n$$\n6+12=18.\n$$\nc. Tương tự, số số liệu không vượt quá đầu mút phải 169 của nhóm 3 là\n$$\n6+12+10=28.\n$$\nd. Số số liệu không vượt quá đầu mút phải 172 của nhóm 4 là\n$$\n6+12+10+5=33.\n$$\ne. Số số liệu không vượt quá đầu mút phải 175 của nhóm 5 là\n$$\n6+12+10+5+3=36.\n$$\n\n::: {.ket-thuc}\n:::\n\n::: {.callout-note title=\"Tần số tích lũy\" appearance=\"simple\" icon=false collapse=true}\nĐáp số câu a cho biết tần số tích lũy của nhóm 1 là $cf_1=6$. Đáp số câu b cho biết tần số tích lũy của nhóm 2 là $cf_2=18$. Đáp số câu e cho biết tần số tích lũy của nhóm 5 là $cf_5=36$.\n\n*Tần số tích lũy* của một nhóm là số số liệu có giá trị nhỏ hơn đầu mút phải của nhóm đó.\n:::\n\n</details>\n\n<!-- Luyện tập  3 -->\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 3}\n:::\n\nTrong bài toán ở Luyện tập 2, lập bảng tần số ghép nhóm bao gồm cả tần số tích lũy có tám nhóm ứng với tám nửa khoång: $[25; 34)$, $[34; 43)$, $[43; 52)$, $[52; 61)$, $[61; 70)$, $[70; 79)$, $[79 ; 88)$, $[88; 97)$.\n</details>\n\n<!-- Lời giải Luyện tập 3 -->\n<details>\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n::: {.callout-note title=\"Mẹo\" collapse=\"true\" appearance=\"simple\" icon=\"false\"}\nCó hai cách để tính tần số tích lũy $cf_3$ của nhóm 3.\n\n- Cách 1: $cf_3=n_1+n_2+n_3$, tính tần số tích lũy của nhóm 3 bằng cách cộng tần số của nhóm 1, nhóm 2 và nhóm 3.\n- Cách 2: $cf_3=cf_2+n_3$, tính tần số tích lũy của nhóm 3 bằng cách cộng tần số tích lũy của nhóm 2 và tần số của nhóm 3.\n\nTheo bạn, khi nào cách 2 nhanh hơn?\n:::\n\n```{r, echo = FALSE}\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(lt2$df[, c(-1, -3, -4, -5), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Hoạt động 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 4}\n:::\n\nXét mẫu số liệu được cho trong *Bảng 4*.\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 4\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Tìm trung điểm $x_1$ của nửa khoảng (tính bằng trung bình cộng của hai đầu mút) ứng với nhóm 1. Ta gọi trung điểm $x_1$ là *giá trị đại diện* của nhóm 1.\nb. Bằng cách tương tự, hãy tìm giá trị đại diện của bốn nhóm còn lại. Từ đó, hãy hoàn thiện các số liệu trong *Bảng 7*.\nc. Tính giá trị $\\overline{x}$ cho bởi công thức sau:\n$$\n\\overline{x} = \\frac{n_1x_1+n_2x_2+\\cdots+n_5x_5}{n}.\n$$\nGiá trị $\\overline{x}$ được gọi là *số trung bình cộng* của muẫ số liệu đã cho.\n\n<!-- Bảng 7 -->\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[\"Nhóm\"], `Giá trị đại diện`=c(\"\\\\(x_1=?\\\\)\", \"\\\\(x_2=?\\\\)\", \"\\\\(x_3=?\\\\)\", \"\\\\(x_4=?\\\\)\", \"\\\\(x_5=?\\\\)\"), `Tần số`=c(\"\\\\(n_1=?\\\\)\", \"\\\\(n_2=?\\\\)\", \"\\\\(n_3=?\\\\)\",\"\\\\(n_4=?\\\\)\", \"\\\\(n_5=?\\\\)\"), check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=36\\\\)\"))\n# Đổi dấu phẩy trong nhóm thành dấu chấm phẩy\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 7\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- LLời giải Hoạt động 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Giá trị đại diện của nhóm 1, $[160; 163)$, là\n    $$\n        x_1=\\frac{160+163}{2}=161,5 \\text{ (cm)}.\n    $$\n\nb. Tương tự, giá trị đại diện cho các nhóm còn lại được tính như dưới đây.\n    - Nhóm 2, $[163; 166)$: $x_2=\\frac{163+166}{2}=164,5$ (cm).\n    - Nhóm 3, $[166; 169)$: $x_3=\\frac{166+169}{2}=167,5$ (cm).\n    - Nhóm 4, $[169; 172)$: $x_4=\\frac{169+172}{2}=170,5$ (cm).\n    - Nhóm 5, $[172; 175)$: $x_5=\\frac{172+175}{2}=173,5$ (cm).\n\nc. Từ *Bảng 4* và các giá trị đại diện vừa tính, *Bảng 7* được hoàn thiện như dưới đây.\n\n```{r, echo=FALSE}\ndata <- data.frame(hd2$df[, c(-1, -3, -4, -7), drop = FALSE], check.names = FALSE)\n# Tạo chỉ mục tự động\nif (nrow(data) >0) {\nindex <- 1:nrow(data)\ndata$`Giá trị đại diện` <- paste0(\"\\\\(x_\", index, \"=\", data$`Giá trị đại diện`, \"\\\\)\")\ndata$`Tần số` <- paste0(\"\\\\(n_\", index, \"=\", data$`Tần số`, \"\\\\)\")\n} else {\n    stop(\"Dữ liệu df trống hoặc không hợp lệ\")\n}\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=36\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \"TEMP_MARKER\", x) # Đổi dấu ',' thành ký hiệu tạm\n    x <- gsub(\"\\\\.\", \",\", x) # Đổi dấu '.' thành ','\n    gsub(\"TEMP_MARKER\", \";\", x) # Đổi ký hiệu tạm thành ';'\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Trung bình -->\n\n```{r}\n# Kích thước mẫu\nhd2$n <- length(hd2$data)\nhd2$barx <- fractions(sum(hd2$df$`Giá trị đại diện` * hd2$df$`Tần số`) / sum(hd2$df$`Tần số`))\n```\n\nSố trung bình cộng của mẫu số liệu là\n    \\begin{align*}\n        \\overline{x} \n            & = \\frac{1}{36}(6\\cdot 161,5+12\\cdot 164,5+10\\cdot 167,5+5\\cdot170,5+3\\cdot 173,5) \\\\\n            & = \\frac{1997}{12} \\\\\n            & \\approx `r format(round(as.numeric(hd2$barx), 4), decimal.mark = \",\")` \\text{ (cm)}.\n    \\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 4}\n:::\n\nXác định số trung bình cộng của mẫu số liệu ghép nhóm trong bài toán ở Luyện tập 2.\n\n</details>\n\n<!-- Lời giải Luyện tập 4 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 4</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm và giá trị đại diện của mẫu số liệu trong bài toán ở Luyện tập 2 được cho trong bảng dưới đây.\n\n```{r, echo = FALSE}\ndata <- data.frame(lt2$df[, c(-1, -3, -4, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) # Đảm bảo x là kiểu character\n    x <- gsub(\",\", \"TEMP_MARKER\", x) # Đổi dấu ',' thành ký hiệu tạm\n    x <- gsub(\"\\\\.\", \",\", x) # Đổi dấu '.' thành ','\n    gsub(\"TEMP_MARKER\", \";\", x) # Đổi ký hiệu tạm thành ';'\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n```{r}\nlt2$n <- length(lt2$data)\nlt2$barx <- fractions(sum(lt2$df$`Giá trị đại diện` * lt2$df$`Tần số`) / sum(lt2$df$`Tần số`))\n```\n\nTrung bình cộng là\n\\begin{align*}\n    \\overline{x}\n        & = \\frac{1}{30}(3\\cdot 29,5 + 3\\cdot 38,5 + 6\\cdot 47,5 + 5\\cdot 56,5 + 4\\cdot 65,5 + 3\\cdot 74,5 + 4\\cdot 83,5 + 2\\cdot 92,5) \\\\\n        & = \\frac{296}{5} \\\\\n        & = `r format(round(as.numeric(lt2$barx), 4), decimal.mark = \",\")` \\text{ (người)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 5}\n:::\n\nTrong phòng thí nghiệm, người ta chia 99 mẫu vật thành năm nhóm căn cứ trên khối lượng của chúng (đơn vị: g) và lập bảng tần số ghép nhóm bao gồm cả tần số tích luỹ như *Bảng 10*.\n\na. Nhóm 3 là nhóm đầu tiên có tần số tích luỹ\nlớn hơn hoặc bằng \n$$\n    \\frac{n}{2}=\\frac{99}{2}=49,5 \\text{ có đúng không?}\n$$\nb. Tìm đầu mút trái $r$, độ dài $d$, tần số $n_3$ của nhóm 3 và tần số tích lũy $cf_2$ của nhóm 2.\nc. Tính giá trị $M_e$ theo công thức sau:\n$$\n    M_e = r + \\left (\\frac{49,5-cf_2}{n_3}\\right)\\cdot d.\n$$\nGiá trị $M_e$ được gọi là *trung vị* của mẫu số liệu ghép nhóm đã cho.\n\n```{r}\nhd5 <- new.env()\nhd5$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([27,5;32,5)\\\\)\", \"\\\\([32,5;37,5)\\\\)\", \"\\\\([37,5;42,5)\\\\)\", \"\\\\([42,5;47,5)\\\\)\", \"\\\\([47,5;52,5)\\\\)\"),\n    `Mút trái` = seq(27.5, 47.5, by = 5),\n    `Mút phải` = seq(32.5, 52.5, by = 5),\n    `Giá trị đại diện` = .5 * (seq(27.5, 47.5, by = 5) + seq(32.5, 52.5, by = 5)),\n    `Tần số` = c(16, 24, 20, 30, 9),\n    `Tần số tích lũy` = cumsum(c(16, 24, 20, 30, 9)),\n    check.names = FALSE\n)\ndata <- data.frame(hd5$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=99\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 10\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na. Vì $cf_2=40 <\\frac{n}{2}=\\frac{99}{2}= 49,5 < cf_3=60$, nên khẳng định nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 49,5 là đúng.\n\nb. Nhóm 3, $[37,5;42,5)$, có đầu mút trái $r=37,5$, độ dài $d=42,5-37,5=5$, tần số $n_3=20$. Tần số tích lũy của nhóm 2 là $cf_2=40$.\n\nc. Giá trị $M_e$ theo công thức là\n\\begin{align*}\n    M_e\n        & = r + \\left (\\frac{49,5-cf_2}{n_3}\\right)\\cdot d \\\\\n        & = 37,5 + \\left(\\frac{49,5-40}{20}\\right)\\cdot 5 \\\\\n        & = 39,875 \\text{ (g)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 5}\n:::\n\nXác định trung vị của mẫu số liệu ghép nhóm ở *Bảng 1*.\n\n</details>\n\n<!-- Lời giải Luyện tập 5 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 5</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n    \\textbf{Lời giải}\n\\end{center}\n:::\n\nThêm vào *Bảng 1* cột tần số tích lũy để thu được bảng dưới đây.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nVì \n$$\n    cf_2 = 42 < \\frac{n}{2} = \\frac{120}{2} = 60 < cf_3 = 90, \n$$\nnên nhóm 3, $[8;12)$, là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 60. Nóm này có đầu mút trái $r=8$, độ dài $d=4$, tần số $n_3=48$ và nhóm 2 có tần số tích lũy $cf_2 = 42$.\n\n<!--  Trung vị -->\n\n```{r, echo = FALSE}\n# Kích thước mẫu\nhd1$n <- sum(hd1$df$`Tần số`)\n# Tìm nhóm trung vị\nhd1$k <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 2)[1] # Tìm chỉ mục (vị trí hàng) đầu tiên ([1]) trong hd1$df sao cho giá trị của cột \"Tần số tích lũy\" lớn hơn hoặc bằng hd1$n / 2, rồi lưu vào hd1$k.\n# Mút trái nhóm trung vị\nhd1$r <- hd1$df$`Mút trái`[hd1$k]\n# Độ rộng nhóm\nhd1$d <- hd1$df$`Mút phải`[hd1$k] - hd1$df$`Mút trái`[hd1$k]\n# Tính trung vị\nhd1$me <- fractions(hd1$r + ((hd1$n / 2 - ifelse(hd1$k > 1, hd1$df$`Tần số tích lũy`[hd1$k - 1], 0)) / hd1$df$`Tần số`[hd1$k]) * hd1$d)\n```\n\nTrung vị của mẫu số liệu là\n\n\\begin{align*}\n    M_e\n        & = r + \\left ( \\frac{\\frac{n}{2} - cf_2}{n_3} \\right )\\cdot d \\\\\n        & = 8 + \\left (\\frac{60 - 42}{48}\\right)\\cdot 4 \\\\\n        & = \\frac{19}{2} \\\\\n        & = `r format(round(as.numeric(hd1$me), 4), decimal.mark = \",\")` \\text{ (năm)}.\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 6}\n:::\n\nGiáo viên chủ nhiệm chia thời gian sử dụng Internet trong một ngày của 40 học sinh thành năm nhóm (đơn vị: phút) và lập bảng tần số ghép nhóm bao gồm cả tần số tích lũy như *Bảng 12.*\n\na. Tìm trung vị $M_e$ của mẫu số liệu ghép nhóm đó. Trung vị $M_e$ còn gọi là tứ phân vị thứ hai $Q_2$ của mẫu số liệu trên.\n\nb. Nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng \n$$\n    \\frac{n}{4} = \\frac{40}{4} = 10 \\text{ có đúng không?}\n$$\nTìm đầu mút trái $s$, độ dài $h$, tần số $n_2$ của nhóm 2 và tần số tích lũy $cf_1$ của nhóm 1. Sau đó, hãy tính giá trị $Q_1$ theo công thức sau:\n$$\n    Q_1 = s + \\left (\\frac{10-cf_1}{n_2}\\right)\\cdot h.\n$$\nGiá trị nói trên được gọi là *tứ phân vị thứ nhất* $Q_1$ của mẫu số liệu đã cho.\n\nc. Nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng \n$$\n    \\frac{3n}{4} = \\frac{3\\cdot 40}{4} = 30 \\text{ có đúng không?}\n$$\nTìm đầu mút trái $t$, độ dài $l$, tần số $n_3$ của nhóm 3 và tần số tích lũy $cf_2$ của nhóm 2. Sau đó, hãy tính giá trị $Q_3$ theo công thức sau:\n$$\n    Q_3 = t + \\left (\\frac{30-cf_2}{n_3}\\right)\\cdot l.\n$$\nGiá trị nói trên được gọi là *tứ phân vị thứ ba* $Q_3$ của mẫu số liệu đã cho.\n\n<!-- Khung dữ liệu Hoạt động 6 -->\n\n```{r}\nhd6 <- new.env()\nhd6$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5),\n    `Nhóm` = c(\"\\\\([0;60)\\\\)\", \"\\\\([60;120)\\\\)\", \"\\\\([120;180)\\\\)\", \"\\\\([180;240)\\\\)\", \"\\\\([240;300)\\\\)\"),\n    `Mút trái` = seq(0, 240, by = 60),\n    `Mút phải` = seq(60, 300, by = 60),\n    `Giá trị đại diện` = .5 * (seq(0, 240, by = 60) + seq(60, 300, by = 60)),\n    `Tần số` = c(6, 13, 13, 6, 2),\n    `Tần số tích lũy` = cumsum(c(6, 13, 13, 6, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd6$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 12\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải Hoạt động 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\na. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 19 < \\frac{n}{2} = \\frac{40}{2} = 20 < cf_3 = 32,\n$$\nsuy ra nhóm 3, $[120; 180)$, là nhóm đầu tiên có tần số tích lũy lớn hơn 20. Nhóm này có đầu mút trái $r=120$, độ dài $d=60$, tần số $n_3=13$ và nhóm 2 có tần số tích lũy $cf_2 = 19$. Trung vị $M_e$ hay tứ phân vị thứ hai $Q_2$ là\n\n<!-- Trung vị Hoạt động 6 -->\n\n```{r, echo = FALSE}\nhd6$n <- sum(hd6$df$`Tần số`)\nhd6$k <- which(hd6$df$`Tần số tích lũy` >= hd6$n / 2)[1] \nhd6$r <- hd6$df$`Mút trái`[hd6$k]\nhd6$d <- hd6$df$`Mút phải`[hd6$k] - hd6$df$`Mút trái`[hd6$k]\n# Tính trung vị\nhd6$me <- fractions(hd6$r + ((hd6$n / 2 - ifelse(hd6$k > 1, hd6$df$`Tần số tích lũy`[hd6$k - 1], 0)) / hd6$df$`Tần số`[hd6$k]) * hd6$d)\n# hd6$me\n```\n\n\\begin{align*}\n    M_e = Q_2\n        & = r + \\left( \\frac{\\frac{n}{2} - cf_2}{n_3}\\right)\\cdot d \\\\\n        & = 120 + \\left( \\frac{20-19}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{1620}{13} \\\\\n        & = `r format(round(as.numeric(hd6$me), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\nb. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_1 = 6 < \\frac{n}{4} = \\frac{40}{4} = 10 < cf_2 = 19,\n$$\nnên khẳng định nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 10 là khẳng định đúng. Nhóm 2, $[60; 120)$, có đầu mút trái $s=60$, độ dài $h=60$, tần số $n_2=13$ và nhóm 1 có tần số tích lũy $cf_1 = 6$. Tứ phân vị thứ nhất là\n\n<!-- Tứ phân vị thứ nhất Q1 Hoạt động 6-->\n\n```{r}\n# Tìm nhóm tứ phân vị thứ nhất\nhd6$p <- which(hd6$df$`Tần số tích lũy` >= hd6$n / 4)[1]\n# Mút trái nhóm tứ phân vị thứ nhất\nhd6$s <- hd6$df$`Mút trái`[hd6$p]\n# Độ rộng nhóm tứ phân vị thứ nhất\nhd6$h <- hd6$df$`Mút phải`[hd6$p] - hd6$df$`Mút trái`[hd6$p]\n# Tính tứ phân vị thứ nhất\nhd6$q1 <- fractions(hd6$s + ((hd6$n / 4 - ifelse(hd6$p > 1, hd6$df$`Tần số tích lũy`[hd6$p - 1], 0)) / hd6$df$`Tần số`[hd6$p]) * hd6$h)\n# hd6$q1\n```\n\n\\begin{align*}\n    Q_1 \n        & = s + \\left (\\frac{10-cf_1}{n_2}\\right)\\cdot h \\\\\n        & = 60 + \\left(\\frac{10-6}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{1020}{13} \\\\\n        & = `r format(round(as.numeric(hd6$q1), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\nc. Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 19 < \\frac{n}{4} = \\frac{3\\cdot 40}{4} = 30 < cf_3 = 32,\n$$\nnên khẳng định nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn hoặc bằng 30 là khẳng định đúng. Nhóm 3, $[120;180)$, có đầu mút trái $t=120$, độ dài $l=60$, tần số $n_3=13$ và nhóm 2 có tần số tích lũy $cf_2 = 19$. Tứ phân vị thứ ba là \n\n<!-- Tứ phân vị thứ nhất Q3 Hoạt động 6-->\n\n```{r, echo = FALSE}\n# Tìm nhóm tứ phân vị thứ ba\nhd6$q <- which(hd6$df$`Tần số tích lũy` >= (3 * hd6$n) / 4)[1]\n# Mút trái nhóm tứ phân vị thứ ba\nhd6$t <- hd6$df$`Mút trái`[hd6$q]\n# Độ rộng nhóm tứ phân vị thứ ba\nhd6$l <- hd6$df$`Mút phải`[hd6$q] - hd6$df$`Mút trái`[hd6$q]\n# Tính tứ phân vị thứ ba\nhd6$q3 <- fractions(hd6$t + (((3 * hd6$n) / 4 - ifelse(hd6$q > 1, hd6$df$`Tần số tích lũy`[hd6$q - 1], 0)) / hd6$df$`Tần số`[hd6$q]) * hd6$h)\n# hd6$q3\n```\n\n\\begin{align*}\n    Q_3 \n        & = t + \\left (\\frac{30-cf_2}{n_3}\\right)\\cdot l \\\\\n        & = 120 + \\left(\\frac{30-19}{13}\\right)\\cdot 60 \\\\\n        & = \\frac{2220}{13} \\\\\n        & = `r format(round(as.numeric(hd6$q3), 4), decimal.mark = \",\")` \\text{ (phút).}\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Luyện tập 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 6}\n:::\n\nTìm tứ phân vị của mẫu số liệu trong *Bảng 1* (làm tròn các kết quả đến hàng phần mười).\n\n</details>\n\n<!-- Lời giải Luyện tập 6 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 6</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n*Bảng 1* thêm vào cột Tần số tích lũy được trình bày như dưới đây.\n\n```{r}\ndata <- data.frame(hd1$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=120\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_1 = 13 < \\frac{n}{4} = \\frac{120}{4} = 30 < cf_2 = 42,\n$$\nnên nhóm 2 là nhóm đầu tiên có tần số tích lũy lớn hơn 30. Nhóm 2, $[4; 8)$, có đầu mút trái $s=4$, độ dài $h=4$, tần số $n_2=29$ và nhóm 1 có tần số tích lũy $cf_1 = 13$. Tứ phân vị thứ nhất là \n\n```{r}\n# Tìm nhóm tứ phân vị thứ nhất\nhd1$p <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 4)[1]\n# Mút trái nhóm tứ phân vị thứ nhất\nhd1$s <- hd1$df$`Mút trái`[hd1$p]\n# Độ rộng nhóm tứ phân vị thứ nhất\nhd1$h <- hd1$df$`Mút phải`[hd1$p] - hd1$df$`Mút trái`[hd1$p]\n# Tính tứ phân vị thứ nhất\nhd1$q1 <- fractions(hd1$s + ((hd1$n / 4 - ifelse(hd1$p > 1, hd1$df$`Tần số tích lũy`[hd1$p - 1], 0)) / hd1$df$`Tần số`[hd1$p]) * hd1$h)\n# hd1$q1\n```\n\n\\begin{align*}\n    Q_1 \n        & = 4 + \\left (\\frac{30-13}{29}\\right)\\cdot 4 \\\\\n        & = \\frac{184}{29} \\\\\n        & \\approx `r format(round(as.numeric(hd1$q1), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*}\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2 = 42 < \\frac{n}{2} = \\frac{120}{2} = 60 < cf_3 = 90,\n$$\nrút ra nhóm 3 là nhóm đầu tiên có tần số tích lũy lớn hơn 60. Nhóm 3, $[8; 12)$, có đầu mút trái $r=8$, độ dài $d=4$, tần số $n_3=48$ và nhóm 2 có tần số tích lũy $cf_2 = 42$. Tứ phân vị thứ hai là\n\n<!-- Trung vị Hoạt động 6 -->\n\n```{r, echo = FALSE}\nhd1$n <- sum(hd1$df$`Tần số`)\nhd1$k <- which(hd1$df$`Tần số tích lũy` >= hd1$n / 2)[1] \nhd1$r <- hd1$df$`Mút trái`[hd1$k]\nhd1$d <- hd1$df$`Mút phải`[hd1$k] - hd1$df$`Mút trái`[hd1$k]\n# Tính trung vị\nhd1$me <- fractions(hd1$r + ((hd1$n / 2 - ifelse(hd1$k > 1, hd1$df$`Tần số tích lũy`[hd1$k - 1], 0)) / hd1$df$`Tần số`[hd1$k]) * hd1$d)\n# hd1$me\n```\n\n\\begin{align*}\n    Q_2\n        & = 8 + \\left( \\frac{60-42}{48}\\right)\\cdot 4 \\\\\n        & = \\frac{19}{2} \\\\\n        & \\approx `r format(round(as.numeric(hd1$me), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*}\n\n- Quan sát từ cột Tần số tích lũy, \n$$\n    cf_2=42 < \\frac{n}{4} = \\frac{3\\cdot 120}{4} = 90 = cf_3,\n$$\nnên nhóm 3, $[8;12)$, là nhóm đầu tiên có tần số tích lũy bằng 90. Tứ phân vị thứ ba là\n\n<!-- Tứ phân vị thứ nhất Q3 Luyện tập 6 -->\n\n```{r, echo = FALSE}\n# Tìm nhóm tứ phân vị thứ ba\nhd1$q <- which(hd1$df$`Tần số tích lũy` >= (3 * hd1$n) / 4)[1]\n# Mút trái nhóm tứ phân vị thứ ba\nhd1$t <- hd1$df$`Mút trái`[hd1$q]\n# Độ rộng nhóm tứ phân vị thứ ba\nhd1$l <- hd1$df$`Mút phải`[hd1$q] - hd1$df$`Mút trái`[hd1$q]\n# Tính tứ phân vị thứ ba\nhd1$q3 <- fractions(hd1$t + (((3 * hd1$n) / 4 - ifelse(hd1$q > 1, hd1$df$`Tần số tích lũy`[hd1$q - 1], 0)) / hd1$df$`Tần số`[hd1$q]) * hd1$h)\n# hd1$q3\n```\n \n\\begin{align*}\n    Q_3\n        & = 8 + \\left(\\frac{90-42}{48}\\right)\\cdot 4 \\\\\n        & = `r format(round(as.numeric(hd1$q3), 0), decimal.mark = \",\")` \\text{ (năm).}\n\\end{align*} \n\n::: {.ket-thuc}\n:::\n\n</details>\n\n<!-- Hoạt động 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Hoạt động 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Hoạt động 7}\n:::\n\nQuan sát bảng tần số ghép nhóm bao gồm cả tần số tích luỹ ở *Ví dụ 6* và cho biết:\n\na. Nhóm nào có tần số lớn nhất;\nb. Đầu mút trái và độ dài của nhóm có tần số lớn nhất bằng bao nhiêu.\n\n</details>\n\n<!-- Lời giải Hoạt động 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Hoạt động 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm bao gồm cả tần số tích luỹ ở *Ví dụ 6* được trình bày như dưới đây.\n\n```{r}\nhd7 <- new.env()\nhd7$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(2, 10, 16, 8, 2, 2),\n    `Tần số tích lũy` = cumsum(c(2, 10, 16, 8, 2, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd7$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 15\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Nhóm 3, $[50; 60)$, có tần số lớn nhất 16.\nb. Nhóm 3 có dầu mút trái 50 và độ dài 10.\n\n</details>\n\n<!-- Luyện tập 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Luyện tập 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Luyện tập 7}\n:::\n\nTìm mốt của mẫu số liệu trong *Ví dụ 6* (làm tròn các kết quả đến hàng\nphần mười). \n\n</details>\n\n<!-- Lời giải Luyện tập 7 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải Luyện tập 7</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\nBảng tần số ghép nhóm của mẫu số liệu *Ví dụ 6* được trình bày dưới đây.\n\n```{r}\nhd7 <- new.env()\nhd7$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(2, 10, 16, 8, 2, 2),\n    `Tần số tích lũy` = cumsum(c(2, 10, 16, 8, 2, 2)),\n    check.names = FALSE\n)\ndata <- data.frame(hd7$df[, c(-1, -3, -4, -5, -7), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nQuan sát cột Tần số, nhóm 3, $[50;60)$, là nhóm có tần số lớn nhất $n_3=16$, có đầu mút trái $u=50$ và độ dài $g=10$. Nhóm 2 có tần số $n_2=10$ và nhóm 4 có tần số $n_4=8$. Mốt là\n\n<!-- Mốt -->\n\n```{r}\n# Tìm nhóm có tần số lớn nhất\nhd7$i <- which.max(hd7$df$`Tần số`)\n# Mút trái của nhóm mốt\nhd7$u <- hd7$df$`Mút trái`[hd7$i]\n# Độ rộng nhóm mốt\nhd7$g <- hd7$df$`Mút phải`[hd7$i] - hd7$df$`Mút trái`[hd7$i]\n# Tính mốt\nhd7$mo <- fractions(hd7$u + ((hd7$df$`Tần số`[hd7$i] - ifelse(hd7$i > 1, hd7$df$`Tần số`[hd7$i - 1], 0)) / (2 * hd7$df$`Tần số`[hd7$i] - ifelse(hd7$i > 1, hd7$df$`Tần số`[hd7$i - 1]) - ifelse(hd7$i < nrow(hd7$df), hd7$df$`Tần số`[hd7$i + 1], 0))) * hd7$g, 4)\n# hd7$mo\n```\n\n\\begin{align*}\n    M_o\n        & = u + \\left(\\frac{n_3-n_2}{2n_3-n_2-n_4}\\right)\\cdot g \\\\\n        & = 50 + \\left(\\frac{16-10}{2\\cdot 16-10-8}\\right)\\cdot 10 \\\\\n        & = \\frac{380}{7} \\\\\n        & = `r format(round(as.numeric(hd7$mo), 1), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n::: {.ket-thuc}\n:::\n\n</details>\n\n# Bài tập\n\nXem Kết quả để tra nhanh kết quả.\n\n<!-- Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 1</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 1}\n:::\n\nMẫu số liệu dưới đây ghi lại tốc độ của 40 ô-tô khi đi qua một trạm đo tốc độ (đơn vị: km/h):\n\n<!-- Dữ liệu -->\n\n```{r}\nbai1 <- new.env()\n# Tạo dữ liệu\nbai1$data <- c(48.5, 43, 50, 55, 45, 60, 53, 55.5, 44, 65, 51, 62.5, 41, 44.5, 57, 57, 68, 49, 46.5, 53.5, 61, 49.5, 54, 62, 59, 56, 47, 50, 60, 61, 49.5, 52.5, 57, 47, 60, 55, 45, 47.5, 48, 61.5)\ndata <- matrix(bai1$data, nrow = 4, byrow = TRUE)\n# Định dạng số thập phân: thay dấu \".\" bằng \",\"\ndata <- format(data, decimal.mark = \",\")\n# Bảng\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA) %>%\n        kable_styling(latex_options = \"hold_position\")\n}\n```\n\na. Lập bảng tần số ghép nhóm cho mẫu số liệu trên có sáu nhóm ứng với sáu nửa khoảng:\n\n::: {.content-visible when-format=\"html\"}\n<div style=\"text-align: center;\">\n$[40; 45)$, $[45 ; 50)$, $[50; 55)$, $[55 ; 60)$, $[60; 65)$, $[65; 70)$.\n</div>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n$[40; 45)$, $[45 ; 50)$, $[50; 55)$, $[55 ; 60)$, $[60; 65)$, $[65; 70)$.\n\\end{center}\n:::\n\nb. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nc.  Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n</details>\n\n<!-- Lời giải Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n<!-- Khung dữ liệu Bài tập 1 -->\n\n```{r, echo=FALSE}\nbai1$points <- seq(40, 70, by = 5)\nbai1$x <- .5 * (bai1$points[-length(bai1$points)] + bai1$points[-1])\nbai1$categories <- cut(bai1$data, bai1$points, right = FALSE)\nbai1$f <- as.vector(table(bai1$categories))\nbai1$cf <- cumsum(bai1$f)\nbai1$df <- data.frame(\n    ` ` = seq(1, length(bai1$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(bai1$categories), \"\\\\)\")),\n    `Mút trái` = seq(40, 65, by = 5),\n    `Mút phải` = seq(45, 70, by = 5),\n    `Giá trị đại diện` = bai1$x,\n    `Tần số` = bai1$f,\n    `Tần số tích lũy` = bai1$cf,\n    check.names = FALSE\n)\n```\n\na. Để đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(bai1$data), nrow = 4, byrow = TRUE), decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[40;45)$ có bốn số liệu bao gồm 41; 43; 44; 44,5. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm Bài tập 1 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai1$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=40\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nb. Thêm vào bảng tần số ghép nhóm ở trên cột số thứ tự để dễ quan sát, cột Giá trị đại diện để tính trung bình, và cột Tần số tích lũy để tính tứ phân vị. \n\n<!-- Bảng tần số ghép nhóm mở rộng Bài tập 1 -->\n\n```{r}\ndata <- rbind(bai1$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x) \n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x) \n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n\n```\n\n<!-- Trung bình Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$n <- length(bai1$data)\nbai1$barx <- fractions(sum(bai1$df$`Giá trị đại diện` * bai1$df$`Tần số`) / sum(bai1$df$`Tần số`))\n```\n\n- Mẫu có $n=40$ số liệu. Nhóm 1, $[40;45)$, có trung điểm $x_1=42,5$ làm giá trị đại diện và có tần số $n_1=4$. Ký hiệu tương tự cho các nhóm còn lại. Trung bình cộng là\n\\begin{align*}\n    \\overline{x} \n        & = \\frac{1}{n} (n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6) \\\\\n        & = \\frac{1}{40} (4\\cdot 42,5 + 11\\cdot 47,5 + 7\\cdot 52,5 + 8\\cdot 57,5 + 8\\cdot 62,5 + 2\\cdot 67,5) \\\\\n        & = \\frac{431}{8} \\\\\n        & = `r format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\")` \\text{ (km/h)}.\n\\end{align*}\n\n<!-- Trung vị M_e và tứ phân vị thứ hai Q_2 Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$k <- which(bai1$df$`Tần số tích lũy` >= bai1$n / 2)[1]\nbai1$r <- bai1$df$`Mút trái`[bai1$k]\nbai1$d <- bai1$df$`Mút phải`[bai1$k] - bai1$df$`Mút trái`[bai1$k]\nbai1$me <- fractions(bai1$r + ((bai1$n / 2 - ifelse(bai1$k > 1, bai1$df$`Tần số tích lũy`[bai1$k - 1], 0)) / bai1$df$`Tần số`[bai1$k]) * bai1$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy \n$$\n    cf_2=15 < \\frac{n}{2}=\\frac{40}{2}=20 < cf_3=22.\n$$\nSuy ra nhóm 3, $[50;55)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 20. Nhóm này có đầu mút trái $r=50$, độ dài $d=5$ và tần số $n_3=7$. Trung vị là\n    \\begin{align*}\n        M_e\n            & = r+\\left(\\frac{\\frac{n}{2}-cf_2}{n_3}\\right)\\cdot d \\\\\n            & = 50 + \\left(\\frac{20-15}{7}\\right)\\cdot 5 \\\\\n            & = \\frac{375}{7} \\\\\n            & \\approx `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q_1 Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$p <- which(bai1$df$`Tần số tích lũy` >= bai1$n / 4)[1]\nbai1$s <- bai1$df$`Mút trái`[bai1$p]\nbai1$h <- bai1$df$`Mút phải`[bai1$p] - bai1$df$`Mút trái`[bai1$p]\nbai1$q1 <- fractions(bai1$s + ((bai1$n / 4 - ifelse(bai1$p > 1, bai1$df$`Tần số tích lũy`[bai1$p - 1], 0)) / bai1$df$`Tần số`[bai1$p]) * bai1$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_1=4 < \\frac{n}{4}=\\frac{40}{4}=10 < cf_2=15.\n$$\nSuy ra nhóm 2, $[45;50)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 10. Nhóm này có đầu mút trái $s=45$, độ dài $h=5$ và tần số $n_2=11$. Tứ phân vị thứ nhất là\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_1}{n_2}\\right)\\cdot h \\\\\n            & = 45 + \\left(\\frac{10-4}{11}\\right)\\cdot 5 \\\\\n            & = \\frac{525}{11} \\\\\n            & \\approx `r format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2 = M_e = `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")`$ (km/h).\n\n<!-- Tứ phân vị thứ ba Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$q <- which(bai1$df$`Tần số tích lũy` >= (3 * bai1$n) / 4)[1]\nbai1$t <- bai1$df$`Mút trái`[bai1$q]\nbai1$l <- bai1$df$`Mút phải`[bai1$q] - bai1$df$`Mút trái`[bai1$q]\nbai1$q3 <- fractions(bai1$t + (((3 * bai1$n) / 4 - ifelse(bai1$q > 1, bai1$df$`Tần số tích lũy`[bai1$q - 1], 0)) / bai1$df$`Tần số`[bai1$q]) * bai1$l)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_3=22 < \\frac{3n}{4} = \\frac{3 \\cdot 40}{4} = 30 = cf_4.\n$$\nSuy ra nhóm 4, $[55;60)$, là nhóm đầu tiên có tần số tích lũy bằng với 30. Nhóm này có đầu mút trái $t=55$, độ dài $l=5$ và tần số $n_4=8$. Tứ phân vị thứ ba là\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_3}{n_4}\\right)\\cdot l \\\\\n            & = 55 + \\left(\\frac{30-22}{8}\\right)\\cdot 5 \\\\\n            & = `r format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\")` \\text{ (km/h).}\n    \\end{align*}\n\n<!-- Mốt Bài tập 1 -->\n\n```{r, echo = FALSE}\nbai1$i <- which.max(bai1$df$`Tần số`)\nbai1$u <- bai1$df$`Mút trái`[bai1$i]\nbai1$g <- bai1$df$`Mút phải`[bai1$i] - bai1$df$`Mút trái`[bai1$i]\nbai1$mo <- fractions(bai1$u + ((bai1$df$`Tần số`[bai1$i] - ifelse(bai1$i > 1, bai1$df$`Tần số`[bai1$i - 1], 0)) / (2 * bai1$df$`Tần số`[bai1$i] - ifelse(bai1$i > 1, bai1$df$`Tần số`[bai1$i - 1]) - ifelse(bai1$i < nrow(bai1$df), bai1$df$`Tần số`[bai1$i + 1], 0))) * bai1$g)\n```\n\nc. Quan sát cột Tần số, nhóm 2, $[45;50)$, là nhóm có tần số lớn nhất $n_2=11$. Nó có đầu mút trái $u=45$ và độ dài $g=5$. Nhóm 1 có tần số $n_1=4$ và nhóm 3 có tần số $n_3=7$. Mốt là\n    \\begin{align*}\n        M_o\n            & = u + \\left(\\frac{n_2-n_1}{2n_2-n_1-n_3}\\right) \\cdot g \\\\\n            & = 45 + \\left(\\frac{11-4}{2\\cdot 11-4-7}\\right)\\cdot 5 \\\\\n            & = \\frac{530}{11} \\\\\n            & \\approx `r format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\")` \\text{ (km/h)}.\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\centering\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline \n$[40; 45)$ & $[45 ; 50)$ & $[50; 55)$ & $[55 ; 60)$ & $[60; 65)$ & $[65; 70)$ \\\\\n\\hline \n4 & 11 & 7 & 8 & 8 & 2. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả Bài tập 1 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai1$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x)\n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai1$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai1$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai1$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai1$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai1$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>\n\n<!-- Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 2</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 2}\n:::\n\nMẫu số liệu sau ghi lại cân nặng của 30 bạn học sinh (đơn vị: kg):\n\n<!-- Dữ liệu Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2 <- new.env()\nbai2$data <- c(17.0, 40.0, 39.0, 40.5, 42.0, 51.0, 41.5, 39.0, 41.0, 30.0, 40.0, 42.0, 40.5, 39.5, 41.0, 40.5, 37.0, 39.5, 40.0, 41.0, 38.5, 39.5, 40.0, 41.0, 39.0, 40.5, 40.0, 38.5, 39.5, 41.5)\ndata <- matrix(bai2$data, nrow = 3, byrow = TRUE)\ndata <- format(data, decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\na. Lập bảng tần số ghép nhóm cho mẫu số liệu trên có tám nhóm ứng với tám nửa khoảng:\n\n::: {.content-visible when-format=\"html\"}\n<div style=\"text-align: center;\">\n$[15; 20)$, $[20; 25)$, $[25; 30)$, $[30; 35)$, $[35; 40)$, $[40 ; 45)$, $[45; 50)$, $[50; 55)$.\n</div>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n$[15; 20)$, $[20; 25)$, $[25; 30)$, $[30; 35)$, $[35; 40)$, $[40 ; 45)$, $[45; 50)$, $[50; 55)$.\n\\end{center}\n:::\n\nb. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nc. Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n</details>\n\n<!-- Lời giải Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\n<!-- Khung dữ liệu Bài tập 2 -->\n\n```{r, echo=FALSE}\nbai2$points <- seq(15, 55, by = 5)\nbai2$x <- .5 * (bai2$points[-length(bai2$points)] + bai2$points[-1])\nbai2$categories <- cut(bai2$data, bai2$points, right = FALSE)\nbai2$f <- as.vector(table(bai2$categories))\nbai2$cf <- cumsum(bai2$f)\nbai2$df <- data.frame(\n    ` ` = seq(1, length(bai2$points) - 1, by = 1),\n    Nhóm = c(paste0(\"\\\\(\", levels(bai2$categories), \"\\\\)\")),\n    `Mút trái` = seq(15, 50, by = 5),\n    `Mút phải` = seq(20, 55, by = 5),\n    `Giá trị đại diện` = bai2$x,\n    `Tần số` = bai2$f,\n    `Tần số tích lũy` = bai2$cf,\n    check.names = FALSE\n)\n```\n\na. Để đảm bảo phân nhóm chính xác, số liệu nên được sắp xếp theo thứ tự tăng dần. \n\n<!-- Sắp xếp số liệu tăng dần -->\n\n```{r, echo=FALSE}\ndata <- format(matrix(sort(bai2$data), nrow = 3, byrow = TRUE), decimal.mark = \",\")\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data,\n        format = \"html\",\n        align = \"c\", col.names = NA\n    ) %>%\n        kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE\n        )\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nNhìn vào dãy có thứ tự tăng dần, dễ dàng thấy rằng thuộc vào nhóm $[15,20)$ chỉ có một số liệu là 17. Bảng tần số ghép nhóm được thành lập dựa trên các quan sát như thế cho đến khi duyệt hết số liệu.\n\n<!-- Bảng tần số ghép nhóm Bài tập 2 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-1, -3, -4, -5, -7), drop = FALSE], c(\"\", \"\\\\(n=30\\\\)\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\nb. Thêm vào bảng tần số ghép nhóm ở trên cột số thứ tự để dễ quan sát, cột Giá trị đại diện để tính trung bình, và cột Tần số tích lũy để tính tứ phân vị.\n\n<!-- Bảng tần số ghép nhóm mở rộng Bài tập 2 -->\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=30\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x)\n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x)\n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n<!-- Trung bình Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$n <- length(bai2$data)\nbai2$barx <- fractions(sum(bai2$df$`Giá trị đại diện` * bai2$df$`Tần số`) / sum(bai2$df$`Tần số`))\n```\n\n- Mẫu có $n=30$ số liệu. Nhóm 1, $[15;20)$, có trung điểm $x_1=17,5$ làm giá trị đại diện và có tần số $n_1=1$. Ký hiệu tương tự với các nhóm còn lại. Trung bình là\n\\begin{align*}\n\\overline{x}\n    & = \\frac{1}{n}(n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6 + n_7\\cdot x_7 + n_8\\cdot x_8) \\\\\n    & = \\frac{1}{30} (1\\cdot 17,5 + 0\\cdot 22,5 + 0\\cdot 27,5+ 1\\cdot 32,5 + 10\\cdot 37,5 + 17\\cdot 42,5 + 0\\cdot 47,5 + 52,5 \\cdot 1) \\\\\n    & = `r format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n<!-- Trung vị Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$k <- which(bai2$df$`Tần số tích lũy` >= bai2$n / 2)[1]\nbai2$r <- bai2$df$`Mút trái`[bai2$k]\nbai2$d <- bai2$df$`Mút phải`[bai2$k] - bai2$df$`Mút trái`[bai2$k]\nbai2$me <- fractions(bai2$r + ((bai2$n / 2 - ifelse(bai2$k > 1, bai2$df$`Tần số tích lũy`[bai2$k - 1], 0)) / bai2$df$`Tần số`[bai2$k]) * bai2$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_5=12 < \\frac{n}{2}=15 < cf_6=29.\n$$\nSuy ra nhóm 6, $[40;45)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 15. Nhóm này có đầu mút trái $r=40$, độ dài $d=5$ và tần số $n_6=17$. Trung vị là\n\\begin{align*}\nM_e\n    & = r + \\left(\\frac{\\frac{n}{2}-cf_5}{n_6}\\right)\\cdot d \\\\\n    & = 40 + \\left(\\frac{15-12}{17}\\right)\\cdot 5 \\\\\n    & = \\frac{695}{17} \\\\\n    & \\approx `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")` \\text{ (kg).}\n\\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n```{r, echo = FALSE}\nbai2$p <- which(bai2$df$`Tần số tích lũy` >= bai2$n / 4)[1]\nbai2$s <- bai2$df$`Mút trái`[bai2$p]\nbai2$h <- bai2$df$`Mút phải`[bai2$p] - bai2$df$`Mút trái`[bai2$p]\nbai2$q1 <- fractions(bai2$s + ((bai2$n / 4 - ifelse(bai2$p > 1, bai2$df$`Tần số tích lũy`[bai2$p - 1], 0)) / bai2$df$`Tần số`[bai2$p]) * bai2$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_4=2 <\\frac{n}{4}=\\frac{30}{4}=7,5 < cf_5=12.\n$$\nSuy ra nhóm 5, $[35;40)$, là nhóm đầu tiên có tần số tích lũy, không nhỏ hơn 7,5. Nhóm này có đầ mút trái $s=35$, độ dài $h=5$ và tần số $n_5=10$. Tứ phân vị thứ nhất là\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_4}{n_5}\\right)\\cdot h \\\\\n            & = 35 + \\left(\\frac{7,5-2}{10}\\right)\\cdot 5 \\\\\n            & = \\frac{151}{4} \\\\\n            & = `r format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\")` \\text{ (kg).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2=M_e \\approx `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")`$ (kg).\n\n<!-- Tứ phân vị thứ ba Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$q <- which(bai2$df$`Tần số tích lũy` >= (3 * bai2$n) / 4)[1]\nbai2$t <- bai2$df$`Mút trái`[bai2$q]\nbai2$l <- bai2$df$`Mút phải`[bai2$q] - bai2$df$`Mút trái`[bai2$q]\nbai2$q3 <- fractions(bai2$t + (((3 * bai2$n) / 4 - ifelse(bai2$q > 1, bai2$df$`Tần số tích lũy`[bai2$q - 1], 0)) / bai2$df$`Tần số`[bai2$q]) * bai2$l)\n```\n\n- Quan sát cột Tần số tích lũy, ta có\n$$\ncf_5=12<\\frac{3n}{4}=\\frac{3\\cdot 30}{3}=22,5<cf_6=29.\n$$\nSuy ra nhóm 6, $[40;45)$ là nhòm đầu tiên có tần số tích lũy không nhỏ hơn 22,5. Nhóm này có đầu mút trái $t=40$, độ dài $l=5$ và tần số $n_6=17$. Tứ phân vị thứ ba là\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_5}{n_6}\\right)\\cdot l \\\\\n            & = 40 +\\left(\\frac{22,5-12}{17}\\right) \\cdot 5 \\\\\n            & = \\frac{1465}{34} \\\\\n            & \\approx `r format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\")` \\text{ (kg).} \n    \\end{align*}\n\n<!-- Mốt Bài tập 2 -->\n\n```{r, echo = FALSE}\nbai2$i <- which.max(bai2$df$`Tần số`)\nbai2$u <- bai2$df$`Mút trái`[bai2$i]\nbai2$g <- bai2$df$`Mút phải`[bai2$i] - bai2$df$`Mút trái`[bai2$i]\nbai2$mo <- fractions(bai2$u + ((bai2$df$`Tần số`[bai2$i] - ifelse(bai2$i > 1, bai2$df$`Tần số`[bai2$i - 1], 0)) / (2 * bai2$df$`Tần số`[bai2$i] - ifelse(bai2$i > 1, bai2$df$`Tần số`[bai2$i - 1]) - ifelse(bai2$i < nrow(bai2$df), bai2$df$`Tần số`[bai2$i + 1], 0))) * bai2$g, 4)\n```\n\nc. Quan sát cột Tần số, nhóm 6, $[40,45)$ là nhóm có tần số lớn nhất $n_6=17$. Nhóm này có đầu mút trái $u=40$ và độ dài $g=5$. Nhóm 5 liền trước nó có tần số $n_5=10$ và nhóm 7 liền sau nó có tần số $n_7=0$. Mốt là\n    \\begin{align*}\n        M_o \n            & = u + \\left(\\frac{n_6-n_5}{2n_6 - n_5 - n_7}\\right)\\cdot g \\\\\n            & = 40 + \\left(\\frac{17-10}{2\\cdot 17 - 10 - 0}\\right)\\cdot 5 \\\\\n            & = \\frac{995}{24} \\\\\n            & \\approx `r formatC(round(as.numeric(bai2$mo), 4), format = \"f\", digits = 1, decimal.mark = \",\")` \\text{ (kg).}\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|c|c|}\n\\hline \n$[15;20)$ & $[20; 25)$ & $[25; 30)$ & $[30; 35)$ & $[35;40)$ & $[40; 45)$ & $[45;50)$ & $[50;55)$ \\\\\n\\hline \n1 & 0 & 0 & 1 & 10 & 17 & 0 & 1. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai2$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả Bài tập 2 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai2$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x) \n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x) \n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai2$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai2$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai2$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai2$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai2$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>\n\n<!-- Bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"de-muc\">Bài tập 3</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\section*{Bài tập 3}\n:::\n\nBảng 15 cho ta bảng tần số ghép nhóm số liệu thống kê chiều cao của 40 mẫu cây ở một vườn thực vật (đơn vị: cm).\n\na. Xác định trung bình cộng, trung vị, tứ phân vị của mẫu số liệu ghép nhóm trên.\n\nb. Mốt của mẫu số liệu ghép nhóm trên là bao nhiêu?\n\n<!-- Khung dữ liệu Bài tập 3 -->\n\n```{r}\nbai3 <- new.env()\nbai3$df <- data.frame(\n    ` ` = c(1, 2, 3, 4, 5, 6),\n    `Nhóm` = c(\"\\\\([30;40)\\\\)\", \"\\\\([40;50)\\\\)\", \"\\\\([50;60)\\\\)\", \"\\\\([60;70)\\\\)\", \"\\\\([70;80)\\\\)\", \"\\\\([80;90)\\\\)\"),\n    `Mút trái` = seq(30, 80, by = 10),\n    `Mút phải` = seq(40, 90, by = 10),\n    `Giá trị đại diện` = .5 * (seq(30, 80, by = 10) + seq(40, 90, by = 10)),\n    `Tần số` = c(4, 10, 14, 6, 4, 2),\n    `Tần số tích lũy` = c(4, 14, 28, 34, 38, 40),\n    check.names = FALSE\n)\ndata <- data.frame(bai3$df[, c(-1, -3, -4, -5), drop = FALSE], check.names = FALSE)\ndata <- rbind(data, c(\"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA, caption = \"Bảng 15\") %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE)\n}\n```\n\n</details>\n\n<!-- Lời giải bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"giai-de-muc\">Lời giải</summary>\n:::\n\n::: {.content-visible when-format=\"pdf\"}\n\\begin{center}\n\\textbf{Lời giải}\n\\end{center}\n:::\n\na.Thêm vào bảng đã cho cột Giá trị đại diện để tính trung bình, và cột số thứ tự để dễ quan sát.\n\n<!-- Bảng tần số mở rộng Bài tập 3-->\n\n```{r, echo = FALSE}\ndata <- rbind(bai3$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n} else if (output_format == \"latex\") {\n    kable(data, format = \"latex\", booktabs = TRUE, align = \"c\", col.names = NA, escape = FALSE, longtable = TRUE) %>%\n        kable_styling(latex_options = c(\"hold_position\", \"repeat_header\"), full_width = FALSE) \n}\n```\n\n<!-- Trung bình Bài tập 3-->\n\n```{r, echo = FALSE}\nbai3$n <- sum(bai3$df$`Tần số`)\nbai3$barx <- fractions((1 / bai3$n) * sum(bai3$df$`Giá trị đại diện` * bai3$df$`Tần số`))\n```\n\n- Mẫu có $n=40$ số liệu. Nhóm 1 có giá trị đại diện $x_1=35$ và tần số $n_1=4$, vân vân cho đến nhóm 6 có giá trị đại diện $x_6=85$ và tần số $n_6=2$. Trung bình là\n\n\\begin{align*}\n    \\overline{x}\n        & = \\frac{1}{n}(n_1\\cdot x_1 + n_2\\cdot x_2 + n_3\\cdot x_3 + n_4\\cdot x_4 + n_5\\cdot x_5 + n_6\\cdot x_6) \\\\\n        & = \\frac{1}{40} (4\\cdot 35 + 10\\cdot 45 + 14\\cdot 55 + 6\\cdot 65 + 4\\cdot 75 + 2\\cdot 85) \\\\\n        & = \\frac{111}{2} \\\\\n        & = `r format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\")` \\text{ (cm).}\n\\end{align*}\n\n<!-- Trung vị Bài tập 3-->\n\n```{r, echo = FALSE}\nbai3$k <- which(bai3$df$`Tần số tích lũy` >= bai3$n / 2)[1] \nbai3$r <- bai3$df$`Mút trái`[bai3$k]\nbai3$d <- bai3$df$`Mút phải`[bai3$k] - bai3$df$`Mút trái`[bai3$k]\nbai3$me <- fractions(bai3$r + ((bai3$n / 2 - ifelse(bai3$k > 1, bai3$df$`Tần số tích lũy`[bai3$k - 1], 0)) / bai3$df$`Tần số`[bai3$k]) * bai3$d)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_2=14 <\\frac{n}{2}=\\frac{40}{2}=20 <cf_3=28.\n$$\nSuy ra nhóm 3, $[50;55)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 20. Nhóm này có đầu mút trái $r=50$, độ dài $d=10$ và tần số $n_3=14$. Trung vị là\n\n    \\begin{align*}\n        M_e\n            & = r + \\left(\\frac{\\frac{n}{2}-cf_2}{n_3}\\right)\\cdot d \\\\\n            & = 50 + \\left(\\frac{20-14}{14}\\right)\\cdot 10 \\\\\n            & = \\frac{380}{7} \\\\\n            & \\approx `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n<!-- Tứ phân vị thứ nhất Q1 -->\n\n```{r, echo = FALSE}\nbai3$p <- which(bai3$df$`Tần số tích lũy` >= bai3$n / 4)[1]\nbai3$s <- bai3$df$`Mút trái`[bai3$p]\nbai3$h <- bai3$df$`Mút phải`[bai3$p] - bai3$df$`Mút trái`[bai3$p]\nbai3$q1 <- fractions(bai3$s + ((bai3$n / 4 - ifelse(bai3$p > 1, bai3$df$`Tần số tích lũy`[bai3$p - 1], 0)) / bai3$df$`Tần số`[bai3$p]) * bai3$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_1=4 < \\frac{n}{4}=\\frac{40}{4}=10 < cf_2=14.\n$$\nSuy ra nhóm 2, $[40;50)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 10. Nhóm này có đầu mút trái $s=40$, độ dài $h=10$ và tần số $n_2=10$. Tứ phân vị thứ nhất là\n\n    \\begin{align*}\n        Q_1\n            & = s + \\left( \\frac{\\frac{n}{4}-cf_1}{n_2}\\right)\\cdot h \\\\\n            & = 40 + \\left(\\frac{10-4}{10}\\right)\\cdot 10 \\\\\n            & = `r format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n- Tứ phân vị thứ hai $Q_2$ chính là trung vị $M_e$, hay $Q_2 = M_e = `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")`$ (cm).\n\n<!-- Tứ phân vị thứ ba Q3 -->\n\n```{r, echo = FALSE}\nbai3$q <- which(bai3$df$`Tần số tích lũy` >= (3 * bai3$n) / 4)[1]\nbai3$t <- bai3$df$`Mút trái`[bai3$q]\nbai3$l <- bai3$df$`Mút phải`[bai3$q] - bai3$df$`Mút trái`[bai3$q]\nbai3$q3 <- fractions(bai3$t + (((3 * bai3$n) / 4 - ifelse(bai3$q > 1, bai3$df$`Tần số tích lũy`[bai3$q - 1], 0)) / bai3$df$`Tần số`[bai3$q]) * bai3$h)\n```\n\n- Quan sát cột Tần số tích lũy, ta thấy\n$$\ncf_3=28<\\frac{3n}{4}=\\frac{3\\cdot 40}{4}=30<cf_4=34.\n$$\nSuy ra nhóm 4, $[60;70)$, là nhóm đầu tiên có tần số tích lũy không nhỏ hơn 30. Nhóm này có đầu mút trái $t=60$, độ dài $l=10$ và tần số $n_4=6$. Tứ phân vị thứ ba là\n\n    \\begin{align*}\n        Q_3\n            & = t + \\left(\\frac{\\frac{3n}{4}-cf_3}{n_4}\\right)\\cdot l \\\\\n            & = 60 + \\left(\\frac{30-28}{6}\\right)\\cdot 10 \\\\\n            & = \\frac{190}{3} \\\\\n            & = `r format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\")` \\text{ (cm).}\n    \\end{align*}\n\n<!-- Mốt -->\n\n```{r, echo = FALSE}\nbai3$i <- which.max(bai3$df$`Tần số`)\nbai3$u <- bai3$df$`Mút trái`[bai3$i]\nbai3$g <- bai3$df$`Mút phải`[bai3$i] - bai3$df$`Mút trái`[bai3$i]\nbai3$mo <- fractions(bai3$u + ((bai3$df$`Tần số`[bai3$i] - ifelse(bai3$i > 1, bai3$df$`Tần số`[bai3$i - 1], 0)) / (2 * bai3$df$`Tần số`[bai3$i] - ifelse(bai3$i > 1, bai3$df$`Tần số`[bai3$i - 1]) - ifelse(bai3$i < nrow(bai3$df), bai3$df$`Tần số`[bai3$i + 1], 0))) * bai3$g, 4)\n```\n\nb. Quan sát cột Tần số, nhóm 3, $[50;60)$, là nhóm có tần số lớn nhất $n_3=14$. Nó có đầu mút trái $u=50$ và độ dài $g=10$. Nhóm 2 có tần số $n_2=10$ và nhóm 4 có tần số $n_4=6$. Mốt là\n    \\begin{align*}\n        M_o\n            & = u + \\left(\\frac{n_3-n_2}{2n_3-n_2-n_4}\\right) \\cdot g \\\\\n            & = 50 + \\left(\\frac{14-10}{2\\cdot 14-10-6}\\right)\\cdot 10 \\\\\n            & = \\frac{160}{3} \\\\\n            & \\approx `r format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\")` \\text{ (cm)}.\n    \\end{align*}\n\n::: {.content-visible when-format=\"pdf\"}\nTóm lại, bảng tần số ghép nhóm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline \n$[30;40)$ & $[40;50)$ & $[50;60)$ & $[60;70)$ & $[70;80)$ & $[80;90)$  \\\\\n\\hline \n1 & 0 & 0 & 1 & 10 & 17. \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\nCác số đặc trưng đo xu thế trung tâm là\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|}\n\\hline\n$\\overline{x}$ & $Q_1$ & $Q_2$ ($M_e$) & $Q_3$ & $M_o$ \\\\\n\\hline\n`r format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$me), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\")` & `r format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\")`. \\\\\n\\hline \n\\end{tabular}\n\\end{center}\n:::\n\n::: {.ket-thuc}\n:::\n</details>\n\n<!-- Kết quả bài tập 3 -->\n\n<details>\n\n::: {.content-visible when-format=\"html\"}\n<summary class=\"ket-qua\">Kết quả</summary>\n:::\n\n```{r, echo = FALSE}\ndata <- rbind(bai3$df[, c(-3, -4), drop = FALSE], c(\"\", \"\", \"\", \"\\\\(n=40\\\\)\", \"\"))\ndata[] <- lapply(data, function(x) {\n    x <- as.character(x) \n    x <- gsub(\",\", \"TEMP_MARKER\", x)\n    x <- gsub(\"\\\\.\", \",\", x) \n    gsub(\"TEMP_MARKER\", \";\", x)\n})\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    kable(data, format = \"html\", align = \"c\", col.names = NA) %>%\n        kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = FALSE)\n}\n\n```\n\n```{r, echo = FALSE}\ndata <- data.frame(\n    `\\\\(\\\\overline{x}\\\\)` = format(round(as.numeric(bai3$barx), 4), decimal.mark = \",\"),\n    `\\\\(Q_1\\\\)` = format(round(as.numeric(bai3$q1), 4), decimal.mark = \",\"),\n    `\\\\(Q_2\\\\) (\\\\(M_e\\\\))` = format(round(as.numeric(bai3$me), 4), decimal.mark = \",\"),\n    `\\\\(Q_3\\\\)` = format(round(as.numeric(bai3$q3), 4), decimal.mark = \",\"),\n    `\\\\(M_o\\\\)` = format(round(as.numeric(bai3$mo), 4), decimal.mark = \",\"),\n    check.names = FALSE\n)\noutput_format <- knitr::opts_knit$get(\"rmarkdown.pandoc.to\")\nif (output_format == \"html\") {\n    knitr::kable(data, align = \"c\", format = \"html\") %>%\n        kableExtra::kable_styling(\n            bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"),\n            full_width = FALSE\n        )\n}\n```\n\n</details>"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"tex-math":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"svg","to":"html","filters":["../../../../../../../assets/lua/custom.lua"],"css":["../../../../../../../assets/css/custom.css"],"include-in-header":[{"text":"<script>\n  MathJax = {\n    loader: { load: ['[tex]/ams'] },\n    tex: {\n      packages: { '[+]': ['ams'] }\n    },\n    chtml: {\n      scale: 1.0\n    },\n    options: {\n      renderActions: { addMenu: [] }\n    }\n  };\n</script>\n<script>\n  document.addEventListener('DOMContentLoaded', function () {\n    const tooltipTriggerList = Array.from(document.querySelectorAll('[data-bs-toggle=\"tooltip\"]'));\n    const tooltipList = tooltipTriggerList.map(tooltipTriggerEl => {\n      const title = tooltipTriggerEl.getAttribute('title');\n      if (!title) return null;\n\n      const hasMath = /\\\\\\(.*\\\\\\)|\\\\\\[.*\\\\\\]/.test(title);\n      const newTitle = hasMath ? `<span class=\"mathjax-tooltip\">${title}</span>` : title;\n      tooltipTriggerEl.setAttribute('data-bs-title', newTitle);\n      tooltipTriggerEl.setAttribute('title', '');\n\n      return new bootstrap.Tooltip(tooltipTriggerEl, {\n        html: true,\n        trigger: 'hover focus',\n        boundary: 'viewport',\n        placement: 'auto'\n      });\n    }).filter(tooltip => tooltip !== null);\n\n    tooltipTriggerList.forEach(tooltipTriggerEl => {\n      const tooltipInstance = bootstrap.Tooltip.getInstance(tooltipTriggerEl);\n      tooltipTriggerEl.addEventListener('shown.bs.tooltip', function () {\n        // Tìm phần tử .tooltip\n        const tooltip = document.querySelector('.tooltip');\n        if (tooltip) {\n          // Kiểm tra xem có .tooltip-arrow không\n          const tooltipArrow = tooltip.querySelector('.tooltip-arrow');\n          if (tooltipArrow) {\n            tooltipArrow.style.background = 'transparent';\n          } else {\n            // Nếu không có .tooltip-arrow, kiểm tra pseudo-elements của .tooltip hoặc .tooltip-inner\n            const tooltipInner = tooltip.querySelector('.tooltip-inner');\n            if (tooltipInner) {\n              // Thử làm trong suốt pseudo-elements của .tooltip\n              tooltip.style.setProperty('--tooltip-before-background', 'transparent', 'important');\n              // Thử làm trong suốt pseudo-elements của .tooltip-inner\n              tooltipInner.style.setProperty('--tooltip-inner-before-background', 'transparent', 'important');\n            }\n          }\n        }\n\n        // Xử lý MathJax trong tooltip\n        const tooltipEl = document.querySelector('.tooltip-inner');\n        if (!tooltipEl || !tooltipEl.querySelector('.mathjax-tooltip')) return;\n\n        if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {\n          MathJax.typesetPromise([tooltipEl.querySelector('.mathjax-tooltip')]).then(() => {\n            console.log('MathJax rendered successfully in tooltip');\n            if (tooltipInstance) {\n              tooltipInstance.update();\n            }\n          }).catch(err => {\n            console.error('MathJax render error:', err);\n          });\n        } else {\n          console.error('MathJax is not loaded. Ensure MathJax script is included.');\n        }\n      });\n    });\n  });\n</script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js\"></script>\n"}],"toc":true,"output-file":"cac-sdt-do-xttt-msl-ghep-nhom.html"},"language":{"toc-title-document":"Mục lục","toc-title-website":"Trên trang này","related-formats-title":"Định dạng khác","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Tóm tắt","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"Tài liệu tham khảo","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Trích dẫn","appendix-attribution-cite-as":"Để ghi rõ nguồn, vui lòng trích dẫn ấn phẩm này như sau:","appendix-attribution-bibtex":"Trích dẫn BibTeX:","appendix-view-license":"View License","title-block-author-single":"Tác giả","title-block-author-plural":"Các tác giả","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Ngày cập nhật","title-block-modified":"Modified","title-block-keywords":"Từ khóa","callout-tip-title":"Mẹo","callout-note-title":"Note","callout-warning-title":"Cảnh báo","callout-important-title":"Quan trọng","callout-caution-title":"Lưu ý","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Hình","crossref-tbl-title":"Bảng","crossref-lst-title":"Listing","crossref-thm-title":"Định lý","crossref-lem-title":"Bổ đề","crossref-cor-title":"Hệ quả","crossref-prp-title":"Mệnh đề","crossref-cnj-title":"Phỏng đoán","crossref-def-title":"Định nghĩa","crossref-exm-title":"Ví dụ","crossref-exr-title":"Bài tập","crossref-ch-prefix":"Chương","crossref-apx-prefix":"Phụ lục","crossref-sec-prefix":"Mục","crossref-eq-prefix":"Phương trình","crossref-lof-title":"Danh sách hình","crossref-lot-title":"Danh sách bảng","crossref-lol-title":"List of Listings","environment-proof-title":"Chứng minh","environment-remark-title":"Nhận xét","environment-solution-title":"Lời giải","listing-page-order-by":"Order By","listing-page-order-by-default":"Mặc định","listing-page-order-by-date-asc":"Cũ nhất","listing-page-order-by-date-desc":"Mới nhất","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Ngày","listing-page-field-title":"Tiêu đề","listing-page-field-description":"Mô tả","listing-page-field-author":"Tác giả","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Tiêu đề phụ","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Chuyên mục","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Lọc","draft":"Draft"},"metadata":{"lang":"vi","fig-responsive":true,"quarto-version":"1.7.29","resources":["../../../../../../../assets/","assets/fonts/*","assets/tex/**","figures/**"],"theme":"../../../../../../../sandstone.scss","title-block-banner":true,"mathjax":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"},"title":"Bài 1. Các số đặc trưng đo xu thế trung tâm cho mẫu số liệu ghép nhóm","subtitle":"Chương 5 | Cánh Diều | Toán 11","author":"ZO | `r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}